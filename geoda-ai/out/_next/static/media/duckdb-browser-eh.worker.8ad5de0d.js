"use strict";var duckdb=(()=>{var r,Hi,zi,Pn,hh=Object.create,rs=Object.defineProperty,ph=Object.getOwnPropertyDescriptor,mh=Object.getOwnPropertyNames,yh=Object.getPrototypeOf,_h=Object.prototype.hasOwnProperty,Ko=(T,td)=>{if(td=Symbol[T])return td;throw Error("Symbol."+T+" is not defined")},bh=(r=function(T){if("u">typeof require)return require.apply(this,arguments);throw Error('Dynamic require of "'+T+'" is not supported')},"u">typeof require?require:"u">typeof Proxy?new Proxy(r,{get:(T,td)=>("u">typeof require?require:T)[td]}):r),ns=(T,td)=>()=>(td||T((td={exports:{}}).exports,td),td.exports),Xr=(T,td)=>{for(var tf in td)rs(T,tf,{get:td[tf],enumerable:!0})},Oc=(T,td,tf,tb)=>{if(td&&"object"==typeof td||"function"==typeof td)for(let t_ of mh(td))_h.call(T,t_)||t_===tf||rs(T,t_,{get:()=>td[t_],enumerable:!(tb=ph(td,t_))||tb.enumerable});return T},Rc=(T,td,tf)=>(tf=null!=T?hh(yh(T)):{},Oc(!td&&T&&T.__esModule?tf:rs(tf,"default",{value:T,enumerable:!0}),T)),gh=T=>Oc(rs({},"__esModule",{value:!0}),T),wh=function(T,td){this[0]=T,this[1]=td},Gr=T=>{var td,tf=T[Ko("asyncIterator")],tb=!1,t_={};return null==tf?(tf=T[Ko("iterator")](),td=T=>t_[T]=td=>tf[T](td)):(tf=tf.call(T),td=T=>t_[T]=td=>{if(tb){if(tb=!1,"throw"===T)throw td;return td}return tb=!0,{done:!1,value:new wh(new Promise(tb=>{var t_=tf[T](td);if(!(t_ instanceof Object))throw TypeError("Object expected");tb(t_)}),1)}}),t_[Ko("iterator")]=()=>t_,td("next"),"throw"in tf?td("throw"):t_.throw=T=>{throw T},"return"in tf&&td("return"),t_},bu=ns(()=>{}),gu=ns(()=>{}),Su=ns((T,td)=>{var tf=(()=>{var T="u">typeof document&&document.currentScript?document.currentScript.src:void 0;return"u">typeof __filename&&(T=T||__filename),function(td={}){var tf,tb,t_,tg,tv,tw=td;tw.ready=new Promise((T,td)=>{tg=T,tv=td});var tI=Object.assign({},tw),tS=[],tA="./this.program",tT=(T,td)=>{throw td},tB="object"==typeof window,tF="function"==typeof importScripts,tO="object"==typeof process&&"object"==typeof process.versions&&"string"==typeof process.versions.node,tD="";function tM(T){return tw.locateFile?tw.locateFile(T,tD):tD+T}if(tO){var tE=bu(),tU=gu();tD=tF?tU.dirname(tD)+"/":__dirname+"/",tL=(T,td)=>(T=eA(T)?new URL(T):tU.normalize(T),tE.readFileSync(T,td?void 0:"utf8")),tk=T=>{var td=tL(T,!0);return td.buffer||(td=new Uint8Array(td)),td},tR=(T,td,tf,tb=!0)=>{T=eA(T)?new URL(T):tU.normalize(T),tE.readFile(T,tb?void 0:"utf8",(T,t_)=>{T?tf(T):td(tb?t_.buffer:t_)})},!tw.thisProgram&&process.argv.length>1&&(tA=process.argv[1].replace(/\\/g,"/")),tS=process.argv.slice(2),tT=(T,td)=>{throw process.exitCode=T,td},tw.inspect=()=>"[Emscripten Module object]"}else(tB||tF)&&(tF?tD=self.location.href:"u">typeof document&&document.currentScript&&(tD=document.currentScript.src),T&&(tD=T),tD=0!==tD.indexOf("blob:")?tD.substr(0,tD.replace(/[?#].*/,"").lastIndexOf("/")+1):"",tL=T=>{var td=new XMLHttpRequest;return td.open("GET",T,!1),td.send(null),td.responseText},tF&&(tk=T=>{var td=new XMLHttpRequest;return td.open("GET",T,!1),td.responseType="arraybuffer",td.send(null),new Uint8Array(td.response)}),tR=(T,td,tf)=>{var tb=new XMLHttpRequest;tb.open("GET",T,!0),tb.responseType="arraybuffer",tb.onload=()=>{if(200==tb.status||0==tb.status&&tb.response){td(tb.response);return}tf()},tb.onerror=tf,tb.send(null)});var tx=tw.print||console.log.bind(console),tN=tw.printErr||console.error.bind(console);Object.assign(tw,tI),tI=null,tw.arguments&&(tS=tw.arguments),tw.thisProgram&&(tA=tw.thisProgram),tw.quit&&(tT=tw.quit),tw.wasmBinary&&(tC=tw.wasmBinary),"object"!=typeof WebAssembly&&t5("no native wasm support detected");var tL,tR,tk,tC,tP,tV,tz=!1;function tj(T,td){T||t5(td)}function tH(){var T=tP.buffer;tw.HEAP8=t7=new Int8Array(T),tw.HEAP16=ed=new Int16Array(T),tw.HEAPU8=t9=new Uint8Array(T),tw.HEAPU16=ey=new Uint16Array(T),tw.HEAP32=eb=new Int32Array(T),tw.HEAPU32=e_=new Uint32Array(T),tw.HEAPF32=eg=new Float32Array(T),tw.HEAPF64=ev=new Float64Array(T)}var tW=[],tq=[],tY=[],tK=[],tG=!1;function tJ(){if(tw.preRun)for("function"==typeof tw.preRun&&(tw.preRun=[tw.preRun]);tw.preRun.length;)t$(tw.preRun.shift());eE(tW)}function tQ(){tG=!0,eE(tq)}function tX(){eE(tY)}function tZ(){if(tw.postRun)for("function"==typeof tw.postRun&&(tw.postRun=[tw.postRun]);tw.postRun.length;)t1(tw.postRun.shift());eE(tK)}function t$(T){tW.unshift(T)}function t0(T){tq.unshift(T)}function t1(T){tK.unshift(T)}var t2=0,t3=null,t6=null;function t4(T){t2++,tw.monitorRunDependencies&&tw.monitorRunDependencies(t2)}function t8(T){if(t2--,tw.monitorRunDependencies&&tw.monitorRunDependencies(t2),0==t2&&(null!==t3&&(clearInterval(t3),t3=null),t6)){var td=t6;t6=null,td()}}function t5(T){tw.onAbort&&tw.onAbort(T),tN(T="Aborted("+T+")"),tz=!0,tV=1,T+=". Build with -sASSERTIONS for more info.",tG&&rx();var td=new WebAssembly.RuntimeError(T);throw tv(td),td}var t7,t9,ed,ey,eb,e_,eg,ev,ew,eI="data:application/octet-stream;base64,",eS=T=>T.startsWith(eI),eA=T=>T.startsWith("file://");function eT(T){if(T==ew&&tC)return new Uint8Array(tC);if(tk)return tk(T);throw"both async and sync fetching of the wasm failed"}function eB(T){return!tC&&(tB||tF)&&"function"==typeof fetch?fetch(T,{credentials:"same-origin"}).then(td=>{if(!td.ok)throw"failed to load wasm binary file at '"+T+"'";return td.arrayBuffer()}).catch(()=>eT(T)):Promise.resolve().then(()=>eT(T))}function eF(T,td,tf){return eB(T).then(T=>WebAssembly.instantiate(T,td)).then(T=>T).then(tf,T=>{tN("failed to asynchronously prepare wasm: ".concat(T)),t5(T)})}function eO(T,td,tf,tb){return T||"function"!=typeof WebAssembly.instantiateStreaming||eS(td)||tO||"function"!=typeof fetch?eF(td,tf,tb):fetch(td,{credentials:"same-origin"}).then(T=>WebAssembly.instantiateStreaming(T,tf).then(tb,function(T){return tN("wasm streaming compile failed: ".concat(T)),tN("falling back to ArrayBuffer instantiation"),eF(td,tf,tb)}))}function eD(){var T={a:iN};function td(T,td){return tP=(iL=rk(iL=T.exports)).fa,tH(),t0(iL.ga),t8("wasm-instantiate"),iL}function tf(T){td(T.instance)}if(t4("wasm-instantiate"),tw.instantiateWasm)try{return tw.instantiateWasm(T,td)}catch(T){tN("Module.instantiateWasm callback failed with error: ".concat(T)),tv(T)}return eO(tC,ew,T,tf).catch(tv),{}}function eM(T){this.name="ExitStatus",this.message="Program terminated with exit(".concat(T,")"),this.status=T}eS(ew="./duckdb-eh.wasm")||(ew=tM(ew));var eE=T=>{for(;T.length>0;)T.shift()(tw)},eU=tw.noExitRuntime||!0,ex="u">typeof TextDecoder?new TextDecoder("utf8"):void 0,eN=(T,td,tf)=>{td>>>=0;for(var tb=td+tf,t_=td;T[t_]&&!(t_>=tb);)++t_;if(t_-td>16&&T.buffer&&ex)return ex.decode(T.subarray(td,t_));for(var tg="";td<t_;){var tv=T[td++];if(!(128&tv)){tg+=String.fromCharCode(tv);continue}var tw=63&T[td++];if((224&tv)==192){tg+=String.fromCharCode((31&tv)<<6|tw);continue}var tI=63&T[td++];if((tv=(240&tv)==224?(15&tv)<<12|tw<<6|tI:(7&tv)<<18|tw<<12|tI<<6|63&T[td++])<65536)tg+=String.fromCharCode(tv);else{var tS=tv-65536;tg+=String.fromCharCode(55296|tS>>10,56320|1023&tS)}}return tg},eL=(T,td)=>(T>>>=0)?eN(t9,T,td):"",eR={varargs:void 0,get(){var T=eb[+eR.varargs>>>2>>>0];return eR.varargs+=4,T},getp:()=>eR.get(),getStr:T=>eL(T)},ek=(T,td)=>td+2097152>>>0<4194305-!!T?(T>>>0)+4294967296*td:NaN;function eC(T,td,tf,tb,t_){td>>>=0,tf>>>=0,tb>>>=0,t_>>>=0;for(var tg=0,tv=td?eb[td>>>2>>>0]:0,tw=td?eb[td+4>>>2>>>0]:0,tI=tf?eb[tf>>>2>>>0]:0,tS=tf?eb[tf+4>>>2>>>0]:0,tA=tb?eb[tb>>>2>>>0]:0,tT=tb?eb[tb+4>>>2>>>0]:0,tB=0,tF=0,tO=0,tD=0,tM=0,tE=0,tU=(td?eb[td>>>2>>>0]:0)|(tf?eb[tf>>>2>>>0]:0)|(tb?eb[tb>>>2>>>0]:0),tx=(td?eb[td+4>>>2>>>0]:0)|(tf?eb[tf+4>>>2>>>0]:0)|(tb?eb[tb+4>>>2>>>0]:0),tN=function(T,td,tf,tb){return T<32?td&tb:tf&tb},tL=0;tL<T;tL++){var tR=1<<tL%32;if(tN(tL,tU,tx,tR)){var tk=eR.getStreamFromFD(tL),tC=eR.DEFAULT_POLLMASK;if(tk.stream_ops.poll){var tP=-1;t_&&(tP=((td?eb[t_>>>2>>>0]:0)+(td?eb[t_+8>>>2>>>0]:0)/1e6)*1e3),tC=tk.stream_ops.poll(tk,tP)}1&tC&&tN(tL,tv,tw,tR)&&(tL<32?tB|=tR:tF|=tR,tg++),4&tC&&tN(tL,tI,tS,tR)&&(tL<32?tO|=tR:tD|=tR,tg++),2&tC&&tN(tL,tA,tT,tR)&&(tL<32?tM|=tR:tE|=tR,tg++)}}return td&&(eb[td>>>2>>>0]=tB,eb[td+4>>>2>>>0]=tF),tf&&(eb[tf>>>2>>>0]=tO,eb[tf+4>>>2>>>0]=tD),tb&&(eb[tb>>>2>>>0]=tM,eb[tb+4>>>2>>>0]=tE),tg}function eP(){t5("missing function: $SOCKFS")}function eV(){t5("missing function: $FS")}eP.stub=!0,eV.stub=!0;var ez=T=>{var td=eP.getSocket(T);if(!td)throw new eV.ErrnoError(8);return td},ej=T=>(255&T)+"."+(T>>8&255)+"."+(T>>16&255)+"."+(T>>24&255),eH=T=>{var td="",tf=0,tb=0,t_=0,tg=0,tv=0,tw=0,tI=[65535&T[0],T[0]>>16,65535&T[1],T[1]>>16,65535&T[2],T[2]>>16,65535&T[3],T[3]>>16],tS=!0,tA="";for(tw=0;tw<5;tw++)if(0!==tI[tw]){tS=!1;break}if(tS){if(tA=ej(tI[6]|tI[7]<<16),-1===tI[5])return"::ffff:"+tA;if(0===tI[5])return"0.0.0.0"===tA&&(tA=""),"0.0.0.1"===tA&&(tA="1"),td="::"+tA}for(tf=0;tf<8;tf++)0===tI[tf]&&(tf-t_>1&&(tv=0),t_=tf,tv++),tv>tb&&(tg=tf-(tb=tv)+1);for(tf=0;tf<8;tf++){if(tb>1&&0===tI[tf]&&tf>=tg&&tf<tg+tb){tf===tg&&(td+=":",0===tg&&(td+=":"));continue}td+=Number(rM(65535&tI[tf])).toString(16)+(tf<7?":":"")}return td},eW=(T,td)=>{var tf,tb=ed[T>>>1>>>0],t_=rM(ey[T+2>>>1>>>0]);switch(tb){case 2:if(16!==td)return{errno:28};tf=ej(tf=eb[T+4>>>2>>>0]);break;case 10:if(28!==td)return{errno:28};tf=eH(tf=[eb[T+8>>>2>>>0],eb[T+12>>>2>>>0],eb[T+16>>>2>>>0],eb[T+20>>>2>>>0]]);break;default:return{errno:5}}return{family:tb,addr:tf,port:t_}},eq=T=>{for(var td=T.split("."),tf=0;tf<4;tf++){var tb=Number(td[tf]);if(isNaN(tb))return null;td[tf]=tb}return(td[0]|td[1]<<8|td[2]<<16|td[3]<<24)>>>0},eY=T=>parseInt(T),eK=T=>{var td,tf,tb,t_,tg=[];if(!/^((?=.*::)(?!.*::.+::)(::)?([\dA-F]{1,4}:(:|\b)|){5}|([\dA-F]{1,4}:){6})((([\dA-F]{1,4}((?!\3)::|:\b|$))|(?!\2\3)){2}|(((2[0-4]|1\d|[1-9])?\d|25[0-5])\.?\b){4})$/i.test(T))return null;if("::"===T)return[0,0,0,0,0,0,0,0];for((T=T.startsWith("::")?T.replace("::","Z:"):T.replace("::",":Z:")).indexOf(".")>0?((td=(T=T.replace(RegExp("[.]","g"),":")).split(":"))[td.length-4]=eY(td[td.length-4])+256*eY(td[td.length-3]),td[td.length-3]=eY(td[td.length-2])+256*eY(td[td.length-1]),td=td.slice(0,td.length-2)):td=T.split(":"),tb=0,t_=0,tf=0;tf<td.length;tf++)if("string"==typeof td[tf]){if("Z"===td[tf]){for(t_=0;t_<8-td.length+1;t_++)tg[tf+t_]=0;tb=t_-1}else tg[tf+tb]=rD(parseInt(td[tf],16))}else tg[tf+tb]=td[tf];return[tg[1]<<16|tg[0],tg[3]<<16|tg[2],tg[5]<<16|tg[4],tg[7]<<16|tg[6]]},eG={address_map:{id:1,addrs:{},names:{}},lookup_name(T){var td,tf=eq(T);if(null!==tf||null!==(tf=eK(T)))return T;if(eG.address_map.addrs[T])td=eG.address_map.addrs[T];else{var tb=eG.address_map.id++;tj(tb<65535,"exceeded max address mappings of 65535"),td="172.29."+(255&tb)+"."+(65280&tb),eG.address_map.names[td]=T,eG.address_map.addrs[T]=td}return td},lookup_addr:T=>eG.address_map.names[T]?eG.address_map.names[T]:null},eJ=(T,td,tf)=>{if(tf&&0===T)return null;var tb=eW(T,td);if(tb.errno)throw new eV.ErrnoError(tb.errno);return tb.addr=eG.lookup_addr(tb.addr)||tb.addr,tb},eQ=(T,td,tf,tb)=>{if(tf>>>=0,!(tb>0))return 0;for(var t_=tf,tg=tf+tb-1,tv=0;tv<T.length;++tv){var tw=T.charCodeAt(tv);if(tw>=55296&&tw<=57343&&(tw=65536+((1023&tw)<<10)|1023&T.charCodeAt(++tv)),tw<=127){if(tf>=tg)break;td[tf++>>>0]=tw}else if(tw<=2047){if(tf+1>=tg)break;td[tf++>>>0]=192|tw>>6,td[tf++>>>0]=128|63&tw}else if(tw<=65535){if(tf+2>=tg)break;td[tf++>>>0]=224|tw>>12,td[tf++>>>0]=128|tw>>6&63,td[tf++>>>0]=128|63&tw}else{if(tf+3>=tg)break;td[tf++>>>0]=240|tw>>18,td[tf++>>>0]=128|tw>>12&63,td[tf++>>>0]=128|tw>>6&63,td[tf++>>>0]=128|63&tw}}return td[tf>>>0]=0,tf-t_},eX=(T,td,tf)=>eQ(T,t9,td,tf),eZ=(T,td)=>(t9.fill(0,T,T+td),T),e$=(T,td,tf,tb,t_)=>{switch(td){case 2:tf=eq(tf),eZ(T,16),t_&&(eb[t_>>>2>>>0]=16),ed[T>>>1>>>0]=td,eb[T+4>>>2>>>0]=tf,ed[T+2>>>1>>>0]=rD(tb);break;case 10:tf=eK(tf),eZ(T,28),t_&&(eb[t_>>>2>>>0]=28),eb[T>>>2>>>0]=td,eb[T+8>>>2>>>0]=tf[0],eb[T+12>>>2>>>0]=tf[1],eb[T+16>>>2>>>0]=tf[2],eb[T+20>>>2>>>0]=tf[3],ed[T+2>>>1>>>0]=rD(tb);break;default:return 5}return 0},e0=!0,e1=()=>4294901760,e2=T=>{var td=(T-tP.buffer.byteLength+65535)/65536;try{return tP.grow(td),tH(),1}catch(T){}},e3={},e6=()=>tA||"./this.program",e4=()=>{if(!e4.strings){var T={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:("object"==typeof navigator&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",_:e6()};for(var td in e3)void 0===e3[td]?delete T[td]:T[td]=e3[td];var tf=[];for(var td in T)tf.push("".concat(td,"=").concat(T[td]));e4.strings=tf}return e4.strings},e8=(T,td)=>{for(var tf=0;tf<T.length;++tf)t7[td++>>>0>>>0]=T.charCodeAt(tf);t7[td>>>0>>>0]=0},e5=[null,[],[]],e7=(T,td)=>{var tf=e5[T];0===td||10===td?((1===T?tx:tN)(eN(tf,0)),tf.length=0):tf.push(td)},e9=()=>{if("object"==typeof crypto&&"function"==typeof crypto.getRandomValues)return T=>crypto.getRandomValues(T);if(tO)try{var T=bh("crypto");if(T.randomFillSync)return td=>T.randomFillSync(td);var td=T.randomBytes;return T=>(T.set(td(T.byteLength)),T)}catch(T){}t5("initRandomDevice")},id=T=>(id=e9())(T),ib=T=>T%4==0&&(T%100!=0||T%400==0),i_=(T,td)=>{for(var tf=0,tb=0;tb<=td;tf+=T[tb++]);return tf},ig=[31,29,31,30,31,30,31,31,30,31,30,31],iv=[31,28,31,30,31,30,31,31,30,31,30,31],iw=(T,td)=>{for(var tf=new Date(T.getTime());td>0;){var tb=ib(tf.getFullYear()),t_=tf.getMonth(),tg=(tb?ig:iv)[t_];if(!(td>tg-tf.getDate()))return tf.setDate(tf.getDate()+td),tf;td-=tg-tf.getDate()+1,tf.setDate(1),t_<11?tf.setMonth(t_+1):(tf.setMonth(0),tf.setFullYear(tf.getFullYear()+1))}return tf},iI=T=>{for(var td=0,tf=0;tf<T.length;++tf){var tb=T.charCodeAt(tf);tb<=127?td++:tb<=2047?td+=2:tb>=55296&&tb<=57343?(td+=4,++tf):td+=3}return td};function iS(T,td,tf){var tb=Array(tf>0?tf:iI(T)+1),t_=eQ(T,tb,0,tb.length);return td&&(tb.length=t_),tb}var iA=(T,td)=>{t7.set(T,td>>>0)};function iT(T,td,tf,tb){T>>>=0,td>>>=0,tf>>>=0;var t_=e_[(tb>>>=0)+40>>>2>>>0],tg={tm_sec:eb[tb>>>2>>>0],tm_min:eb[tb+4>>>2>>>0],tm_hour:eb[tb+8>>>2>>>0],tm_mday:eb[tb+12>>>2>>>0],tm_mon:eb[tb+16>>>2>>>0],tm_year:eb[tb+20>>>2>>>0],tm_wday:eb[tb+24>>>2>>>0],tm_yday:eb[tb+28>>>2>>>0],tm_isdst:eb[tb+32>>>2>>>0],tm_gmtoff:eb[tb+36>>>2>>>0],tm_zone:t_?eL(t_):""},tv=eL(tf),tw={"%c":"%a %b %d %H:%M:%S %Y","%D":"%m/%d/%y","%F":"%Y-%m-%d","%h":"%b","%r":"%I:%M:%S %p","%R":"%H:%M","%T":"%H:%M:%S","%x":"%m/%d/%y","%X":"%H:%M:%S","%Ec":"%c","%EC":"%C","%Ex":"%m/%d/%y","%EX":"%H:%M:%S","%Ey":"%y","%EY":"%Y","%Od":"%d","%Oe":"%e","%OH":"%H","%OI":"%I","%Om":"%m","%OM":"%M","%OS":"%S","%Ou":"%u","%OU":"%U","%OV":"%V","%Ow":"%w","%OW":"%W","%Oy":"%y"};for(var tI in tw)tv=tv.replace(RegExp(tI,"g"),tw[tI]);var tS=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],tA=["January","February","March","April","May","June","July","August","September","October","November","December"];function tT(T,td,tf){for(var tb="number"==typeof T?T.toString():T||"";tb.length<td;)tb=tf[0]+tb;return tb}function tB(T,td){return tT(T,td,"0")}function tF(T,td){var tf;function tb(T){return T<0?-1:T>0?1:0}return 0===(tf=tb(T.getFullYear()-td.getFullYear()))&&0===(tf=tb(T.getMonth()-td.getMonth()))&&(tf=tb(T.getDate()-td.getDate())),tf}function tO(T){switch(T.getDay()){case 0:return new Date(T.getFullYear()-1,11,29);case 1:return T;case 2:return new Date(T.getFullYear(),0,3);case 3:return new Date(T.getFullYear(),0,2);case 4:return new Date(T.getFullYear(),0,1);case 5:return new Date(T.getFullYear()-1,11,31);case 6:return new Date(T.getFullYear()-1,11,30)}}function tD(T){var td=iw(new Date(T.tm_year+1900,0,1),T.tm_yday),tf=new Date(td.getFullYear(),0,4),tb=new Date(td.getFullYear()+1,0,4),t_=tO(tf),tg=tO(tb);return 0>=tF(t_,td)?0>=tF(tg,td)?td.getFullYear()+1:td.getFullYear():td.getFullYear()-1}var tM={"%a":T=>tS[T.tm_wday].substring(0,3),"%A":T=>tS[T.tm_wday],"%b":T=>tA[T.tm_mon].substring(0,3),"%B":T=>tA[T.tm_mon],"%C":T=>tB((T.tm_year+1900)/100|0,2),"%d":T=>tB(T.tm_mday,2),"%e":T=>tT(T.tm_mday,2," "),"%g":T=>tD(T).toString().substring(2),"%G":T=>tD(T),"%H":T=>tB(T.tm_hour,2),"%I":T=>{var td=T.tm_hour;return 0==td?td=12:td>12&&(td-=12),tB(td,2)},"%j":T=>tB(T.tm_mday+i_(ib(T.tm_year+1900)?ig:iv,T.tm_mon-1),3),"%m":T=>tB(T.tm_mon+1,2),"%M":T=>tB(T.tm_min,2),"%n":()=>"\n","%p":T=>T.tm_hour>=0&&T.tm_hour<12?"AM":"PM","%S":T=>tB(T.tm_sec,2),"%t":()=>"	","%u":T=>T.tm_wday||7,"%U":T=>tB(Math.floor((T.tm_yday+7-T.tm_wday)/7),2),"%V":T=>{var td=Math.floor((T.tm_yday+7-(T.tm_wday+6)%7)/7);if((T.tm_wday+371-T.tm_yday-2)%7<=2&&td++,td){if(53==td){var tf=(T.tm_wday+371-T.tm_yday)%7;4==tf||3==tf&&ib(T.tm_year)||(td=1)}}else{td=52;var tb=(T.tm_wday+7-T.tm_yday-1)%7;(4==tb||5==tb&&ib(T.tm_year%400-1))&&td++}return tB(td,2)},"%w":T=>T.tm_wday,"%W":T=>tB(Math.floor((T.tm_yday+7-(T.tm_wday+6)%7)/7),2),"%y":T=>(T.tm_year+1900).toString().substring(2),"%Y":T=>T.tm_year+1900,"%z":T=>{var td=T.tm_gmtoff;return(td>=0?"+":"-")+("0000"+(td=(td=Math.abs(td)/60)/60*100+td%60)).slice(-4)},"%Z":T=>T.tm_zone,"%%":()=>"%"};for(var tI in tv=tv.replace(/%%/g,"\x00\x00"),tM)tv.includes(tI)&&(tv=tv.replace(RegExp(tI,"g"),tM[tI](tg)));var tE=iS(tv=tv.replace(/\0\0/g,"%"),!1);return tE.length>td?0:(iA(tE,T),tE.length-1)}var iB=0,iF=()=>eU||iB>0,iO=T=>{tV=T,iF()||(tw.onExit&&tw.onExit(T),tz=!0),tT(T,new eM(T))},iD=(T,td)=>{tV=T,iO(T)},iM=T=>{if(T instanceof eM||"unwind"==T)return tV;tT(1,T)},iE=T=>tw["_"+T],iU=T=>{var td=iI(T)+1,tf=rR(td);return eX(T,tf,td),tf},ix=(T,td,tf,tb,t_)=>{var tg={string:T=>{var td=0;return null!=T&&0!==T&&(td=iU(T)),td},array:T=>{var td=rR(T.length);return iA(T,td),td}};function tv(T){return"string"===td?eL(T):"boolean"===td?!!T:T}var tw=iE(T),tI=[],tS=0;if(tb)for(var tA=0;tA<tb.length;tA++){var tT=tg[tf[tA]];tT?(0===tS&&(tS=rN()),tI[tA]=tT(tb[tA])):tI[tA]=tb[tA]}return function(T){return 0!==tS&&rL(tS),tv(T)}(tw.apply(null,tI))},iN={Z:eC,ba:function(T,td,tf,tb,t_,tg){td>>>=0,tf>>>=0;var tv=ez(T),tw=eJ(td,tf);return tv.sock_ops.bind(tv,tw.addr,tw.port),0},aa:function(T,td,tf,tb,t_,tg){td>>>=0,tf>>>=0;var tv=ez(T),tw=eJ(td,tf);return tv.sock_ops.connect(tv,tw.addr,tw.port),0},V:function(T,td,tf,tb){},a:function(T,td,tf){return tf>>>=0,eR.varargs=tf,0},U:function(T,td){},v:function(T,td,tf){ek(td,tf)},P:function(T,td,tf){td>>>=0,tf>>>=0},X:function(T,td,tf,tb,t_,tg){td>>>=0,tf>>>=0;var tv=ez(T);return tv.daddr?(e$(td,tv.family,eG.lookup_name(tv.daddr),tv.dport,tf),0):-53},Y:function(T,td,tf,tb,t_,tg){tb>>>=0,t_>>>=0;var tv=ez(T);return 1===td&&4===tf?(eb[tb>>>2>>>0]=tv.error,eb[t_>>>2>>>0]=4,tv.error=null,0):-50},o:function(T,td,tf){return tf>>>=0,eR.varargs=tf,0},R:function(T,td){T>>>=0,td>>>=0},Q:function(T,td,tf){},S:function(T,td,tf,tb){td>>>=0,tf>>>=0},p:function(T,td,tf,tb){td>>>=0,tb>>>=0,eR.varargs=tb},_:function(T,td,tf,tb,t_,tg){td>>>=0,tf>>>=0,t_>>>=0,tg>>>=0;var tv=ez(T),tw=tv.sock_ops.recvmsg(tv,tf);return tw?(t_&&e$(t_,tv.family,eG.lookup_name(tw.addr),tw.port,tg),t9.set(tw.buffer,td>>>0),tw.buffer.byteLength):0},N:function(T,td,tf,tb){td>>>=0,tb>>>=0},i:function(T){},$:function(T,td,tf,tb,t_,tg){td>>>=0,tf>>>=0,t_>>>=0,tg>>>=0},l:(T,td,tf)=>{},T:function(T,td){T>>>=0,td>>>=0},j:function(T,td,tf){},q:()=>e0,c:()=>{t5("")},F:function(T,td){return globalThis.DUCKDB_RUNTIME.createDirectory(tw,T,td)},G:function(T,td){return globalThis.DUCKDB_RUNTIME.checkDirectory(tw,T,td)},D:function(T,td){return globalThis.DUCKDB_RUNTIME.listDirectoryEntries(tw,T,td)},E:function(T,td){return globalThis.DUCKDB_RUNTIME.removeDirectory(tw,T,td)},g:function(T){return globalThis.DUCKDB_RUNTIME.closeFile(tw,T)},A:function(T,td){return globalThis.DUCKDB_RUNTIME.checkFile(tw,T,td)},u:function(T){return globalThis.DUCKDB_RUNTIME.getLastFileModificationTime(tw,T)},B:function(T,td,tf,tb){return globalThis.DUCKDB_RUNTIME.moveFile(tw,T,td,tf,tb)},I:function(T,td){return globalThis.DUCKDB_RUNTIME.openFile(tw,T,td)},d:function(T,td,tf,tb){return globalThis.DUCKDB_RUNTIME.readFile(tw,T,td,tf,tb)},H:function(T,td){return globalThis.DUCKDB_RUNTIME.truncateFile(tw,T,td)},h:function(T,td,tf,tb){return globalThis.DUCKDB_RUNTIME.writeFile(tw,T,td,tf,tb)},J:function(T){return globalThis.DUCKDB_RUNTIME.getDefaultDataProtocol(T)},z:function(T,td){return globalThis.DUCKDB_RUNTIME.glob(tw,T,td)},f:function(T){return globalThis.DUCKDB_RUNTIME.testPlatformFeature(tw,T)},L:function(T,td,tf,tb,t_,tg){return globalThis.DUCKDB_RUNTIME.callScalarUDF(tw,T,td,tf,tb,t_,tg)},r:()=>Date.now(),s:function(){return e1()},k:()=>performance.now(),da:function(T,td,tf){return T>>>=0,td>>>=0,tf>>>=0,t9.copyWithin(T>>>0,td>>>0,td+tf>>>0)},ea:function(T){T>>>=0;var td=t9.length,tf=e1();if(T>tf)return!1;for(var tb=(T,td)=>T+(td-T%td)%td,t_=1;t_<=4;t_*=2){var tg=td*(1+.2/t_);if(tg=Math.min(tg,T+100663296),e2(Math.min(tf,tb(Math.max(T,tg),65536))))return!0}return!1},C:function(T,td){T>>>=0,td>>>=0;var tf=0;return e4().forEach((tb,t_)=>{var tg=td+tf;e_[T+4*t_>>>2>>>0]=tg,e8(tb,tg),tf+=tb.length+1}),0},K:function(T,td){T>>>=0,td>>>=0;var tf=e4();e_[T>>>2>>>0]=tf.length;var tb=0;return tf.forEach(T=>tb+=T.length+1),e_[td>>>2>>>0]=tb,0},b:T=>52,ca:function(T,td){var t_=0,tg=0,tv=0,tw=2;return 0==T?t_=2:(1==T||2==T)&&(t_=64),tv=1,t7[(td>>>=0)>>>0>>>0]=tw,ed[td+2>>>1>>>0]=tv,tb=[t_>>>0,+Math.abs(tf=t_)>=1?tf>0?+Math.floor(tf/4294967296)>>>0:~~+Math.ceil((tf-+(~~tf>>>0))/4294967296)>>>0:0],eb[td+8>>>2>>>0]=tb[0],eb[td+12>>>2>>>0]=tb[1],tb=[tg>>>0,+Math.abs(tf=tg)>=1?tf>0?+Math.floor(tf/4294967296)>>>0:~~+Math.ceil((tf-+(~~tf>>>0))/4294967296)>>>0:0],eb[td+16>>>2>>>0]=tb[0],eb[td+20>>>2>>>0]=tb[1],0},x:function(T,td,tf,tb,t_,tg){return td>>>=0,tf>>>=0,ek(tb,t_),tg>>>=0,52},w:function(T,td,tf,tb,t_,tg){return td>>>=0,tf>>>=0,ek(tb,t_),tg>>>=0,52},n:function(T,td,tf,tb){return td>>>=0,tf>>>=0,tb>>>=0,52},y:function(T,td,tf,tb,t_){return ek(td,tf),t_>>>=0,70},O:T=>52,e:function(T,td,tf,tb){td>>>=0,tf>>>=0,tb>>>=0;for(var t_=0,tg=0;tg<tf;tg++){var tv=e_[td>>>2>>>0],tw=e_[td+4>>>2>>>0];td+=8;for(var tI=0;tI<tw;tI++)e7(T,t9[tv+tI>>>0]);t_+=tw}return e_[tb>>>2>>>0]=t_,0},m:function(T,td,tf,tb){T>>>=0,td>>>=0,tf>>>=0,tb>>>=0;var t_,tg=0,tv=0,tw=0,tI=0,tS=0,tA=0;function tT(T,td,tf,tb,t_,tg){var tv,tw,tI;return tw=10===T?28:16,t_=10===T?eH(t_):ej(t_),tj(!e$(tv=rE(tw),T,t_,tg)),eb[(tI=rE(32))+4>>>2>>>0]=T,eb[tI+8>>>2>>>0]=td,eb[tI+12>>>2>>>0]=tf,e_[tI+24>>>2>>>0]=tb,e_[tI+20>>>2>>>0]=tv,10===T?eb[tI+16>>>2>>>0]=28:eb[tI+16>>>2>>>0]=16,eb[tI+28>>>2>>>0]=0,tI}if(tf&&(tw=eb[tf>>>2>>>0],tI=eb[tf+4>>>2>>>0],tS=eb[tf+8>>>2>>>0],tA=eb[tf+12>>>2>>>0]),tS&&!tA&&(tA=2===tS?17:6),!tS&&tA&&(tS=17===tA?2:1),0===tA&&(tA=6),0===tS&&(tS=1),!T&&!td)return -2;if(-1088&tw||0!==tf&&2&eb[tf>>>2>>>0]&&!T)return -1;if(32&tw)return -2;if(0!==tS&&1!==tS&&2!==tS)return -7;if(0!==tI&&2!==tI&&10!==tI)return -6;if(td&&isNaN(tv=parseInt(td=eL(td),10)))return 1024&tw?-2:-8;if(!T)return 0===tI&&(tI=2),1&tw||(tg=2===tI?rO(2130706433):[0,0,0,1]),t_=tT(tI,tS,tA,null,tg,tv),e_[tb>>>2>>>0]=t_,0;if(null!==(tg=eq(T=eL(T)))){if(0===tI||2===tI)tI=2;else{if(10!==tI||!(8&tw))return -2;tg=[0,0,rO(65535),tg],tI=10}}else if(null!==(tg=eK(T))){if(0!==tI&&10!==tI)return -2;tI=10}return null!=tg?(t_=tT(tI,tS,tA,T,tg,tv),e_[tb>>>2>>>0]=t_,0):4&tw?-2:(tg=eq(T=eG.lookup_name(T)),0===tI?tI=2:10===tI&&(tg=[0,0,rO(65535),tg]),t_=tT(tI,tS,tA,null,tg,tv),e_[tb>>>2>>>0]=t_,0)},M:function(T,td){return T>>>=0,td>>>=0,id(t9.subarray(T>>>0,T+td>>>0)),0},W:function(T,td,tf,tb,t_,tg,tv){T>>>=0,tf>>>=0,t_>>>=0;var tw=eW(T,td);if(tw.errno)return -6;var tI=tw.port,tS=tw.addr,tA=!1;if(tf&&tb){if(!(1&tv)&&(tT=eG.lookup_addr(tS)))tS=tT;else if(8&tv)return -2;var tT,tB=eX(tS,tf,tb);tB+1>=tb&&(tA=!0)}if(t_&&tg){var tB=eX(tI=""+tI,t_,tg);tB+1>=tg&&(tA=!0)}return tA?-12:0},t:function(T,td,tf,tb,t_){return t_>>>=0,iT(T>>>=0,td>>>=0,tf>>>=0,tb>>>=0)}},iL=eD(),iR=()=>(iR=iL.ga)(),ik=tw._main=(T,td)=>(ik=tw._main=iL.ha)(T,td),iC=tw._duckdb_web_fs_glob_add_path=T=>(iC=tw._duckdb_web_fs_glob_add_path=iL.ja)(T),iP=tw._duckdb_web_clear_response=()=>(iP=tw._duckdb_web_clear_response=iL.ka)(),iV=tw._duckdb_web_fail_with=T=>(iV=tw._duckdb_web_fail_with=iL.la)(T),iz=tw._duckdb_web_reset=T=>(iz=tw._duckdb_web_reset=iL.ma)(T),ij=tw._duckdb_web_connect=()=>(ij=tw._duckdb_web_connect=iL.na)(),iH=tw._duckdb_web_disconnect=T=>(iH=tw._duckdb_web_disconnect=iL.oa)(T),iW=tw._duckdb_web_flush_files=()=>(iW=tw._duckdb_web_flush_files=iL.pa)(),iq=tw._duckdb_web_flush_file=T=>(iq=tw._duckdb_web_flush_file=iL.qa)(T),iY=tw._duckdb_web_open=(T,td)=>(iY=tw._duckdb_web_open=iL.ra)(T,td),iK=tw._duckdb_web_get_global_file_info=(T,td)=>(iK=tw._duckdb_web_get_global_file_info=iL.sa)(T,td),iG=tw._duckdb_web_collect_file_stats=(T,td,tf)=>(iG=tw._duckdb_web_collect_file_stats=iL.ta)(T,td,tf),iJ=tw._duckdb_web_export_file_stats=(T,td)=>(iJ=tw._duckdb_web_export_file_stats=iL.ua)(T,td),iQ=tw._duckdb_web_fs_drop_file=(T,td)=>(iQ=tw._duckdb_web_fs_drop_file=iL.va)(T,td),iX=tw._duckdb_web_fs_drop_files=T=>(iX=tw._duckdb_web_fs_drop_files=iL.wa)(T),iZ=tw._duckdb_web_fs_glob_file_infos=(T,td)=>(iZ=tw._duckdb_web_fs_glob_file_infos=iL.xa)(T,td),i$=tw._duckdb_web_fs_get_file_info_by_id=(T,td,tf)=>(i$=tw._duckdb_web_fs_get_file_info_by_id=iL.ya)(T,td,tf),i0=tw._duckdb_web_fs_get_file_info_by_name=(T,td,tf)=>(i0=tw._duckdb_web_fs_get_file_info_by_name=iL.za)(T,td,tf),i1=tw._duckdb_web_fs_register_file_url=(T,td,tf,tb,t_)=>(i1=tw._duckdb_web_fs_register_file_url=iL.Aa)(T,td,tf,tb,t_),i2=tw._duckdb_web_fs_register_file_buffer=(T,td,tf,tb)=>(i2=tw._duckdb_web_fs_register_file_buffer=iL.Ba)(T,td,tf,tb),i3=tw._duckdb_web_copy_file_to_buffer=(T,td)=>(i3=tw._duckdb_web_copy_file_to_buffer=iL.Ca)(T,td),i6=tw._duckdb_web_copy_file_to_path=(T,td,tf)=>(i6=tw._duckdb_web_copy_file_to_path=iL.Da)(T,td,tf),i4=tw._duckdb_web_get_version=T=>(i4=tw._duckdb_web_get_version=iL.Ea)(T),i8=tw._duckdb_web_get_feature_flags=()=>(i8=tw._duckdb_web_get_feature_flags=iL.Fa)(),i5=tw._duckdb_web_tokenize=(T,td)=>(i5=tw._duckdb_web_tokenize=iL.Ga)(T,td),i7=tw._duckdb_web_udf_scalar_create=(T,td,tf)=>(i7=tw._duckdb_web_udf_scalar_create=iL.Ha)(T,td,tf),i9=tw._duckdb_web_prepared_create=(T,td,tf)=>(i9=tw._duckdb_web_prepared_create=iL.Ia)(T,td,tf),rd=tw._duckdb_web_prepared_close=(T,td,tf)=>(rd=tw._duckdb_web_prepared_close=iL.Ja)(T,td,tf),rf=tw._duckdb_web_prepared_run=(T,td,tf,tb)=>(rf=tw._duckdb_web_prepared_run=iL.Ka)(T,td,tf,tb),rb=tw._duckdb_web_prepared_send=(T,td,tf,tb)=>(rb=tw._duckdb_web_prepared_send=iL.La)(T,td,tf,tb),r_=tw._duckdb_web_query_run=(T,td,tf)=>(r_=tw._duckdb_web_query_run=iL.Ma)(T,td,tf),rg=tw._duckdb_web_pending_query_start=(T,td,tf)=>(rg=tw._duckdb_web_pending_query_start=iL.Na)(T,td,tf),rv=tw._duckdb_web_pending_query_poll=(T,td,tf)=>(rv=tw._duckdb_web_pending_query_poll=iL.Oa)(T,td,tf),rw=tw._duckdb_web_pending_query_cancel=(T,td)=>(rw=tw._duckdb_web_pending_query_cancel=iL.Pa)(T,td),rI=tw._duckdb_web_query_fetch_results=(T,td)=>(rI=tw._duckdb_web_query_fetch_results=iL.Qa)(T,td),rS=tw._duckdb_web_get_tablenames=(T,td,tf)=>(rS=tw._duckdb_web_get_tablenames=iL.Ra)(T,td,tf),rA=tw._duckdb_web_insert_arrow_from_ipc_stream=(T,td,tf,tb,t_)=>(rA=tw._duckdb_web_insert_arrow_from_ipc_stream=iL.Sa)(T,td,tf,tb,t_),rT=tw._duckdb_web_insert_csv_from_path=(T,td,tf,tb)=>(rT=tw._duckdb_web_insert_csv_from_path=iL.Ta)(T,td,tf,tb),rB=tw._duckdb_web_insert_json_from_path=(T,td,tf,tb)=>(rB=tw._duckdb_web_insert_json_from_path=iL.Ua)(T,td,tf,tb),rF=()=>(rF=iL.__errno_location)(),rO=T=>(rO=iL.Va)(T),rD=T=>(rD=iL.Wa)(T),rM=T=>(rM=iL.Xa)(T),rE=tw._malloc=T=>(rE=tw._malloc=iL.Ya)(T),rU=tw._free=T=>(rU=tw._free=iL.Za)(T),rx=()=>(rx=iL._a)(),rN=()=>(rN=iL.$a)(),rL=T=>(rL=iL.ab)(T),rR=T=>(rR=iL.bb)(T);function rk(T){T=Object.assign({},T);var td=T=>()=>T()>>>0,tf=T=>td=>T(td)>>>0;return T.__errno_location=td(T.__errno_location),T.Ya=tf(T.Ya),T.$a=td(T.$a),T.bb=tf(T.bb),T}function rC(){var T=ik,td=0,tf=0;try{var tb=T(td,tf);return iD(tb,!0),tb}catch(T){return iM(T)}}function rP(){t2>0||(tJ(),t2>0)||(tw.setStatus?(tw.setStatus("Running..."),setTimeout(function(){setTimeout(function(){tw.setStatus("")},1),T()},1)):T());function T(){t_||(t_=!0,tw.calledRun=!0,tz||(tQ(),tX(),tg(tw),tw.onRuntimeInitialized&&tw.onRuntimeInitialized(),rV&&rC(),tZ()))}}if(tw.stackAlloc=rR,tw.stackSave=rN,tw.stackRestore=rL,tw.ccall=ix,t6=function T(){t_||rP(),t_||(t6=T)},tw.preInit)for("function"==typeof tw.preInit&&(tw.preInit=[tw.preInit]);tw.preInit.length>0;)tw.preInit.pop()();var rV=!0;return tw.noInitialRun&&(rV=!1),rP(),td.ready}})();"object"==typeof T&&"object"==typeof td?td.exports=tf:"function"==typeof define&&define.amd&&define([],()=>tf)}),xu=ns((exports,module)=>{!function(){var ERROR="input is invalid type",WINDOW="object"==typeof window,root=WINDOW?window:{};root.JS_SHA256_NO_WINDOW&&(WINDOW=!1);var WEB_WORKER=!WINDOW&&"object"==typeof self,NODE_JS=!root.JS_SHA256_NO_NODE_JS&&"object"==typeof process&&process.versions&&process.versions.node;NODE_JS?root=global:WEB_WORKER&&(root=self);var COMMON_JS=!root.JS_SHA256_NO_COMMON_JS&&"object"==typeof module&&module.exports,AMD="function"==typeof define&&define.amd,ARRAY_BUFFER=!root.JS_SHA256_NO_ARRAY_BUFFER&&"u">typeof ArrayBuffer,HEX_CHARS="0123456789abcdef".split(""),EXTRA=[-2147483648,8388608,32768,128],SHIFT=[24,16,8,0],K=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],OUTPUT_TYPES=["hex","array","digest","arrayBuffer"],blocks=[];(root.JS_SHA256_NO_NODE_JS||!Array.isArray)&&(Array.isArray=function(T){return"[object Array]"===Object.prototype.toString.call(T)}),ARRAY_BUFFER&&(root.JS_SHA256_NO_ARRAY_BUFFER_IS_VIEW||!ArrayBuffer.isView)&&(ArrayBuffer.isView=function(T){return"object"==typeof T&&T.buffer&&T.buffer.constructor===ArrayBuffer});var createOutputMethod=function(T,td){return function(tf){return new Sha256(td,!0).update(tf)[T]()}},createMethod=function(T){var td=createOutputMethod("hex",T);NODE_JS&&(td=nodeWrap(td,T)),td.create=function(){return new Sha256(T)},td.update=function(T){return td.create().update(T)};for(var tf=0;tf<OUTPUT_TYPES.length;++tf){var tb=OUTPUT_TYPES[tf];td[tb]=createOutputMethod(tb,T)}return td},nodeWrap=function(method,is224){var crypto=eval("require('crypto')"),Buffer=eval("require('buffer').Buffer"),algorithm=is224?"sha224":"sha256",nodeMethod=function(T){if("string"==typeof T)return crypto.createHash(algorithm).update(T,"utf8").digest("hex");if(null==T)throw Error(ERROR);return T.constructor===ArrayBuffer&&(T=new Uint8Array(T)),Array.isArray(T)||ArrayBuffer.isView(T)||T.constructor===Buffer?crypto.createHash(algorithm).update(new Buffer(T)).digest("hex"):method(T)};return nodeMethod},createHmacOutputMethod=function(T,td){return function(tf,tb){return new HmacSha256(tf,td,!0).update(tb)[T]()}},createHmacMethod=function(T){var td=createHmacOutputMethod("hex",T);td.create=function(td){return new HmacSha256(td,T)},td.update=function(T,tf){return td.create(T).update(tf)};for(var tf=0;tf<OUTPUT_TYPES.length;++tf){var tb=OUTPUT_TYPES[tf];td[tb]=createHmacOutputMethod(tb,T)}return td};function Sha256(T,td){td?(blocks[0]=blocks[16]=blocks[1]=blocks[2]=blocks[3]=blocks[4]=blocks[5]=blocks[6]=blocks[7]=blocks[8]=blocks[9]=blocks[10]=blocks[11]=blocks[12]=blocks[13]=blocks[14]=blocks[15]=0,this.blocks=blocks):this.blocks=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],T?(this.h0=3238371032,this.h1=914150663,this.h2=812702999,this.h3=4144912697,this.h4=4290775857,this.h5=1750603025,this.h6=1694076839,this.h7=3204075428):(this.h0=1779033703,this.h1=3144134277,this.h2=1013904242,this.h3=2773480762,this.h4=1359893119,this.h5=2600822924,this.h6=528734635,this.h7=1541459225),this.block=this.start=this.bytes=this.hBytes=0,this.finalized=this.hashed=!1,this.first=!0,this.is224=T}function HmacSha256(T,td,tf){var tb,t_=typeof T;if("string"===t_){var tg,tv=[],tw=T.length,tI=0;for(tb=0;tb<tw;++tb)(tg=T.charCodeAt(tb))<128?tv[tI++]=tg:(tg<2048?tv[tI++]=192|tg>>6:(tg<55296||tg>=57344?tv[tI++]=224|tg>>12:(tg=65536+((1023&tg)<<10|1023&T.charCodeAt(++tb)),tv[tI++]=240|tg>>18,tv[tI++]=128|tg>>12&63),tv[tI++]=128|tg>>6&63),tv[tI++]=128|63&tg);T=tv}else if("object"===t_){if(null===T)throw Error(ERROR);if(ARRAY_BUFFER&&T.constructor===ArrayBuffer)T=new Uint8Array(T);else if(!Array.isArray(T)&&(!ARRAY_BUFFER||!ArrayBuffer.isView(T)))throw Error(ERROR)}else throw Error(ERROR);T.length>64&&(T=new Sha256(td,!0).update(T).array());var tS=[],tA=[];for(tb=0;tb<64;++tb){var tT=T[tb]||0;tS[tb]=92^tT,tA[tb]=54^tT}Sha256.call(this,td,tf),this.update(tA),this.oKeyPad=tS,this.inner=!0,this.sharedMemory=tf}Sha256.prototype.update=function(T){if(!this.finalized){var td,tf=typeof T;if("string"!==tf){if("object"===tf){if(null===T)throw Error(ERROR);if(ARRAY_BUFFER&&T.constructor===ArrayBuffer)T=new Uint8Array(T);else if(!Array.isArray(T)&&(!ARRAY_BUFFER||!ArrayBuffer.isView(T)))throw Error(ERROR)}else throw Error(ERROR);td=!0}for(var tb,t_,tg=0,tv=T.length,tw=this.blocks;tg<tv;){if(this.hashed&&(this.hashed=!1,tw[0]=this.block,tw[16]=tw[1]=tw[2]=tw[3]=tw[4]=tw[5]=tw[6]=tw[7]=tw[8]=tw[9]=tw[10]=tw[11]=tw[12]=tw[13]=tw[14]=tw[15]=0),td)for(t_=this.start;tg<tv&&t_<64;++tg)tw[t_>>2]|=T[tg]<<SHIFT[3&t_++];else for(t_=this.start;tg<tv&&t_<64;++tg)(tb=T.charCodeAt(tg))<128?tw[t_>>2]|=tb<<SHIFT[3&t_++]:(tb<2048?tw[t_>>2]|=(192|tb>>6)<<SHIFT[3&t_++]:(tb<55296||tb>=57344?tw[t_>>2]|=(224|tb>>12)<<SHIFT[3&t_++]:(tb=65536+((1023&tb)<<10|1023&T.charCodeAt(++tg)),tw[t_>>2]|=(240|tb>>18)<<SHIFT[3&t_++],tw[t_>>2]|=(128|tb>>12&63)<<SHIFT[3&t_++]),tw[t_>>2]|=(128|tb>>6&63)<<SHIFT[3&t_++]),tw[t_>>2]|=(128|63&tb)<<SHIFT[3&t_++]);this.lastByteIndex=t_,this.bytes+=t_-this.start,t_>=64?(this.block=tw[16],this.start=t_-64,this.hash(),this.hashed=!0):this.start=t_}return this.bytes>4294967295&&(this.hBytes+=this.bytes/4294967296<<0,this.bytes=this.bytes%4294967296),this}},Sha256.prototype.finalize=function(){if(!this.finalized){this.finalized=!0;var T=this.blocks,td=this.lastByteIndex;T[16]=this.block,T[td>>2]|=EXTRA[3&td],this.block=T[16],td>=56&&(this.hashed||this.hash(),T[0]=this.block,T[16]=T[1]=T[2]=T[3]=T[4]=T[5]=T[6]=T[7]=T[8]=T[9]=T[10]=T[11]=T[12]=T[13]=T[14]=T[15]=0),T[14]=this.hBytes<<3|this.bytes>>>29,T[15]=this.bytes<<3,this.hash()}},Sha256.prototype.hash=function(){var T,td,tf,tb,t_,tg,tv,tw,tI,tS,tA,tT=this.h0,tB=this.h1,tF=this.h2,tO=this.h3,tD=this.h4,tM=this.h5,tE=this.h6,tU=this.h7,tx=this.blocks;for(T=16;T<64;++T)td=((t_=tx[T-15])>>>7|t_<<25)^(t_>>>18|t_<<14)^t_>>>3,tf=((t_=tx[T-2])>>>17|t_<<15)^(t_>>>19|t_<<13)^t_>>>10,tx[T]=tx[T-16]+td+tx[T-7]+tf<<0;for(tA=tB&tF,T=0;T<64;T+=4)this.first?(this.is224?(tw=300032,tU=(t_=tx[0]-1413257819)-150054599<<0,tO=t_+24177077<<0):(tw=704751109,tU=(t_=tx[0]-210244248)-1521486534<<0,tO=t_+143694565<<0),this.first=!1):(td=(tT>>>2|tT<<30)^(tT>>>13|tT<<19)^(tT>>>22|tT<<10),tf=(tD>>>6|tD<<26)^(tD>>>11|tD<<21)^(tD>>>25|tD<<7),tb=(tw=tT&tB)^tT&tF^tA,t_=tU+tf+(tv=tD&tM^~tD&tE)+K[T]+tx[T],tg=td+tb,tU=tO+t_<<0,tO=t_+tg<<0),td=(tO>>>2|tO<<30)^(tO>>>13|tO<<19)^(tO>>>22|tO<<10),tf=(tU>>>6|tU<<26)^(tU>>>11|tU<<21)^(tU>>>25|tU<<7),tb=(tI=tO&tT)^tO&tB^tw,t_=tE+tf+(tv=tU&tD^~tU&tM)+K[T+1]+tx[T+1],tg=td+tb,tE=tF+t_<<0,td=((tF=t_+tg<<0)>>>2|tF<<30)^(tF>>>13|tF<<19)^(tF>>>22|tF<<10),tf=(tE>>>6|tE<<26)^(tE>>>11|tE<<21)^(tE>>>25|tE<<7),tb=(tS=tF&tO)^tF&tT^tI,t_=tM+tf+(tv=tE&tU^~tE&tD)+K[T+2]+tx[T+2],tg=td+tb,tM=tB+t_<<0,td=((tB=t_+tg<<0)>>>2|tB<<30)^(tB>>>13|tB<<19)^(tB>>>22|tB<<10),tf=(tM>>>6|tM<<26)^(tM>>>11|tM<<21)^(tM>>>25|tM<<7),tb=(tA=tB&tF)^tB&tO^tS,t_=tD+tf+(tv=tM&tE^~tM&tU)+K[T+3]+tx[T+3],tg=td+tb,tD=tT+t_<<0,tT=t_+tg<<0;this.h0=this.h0+tT<<0,this.h1=this.h1+tB<<0,this.h2=this.h2+tF<<0,this.h3=this.h3+tO<<0,this.h4=this.h4+tD<<0,this.h5=this.h5+tM<<0,this.h6=this.h6+tE<<0,this.h7=this.h7+tU<<0},Sha256.prototype.hex=function(){this.finalize();var T=this.h0,td=this.h1,tf=this.h2,tb=this.h3,t_=this.h4,tg=this.h5,tv=this.h6,tw=this.h7,tI=HEX_CHARS[T>>28&15]+HEX_CHARS[T>>24&15]+HEX_CHARS[T>>20&15]+HEX_CHARS[T>>16&15]+HEX_CHARS[T>>12&15]+HEX_CHARS[T>>8&15]+HEX_CHARS[T>>4&15]+HEX_CHARS[15&T]+HEX_CHARS[td>>28&15]+HEX_CHARS[td>>24&15]+HEX_CHARS[td>>20&15]+HEX_CHARS[td>>16&15]+HEX_CHARS[td>>12&15]+HEX_CHARS[td>>8&15]+HEX_CHARS[td>>4&15]+HEX_CHARS[15&td]+HEX_CHARS[tf>>28&15]+HEX_CHARS[tf>>24&15]+HEX_CHARS[tf>>20&15]+HEX_CHARS[tf>>16&15]+HEX_CHARS[tf>>12&15]+HEX_CHARS[tf>>8&15]+HEX_CHARS[tf>>4&15]+HEX_CHARS[15&tf]+HEX_CHARS[tb>>28&15]+HEX_CHARS[tb>>24&15]+HEX_CHARS[tb>>20&15]+HEX_CHARS[tb>>16&15]+HEX_CHARS[tb>>12&15]+HEX_CHARS[tb>>8&15]+HEX_CHARS[tb>>4&15]+HEX_CHARS[15&tb]+HEX_CHARS[t_>>28&15]+HEX_CHARS[t_>>24&15]+HEX_CHARS[t_>>20&15]+HEX_CHARS[t_>>16&15]+HEX_CHARS[t_>>12&15]+HEX_CHARS[t_>>8&15]+HEX_CHARS[t_>>4&15]+HEX_CHARS[15&t_]+HEX_CHARS[tg>>28&15]+HEX_CHARS[tg>>24&15]+HEX_CHARS[tg>>20&15]+HEX_CHARS[tg>>16&15]+HEX_CHARS[tg>>12&15]+HEX_CHARS[tg>>8&15]+HEX_CHARS[tg>>4&15]+HEX_CHARS[15&tg]+HEX_CHARS[tv>>28&15]+HEX_CHARS[tv>>24&15]+HEX_CHARS[tv>>20&15]+HEX_CHARS[tv>>16&15]+HEX_CHARS[tv>>12&15]+HEX_CHARS[tv>>8&15]+HEX_CHARS[tv>>4&15]+HEX_CHARS[15&tv];return this.is224||(tI+=HEX_CHARS[tw>>28&15]+HEX_CHARS[tw>>24&15]+HEX_CHARS[tw>>20&15]+HEX_CHARS[tw>>16&15]+HEX_CHARS[tw>>12&15]+HEX_CHARS[tw>>8&15]+HEX_CHARS[tw>>4&15]+HEX_CHARS[15&tw]),tI},Sha256.prototype.toString=Sha256.prototype.hex,Sha256.prototype.digest=function(){this.finalize();var T=this.h0,td=this.h1,tf=this.h2,tb=this.h3,t_=this.h4,tg=this.h5,tv=this.h6,tw=this.h7,tI=[T>>24&255,T>>16&255,T>>8&255,255&T,td>>24&255,td>>16&255,td>>8&255,255&td,tf>>24&255,tf>>16&255,tf>>8&255,255&tf,tb>>24&255,tb>>16&255,tb>>8&255,255&tb,t_>>24&255,t_>>16&255,t_>>8&255,255&t_,tg>>24&255,tg>>16&255,tg>>8&255,255&tg,tv>>24&255,tv>>16&255,tv>>8&255,255&tv];return this.is224||tI.push(tw>>24&255,tw>>16&255,tw>>8&255,255&tw),tI},Sha256.prototype.array=Sha256.prototype.digest,Sha256.prototype.arrayBuffer=function(){this.finalize();var T=new ArrayBuffer(this.is224?28:32),td=new DataView(T);return td.setUint32(0,this.h0),td.setUint32(4,this.h1),td.setUint32(8,this.h2),td.setUint32(12,this.h3),td.setUint32(16,this.h4),td.setUint32(20,this.h5),td.setUint32(24,this.h6),this.is224||td.setUint32(28,this.h7),T},HmacSha256.prototype=new Sha256,HmacSha256.prototype.finalize=function(){if(Sha256.prototype.finalize.call(this),this.inner){this.inner=!1;var T=this.array();Sha256.call(this,this.is224,this.sharedMemory),this.update(this.oKeyPad),this.update(T),Sha256.prototype.finalize.call(this)}};var exports=createMethod();exports.sha256=exports,exports.sha224=createMethod(!0),exports.sha256.hmac=createHmacMethod(),exports.sha224.hmac=createHmacMethod(!0),COMMON_JS?module.exports=exports:(root.sha256=exports.sha256,root.sha224=exports.sha224,AMD&&define(function(){return exports}))}()}),ly={};function Uc(T,td){var tf={};for(var tb in T)Object.prototype.hasOwnProperty.call(T,tb)&&0>td.indexOf(tb)&&(tf[tb]=T[tb]);if(null!=T&&"function"==typeof Object.getOwnPropertySymbols)for(var t_=0,tb=Object.getOwnPropertySymbols(T);t_<tb.length;t_++)0>td.indexOf(tb[t_])&&Object.prototype.propertyIsEnumerable.call(T,tb[t_])&&(tf[tb[t_]]=T[tb[t_]]);return tf}function F(T,td,tf,tb){function t_(T){return T instanceof tf?T:new tf(function(td){td(T)})}return new(tf||(tf=Promise))(function(tf,tg){function tv(T){try{tI(tb.next(T))}catch(T){tg(T)}}function tw(T){try{tI(tb.throw(T))}catch(T){tg(T)}}function tI(T){T.done?tf(T.value):t_(T.value).then(tv,tw)}tI((tb=tb.apply(T,td||[])).next())})}function Mc(T){var td="function"==typeof Symbol&&Symbol.iterator,tf=td&&T[td],tb=0;if(tf)return tf.call(T);if(T&&"number"==typeof T.length)return{next:function(){return T&&tb>=T.length&&(T=void 0),{value:T&&T[tb++],done:!T}}};throw TypeError(td?"Object is not iterable.":"Symbol.iterator is not defined.")}function C(T){return this instanceof C?(this.v=T,this):new C(T)}function re(T,td,tf){if(!Symbol.asyncIterator)throw TypeError("Symbol.asyncIterator is not defined.");var tb,t_=tf.apply(T,td||[]),tg=[];return tb={},tv("next"),tv("throw"),tv("return"),tb[Symbol.asyncIterator]=function(){return this},tb;function tv(T){t_[T]&&(tb[T]=function(td){return new Promise(function(tf,tb){tg.push([T,td,tf,tb])>1||tw(T,td)})})}function tw(T,td){try{tI(t_[T](td))}catch(T){tT(tg[0][3],T)}}function tI(T){T.value instanceof C?Promise.resolve(T.value.v).then(tS,tA):tT(tg[0][2],T)}function tS(T){tw("next",T)}function tA(T){tw("throw",T)}function tT(T,td){T(td),tg.shift(),tg.length&&tw(tg[0][0],tg[0][1])}}function gn(T){var td,tf;return td={},tb("next"),tb("throw",function(T){throw T}),tb("return"),td[Symbol.iterator]=function(){return this},td;function tb(tb,t_){td[tb]=T[tb]?function(td){return(tf=!tf)?{value:C(T[tb](td)),done:!1}:t_?t_(td):td}:t_}}function ve(T){if(!Symbol.asyncIterator)throw TypeError("Symbol.asyncIterator is not defined.");var td,tf=T[Symbol.asyncIterator];return tf?tf.call(T):(T=Mc(T),td={},tb("next"),tb("throw"),tb("return"),td[Symbol.asyncIterator]=function(){return this},td);function tb(tf){td[tf]=T[tf]&&function(td){return new Promise(function(tb,tg){t_(tb,tg,(td=T[tf](td)).done,td.value)})}}function t_(T,td,tf,tb){Promise.resolve(tb).then(function(td){T({value:td,done:tf})},td)}}Xr(ly,{registerWorker:()=>Ru});var ea={};Xr(ea,{compareArrayLike:()=>ta,joinUint8Arrays:()=>ne,memcpy:()=>wn,rebaseValueOffsets:()=>Zn,toArrayBufferView:()=>W,toArrayBufferViewAsyncIterator:()=>Fe,toArrayBufferViewIterator:()=>Ve,toBigInt64Array:()=>Th,toBigUint64Array:()=>Eh,toFloat32Array:()=>Oh,toFloat32ArrayAsyncIterator:()=>Xh,toFloat32ArrayIterator:()=>Ph,toFloat64Array:()=>Rh,toFloat64ArrayAsyncIterator:()=>Gh,toFloat64ArrayIterator:()=>Vh,toInt16Array:()=>Ah,toInt16ArrayAsyncIterator:()=>jh,toInt16ArrayIterator:()=>Nh,toInt32Array:()=>Kr,toInt32ArrayAsyncIterator:()=>Wh,toInt32ArrayIterator:()=>Lh,toInt8Array:()=>Bh,toInt8ArrayAsyncIterator:()=>zh,toInt8ArrayIterator:()=>Uh,toUint16Array:()=>xh,toUint16ArrayAsyncIterator:()=>$h,toUint16ArrayIterator:()=>kh,toUint32Array:()=>Dh,toUint32ArrayAsyncIterator:()=>Yh,toUint32ArrayIterator:()=>Ch,toUint8Array:()=>L,toUint8ArrayAsyncIterator:()=>Qo,toUint8ArrayIterator:()=>Zo,toUint8ClampedArray:()=>Mh,toUint8ClampedArrayAsyncIterator:()=>Kh,toUint8ClampedArrayIterator:()=>Hh});var vh=new TextDecoder("utf-8"),Jn=T=>vh.decode(T),Sh=new TextEncoder,Br=T=>Sh.encode(T),Ih=T=>"number"==typeof T,Nc=T=>"boolean"==typeof T,Dt=T=>"function"==typeof T,zt=T=>null!=T&&Object(T)===T,Se=T=>zt(T)&&Dt(T.then),Ie=T=>zt(T)&&Dt(T[Symbol.iterator]),he=T=>zt(T)&&Dt(T[Symbol.asyncIterator]),is=T=>zt(T)&&zt(T.schema),ss=T=>zt(T)&&"done"in T&&"value"in T,os=T=>zt(T)&&Dt(T.stat)&&Ih(T.fd),as=T=>zt(T)&&qn(T.body),cs=T=>"_getDOMStream"in T&&"_getNodeStream"in T,Lc=T=>zt(T)&&Dt(T.abort)&&Dt(T.getWriter)&&!cs(T),qn=T=>zt(T)&&Dt(T.cancel)&&Dt(T.getReader)&&!cs(T),kc=T=>zt(T)&&Dt(T.end)&&Dt(T.write)&&Nc(T.writable)&&!cs(T),ls=T=>zt(T)&&Dt(T.read)&&Dt(T.pipe)&&Nc(T.readable)&&!cs(T),Cc=T=>zt(T)&&Dt(T.clear)&&Dt(T.bytes)&&Dt(T.position)&&Dt(T.setPosition)&&Dt(T.capacity)&&Dt(T.getBufferIdentifier)&&Dt(T.createLong),qo="u">typeof SharedArrayBuffer?SharedArrayBuffer:ArrayBuffer;function Fh(T){let td=T[0]?[T[0]]:[],tf,tb,t_,tg;for(let tv,tw,tI=0,tS=0,tA=T.length;++tI<tA;){if(tv=td[tS],tw=T[tI],!tv||!tw||tv.buffer!==tw.buffer||tw.byteOffset<tv.byteOffset||({byteOffset:tf,byteLength:t_}=tv,{byteOffset:tb,byteLength:tg}=tw,tf+t_<tb||tb+tg<tf)){tw&&(td[++tS]=tw);continue}td[tS]=new Uint8Array(tv.buffer,tf,tb-tf+tg)}return td}function wn(T,td,tf=0,tb=td.byteLength){let t_=T.byteLength,tg=new Uint8Array(T.buffer,T.byteOffset,t_),tv=new Uint8Array(td.buffer,td.byteOffset,Math.min(tb,t_));return tg.set(tv,tf),T}function ne(T,td){let tf=Fh(T),tb=tf.reduce((T,td)=>T+td.byteLength,0),t_,tg,tv,tw=0,tI=-1,tS=Math.min(td||Number.POSITIVE_INFINITY,tb);for(let T=tf.length;++tI<T;){if(tg=(t_=tf[tI]).subarray(0,Math.min(t_.length,tS-tw)),tS<=tw+tg.length){tg.length<t_.length?tf[tI]=t_.subarray(tg.length):tg.length===t_.length&&tI++,tv?wn(tv,tg,tw):tv=tg;break}wn(tv||(tv=new Uint8Array(tS)),tg,tw),tw+=tg.length}return[tv||new Uint8Array(0),tf.slice(tI),tb-(tv?tv.byteLength:0)]}function W(T,td){let tf=ss(td)?td.value:td;return tf instanceof T?T===Uint8Array?new T(tf.buffer,tf.byteOffset,tf.byteLength):tf:tf?("string"==typeof tf&&(tf=Br(tf)),tf instanceof ArrayBuffer?new T(tf):tf instanceof qo?new T(tf):Cc(tf)?W(T,tf.bytes()):ArrayBuffer.isView(tf)?tf.byteLength<=0?new T(0):new T(tf.buffer,tf.byteOffset,tf.byteLength/T.BYTES_PER_ELEMENT):T.from(tf)):new T(0)}var Bh=T=>W(Int8Array,T),Ah=T=>W(Int16Array,T),Kr=T=>W(Int32Array,T),Th=T=>W(BigInt64Array,T),L=T=>W(Uint8Array,T),xh=T=>W(Uint16Array,T),Dh=T=>W(Uint32Array,T),Eh=T=>W(BigUint64Array,T),Oh=T=>W(Float32Array,T),Rh=T=>W(Float64Array,T),Mh=T=>W(Uint8ClampedArray,T),Jo=T=>(T.next(),T);function*Ve(T,td){let tf=function*(T){yield T},tb="string"==typeof td||ArrayBuffer.isView(td)||td instanceof ArrayBuffer||td instanceof qo?tf(td):Ie(td)?td:tf(td);return yield*Gr(Jo(function*(td){let tf=null;do tf=td.next((yield W(T,tf)));while(!tf.done)}(tb[Symbol.iterator]()))),new T}var Uh=T=>Ve(Int8Array,T),Nh=T=>Ve(Int16Array,T),Lh=T=>Ve(Int32Array,T),Zo=T=>Ve(Uint8Array,T),kh=T=>Ve(Uint16Array,T),Ch=T=>Ve(Uint32Array,T),Ph=T=>Ve(Float32Array,T),Vh=T=>Ve(Float64Array,T),Hh=T=>Ve(Uint8ClampedArray,T);function Fe(T,td){return re(this,arguments,function*(){if(Se(td))return yield C((yield C((yield*Gr(gn(ve(Fe(T,(yield C(td))))))))));let tf=function(T){return re(this,arguments,function*(){yield yield C((yield C(T)))})},tb=function(T){return re(this,arguments,function*(){yield C((yield*Gr(gn(ve(Jo(function*(T){let td=null;do td=T.next((yield null==td?void 0:td.value));while(!td.done)}(T[Symbol.iterator]())))))))})},t_="string"==typeof td||ArrayBuffer.isView(td)||td instanceof ArrayBuffer||td instanceof qo?tf(td):Ie(td)?tb(td):he(td)?td:tf(td);return yield C((yield*Gr(gn(ve(Jo(function(td){return re(this,arguments,function*(){let tf=null;do tf=yield C(td.next((yield yield C(W(T,tf)))));while(!tf.done)})}(t_[Symbol.asyncIterator]()))))))),yield C(new T)})}var zh=T=>Fe(Int8Array,T),jh=T=>Fe(Int16Array,T),Wh=T=>Fe(Int32Array,T),Qo=T=>Fe(Uint8Array,T),$h=T=>Fe(Uint16Array,T),Yh=T=>Fe(Uint32Array,T),Xh=T=>Fe(Float32Array,T),Gh=T=>Fe(Float64Array,T),Kh=T=>Fe(Uint8ClampedArray,T);function Zn(T,td,tf){if(0!==T){tf=tf.slice(0,td+1);for(let tb=-1;++tb<=td;)tf[tb]+=T}return tf}function ta(T,td){let tf=0,tb=T.length;if(tb!==td.length)return!1;if(tb>0)do if(T[tf]!==td[tf])return!1;while(++tf<tb);return!0}var Ut={fromIterable:T=>us(Jh(T)),fromAsyncIterable:T=>us(qh(T)),fromDOMStream:T=>us(Zh(T)),fromNodeStream:T=>us(Qh(T)),toDOMStream(T,td){throw Error('"toDOMStream" not available in this environment')},toNodeStream(T,td){throw Error('"toNodeStream" not available in this environment')}},us=T=>(T.next(),T);function*Jh(T){let td,tf=!1,tb=[],t_,tg,tv,tw=0;function tI(){return"peek"===tg?ne(tb,tv)[0]:([t_,tb,tw]=ne(tb,tv),t_)}({cmd:tg,size:tv}=yield null);let tS=Zo(T)[Symbol.iterator]();try{do if({done:td,value:t_}=Number.isNaN(tv-tw)?tS.next():tS.next(tv-tw),!td&&t_.byteLength>0&&(tb.push(t_),tw+=t_.byteLength),td||tv<=tw)do({cmd:tg,size:tv}=yield tI());while(tv<tw);while(!td)}catch(T){tf=!0,"function"==typeof tS.throw&&tS.throw(T)}finally{!1===tf&&"function"==typeof tS.return&&tS.return(null)}return null}function qh(T){return re(this,arguments,function*(){let td,tf=!1,tb=[],t_,tg,tv,tw=0;function tI(){return"peek"===tg?ne(tb,tv)[0]:([t_,tb,tw]=ne(tb,tv),t_)}({cmd:tg,size:tv}=yield yield C(null));let tS=Qo(T)[Symbol.asyncIterator]();try{do if({done:td,value:t_}=Number.isNaN(tv-tw)?yield C(tS.next()):yield C(tS.next(tv-tw)),!td&&t_.byteLength>0&&(tb.push(t_),tw+=t_.byteLength),td||tv<=tw)do({cmd:tg,size:tv}=yield yield C(tI()));while(tv<tw);while(!td)}catch(T){tf=!0,"function"==typeof tS.throw&&(yield C(tS.throw(T)))}finally{!1===tf&&"function"==typeof tS.return&&(yield C(tS.return(new Uint8Array(0))))}return yield C(null)})}function Zh(T){return re(this,arguments,function*(){let td=!1,tf=!1,tb=[],t_,tg,tv,tw=0;function tI(){return"peek"===tg?ne(tb,tv)[0]:([t_,tb,tw]=ne(tb,tv),t_)}({cmd:tg,size:tv}=yield yield C(null));let tS=new na(T);try{do if({done:td,value:t_}=Number.isNaN(tv-tw)?yield C(tS.read()):yield C(tS.read(tv-tw)),!td&&t_.byteLength>0&&(tb.push(L(t_)),tw+=t_.byteLength),td||tv<=tw)do({cmd:tg,size:tv}=yield yield C(tI()));while(tv<tw);while(!td)}catch(T){tf=!0,yield C(tS.cancel(T))}finally{!1===tf?yield C(tS.cancel()):T.locked&&tS.releaseLock()}return yield C(null)})}var na=class{constructor(T){this.source=T,this.reader=null,this.reader=this.source.getReader(),this.reader.closed.catch(()=>{})}get closed(){return this.reader?this.reader.closed.catch(()=>{}):Promise.resolve()}releaseLock(){this.reader&&this.reader.releaseLock(),this.reader=null}cancel(T){return F(this,void 0,void 0,function*(){let{reader:td,source:tf}=this;td&&(yield td.cancel(T).catch(()=>{})),tf&&tf.locked&&this.releaseLock()})}read(T){return F(this,void 0,void 0,function*(){if(0===T)return{done:null==this.reader,value:new Uint8Array(0)};let td=yield this.reader.read();return td.done||(td.value=L(td)),td})}},ra=(T,td)=>{let tf=T=>tb([td,T]),tb;return[td,tf,new Promise(t_=>(tb=t_)&&T.once(td,tf))]};function Qh(T){return re(this,arguments,function*(){let td=[],tf="error",tb=!1,t_=null,tg,tv,tw=0,tI=[],tS;function tA(){return"peek"===tg?ne(tI,tv)[0]:([tS,tI,tw]=ne(tI,tv),tS)}if({cmd:tg,size:tv}=yield yield C(null),T.isTTY)return yield yield C(new Uint8Array(0)),yield C(null);try{td[0]=ra(T,"end"),td[1]=ra(T,"error");do{if(td[2]=ra(T,"readable"),[tf,t_]=yield C(Promise.race(td.map(T=>T[2]))),"error"===tf)break;if((tb="end"===tf)||(Number.isFinite(tv-tw)?(tS=L(T.read(tv-tw))).byteLength<tv-tw&&(tS=L(T.read())):tS=L(T.read()),tS.byteLength>0&&(tI.push(tS),tw+=tS.byteLength)),tb||tv<=tw)do({cmd:tg,size:tv}=yield yield C(tA()));while(tv<tw)}while(!tb)}finally{yield C(tT(td,"error"===tf?t_:null))}return yield C(null);function tT(td,tf){return tS=tI=null,new Promise((tb,t_)=>{for(let[tf,tb]of td)T.off(tf,tb);try{let td=T.destroy;td&&td.call(T,tf),tf=void 0}catch(T){tf=T||tf}finally{null!=tf?t_(tf):tb()}})}})}!function(T){T[T.V1=0]="V1",T[T.V2=1]="V2",T[T.V3=2]="V3",T[T.V4=3]="V4",T[T.V5=4]="V5"}(Ot||(Ot={})),function(T){T[T.Sparse=0]="Sparse",T[T.Dense=1]="Dense"}(yt||(yt={})),function(T){T[T.HALF=0]="HALF",T[T.SINGLE=1]="SINGLE",T[T.DOUBLE=2]="DOUBLE"}(ht||(ht={})),function(T){T[T.DAY=0]="DAY",T[T.MILLISECOND=1]="MILLISECOND"}(Nt||(Nt={})),function(T){T[T.SECOND=0]="SECOND",T[T.MILLISECOND=1]="MILLISECOND",T[T.MICROSECOND=2]="MICROSECOND",T[T.NANOSECOND=3]="NANOSECOND"}(G||(G={})),function(T){T[T.YEAR_MONTH=0]="YEAR_MONTH",T[T.DAY_TIME=1]="DAY_TIME",T[T.MONTH_DAY_NANO=2]="MONTH_DAY_NANO"}(jt||(jt={})),function(T){T[T.NONE=0]="NONE",T[T.Schema=1]="Schema",T[T.DictionaryBatch=2]="DictionaryBatch",T[T.RecordBatch=3]="RecordBatch",T[T.Tensor=4]="Tensor",T[T.SparseTensor=5]="SparseTensor"}(tt||(tt={})),function(T){T[T.NONE=0]="NONE",T[T.Null=1]="Null",T[T.Int=2]="Int",T[T.Float=3]="Float",T[T.Binary=4]="Binary",T[T.Utf8=5]="Utf8",T[T.Bool=6]="Bool",T[T.Decimal=7]="Decimal",T[T.Date=8]="Date",T[T.Time=9]="Time",T[T.Timestamp=10]="Timestamp",T[T.Interval=11]="Interval",T[T.List=12]="List",T[T.Struct=13]="Struct",T[T.Union=14]="Union",T[T.FixedSizeBinary=15]="FixedSizeBinary",T[T.FixedSizeList=16]="FixedSizeList",T[T.Map=17]="Map",T[T.Dictionary=-1]="Dictionary",T[T.Int8=-2]="Int8",T[T.Int16=-3]="Int16",T[T.Int32=-4]="Int32",T[T.Int64=-5]="Int64",T[T.Uint8=-6]="Uint8",T[T.Uint16=-7]="Uint16",T[T.Uint32=-8]="Uint32",T[T.Uint64=-9]="Uint64",T[T.Float16=-10]="Float16",T[T.Float32=-11]="Float32",T[T.Float64=-12]="Float64",T[T.DateDay=-13]="DateDay",T[T.DateMillisecond=-14]="DateMillisecond",T[T.TimestampSecond=-15]="TimestampSecond",T[T.TimestampMillisecond=-16]="TimestampMillisecond",T[T.TimestampMicrosecond=-17]="TimestampMicrosecond",T[T.TimestampNanosecond=-18]="TimestampNanosecond",T[T.TimeSecond=-19]="TimeSecond",T[T.TimeMillisecond=-20]="TimeMillisecond",T[T.TimeMicrosecond=-21]="TimeMicrosecond",T[T.TimeNanosecond=-22]="TimeNanosecond",T[T.DenseUnion=-23]="DenseUnion",T[T.SparseUnion=-24]="SparseUnion",T[T.IntervalDayTime=-25]="IntervalDayTime",T[T.IntervalYearMonth=-26]="IntervalYearMonth"}(h||(h={})),function(T){T[T.OFFSET=0]="OFFSET",T[T.DATA=1]="DATA",T[T.VALIDITY=2]="VALIDITY",T[T.TYPE=3]="TYPE"}(pe||(pe={}));var wa={};function He(T){if(null===T)return"null";if(void 0===T)return"undefined";switch(typeof T){case"number":case"bigint":return"".concat(T);case"string":return'"'.concat(T,'"')}return"function"==typeof T[Symbol.toPrimitive]?T[Symbol.toPrimitive]("string"):ArrayBuffer.isView(T)?T instanceof BigInt64Array||T instanceof BigUint64Array?"[".concat([...T].map(T=>He(T)),"]"):"[".concat(T,"]"):ArrayBuffer.isView(T)?"[".concat(T,"]"):JSON.stringify(T,(T,td)=>"bigint"==typeof td?"".concat(td):td)}Xr(wa,{clampIndex:()=>jp,clampRange:()=>ri,createElementComparator:()=>xr});var sa={};Xr(sa,{BN:()=>ti,bigNumToBigInt:()=>Hc,bigNumToString:()=>In,isArrowBigNumSymbol:()=>Pc});var Pc=Symbol.for("isArrowBigNum");function Be(T,...td){return 0===td.length?Object.setPrototypeOf(W(this.TypedArray,T),this.constructor.prototype):Object.setPrototypeOf(new this.TypedArray(T,...td),this.constructor.prototype)}function vn(...T){return Be.apply(this,T)}function Sn(...T){return Be.apply(this,T)}function Qn(...T){return Be.apply(this,T)}function Vc(T){let{buffer:td,byteOffset:tf,length:tb,signed:t_}=T,tg=new BigUint64Array(td,tf,tb),tv=t_&&tg.at(-1)&BigInt(1)<<BigInt(63),tw=BigInt(tv?1:0),tI=BigInt(0);if(tv){for(let T of tg)tw+=~T*(BigInt(1)<<BigInt(32)*tI++);tw*=BigInt(-1)}else for(let T of tg)tw+=T*(BigInt(1)<<BigInt(32)*tI++);return tw}Be.prototype[Pc]=!0,Be.prototype.toJSON=function(){return'"'.concat(In(this),'"')},Be.prototype.valueOf=function(){return Vc(this)},Be.prototype.toString=function(){return In(this)},Be.prototype[Symbol.toPrimitive]=function(T="default"){switch(T){case"number":return Vc(this);case"string":break;case"default":return Hc(this)}return In(this)},Object.setPrototypeOf(vn.prototype,Object.create(Int32Array.prototype)),Object.setPrototypeOf(Sn.prototype,Object.create(Uint32Array.prototype)),Object.setPrototypeOf(Qn.prototype,Object.create(Uint32Array.prototype)),Object.assign(vn.prototype,Be.prototype,{constructor:vn,signed:!0,TypedArray:Int32Array,BigIntArray:BigInt64Array}),Object.assign(Sn.prototype,Be.prototype,{constructor:Sn,signed:!1,TypedArray:Uint32Array,BigIntArray:BigUint64Array}),Object.assign(Qn.prototype,Be.prototype,{constructor:Qn,signed:!0,TypedArray:Uint32Array,BigIntArray:BigUint64Array});var In=T=>{if(8===T.byteLength){let td=new T.BigIntArray(T.buffer,T.byteOffset,1);return"".concat(td[0])}if(!T.signed)return ia(T);let td=new Uint16Array(T.buffer,T.byteOffset,T.byteLength/2);if(new Int16Array([td.at(-1)])[0]>=0)return ia(T);td=td.slice();let tf=1;for(let T=0;T<td.length;T++){let tb=td[T],t_=~tb+tf;td[T]=t_,tf&=0===tb?1:0}let tb=ia(td);return"-".concat(tb)},Hc=T=>8===T.byteLength?new T.BigIntArray(T.buffer,T.byteOffset,1)[0]:In(T);function ia(T){let td="",tf=new Uint32Array(2),tb=new Uint16Array(T.buffer,T.byteOffset,T.byteLength/2),t_=new Uint32Array((tb=new Uint16Array(tb).reverse()).buffer),tg=-1,tv=tb.length-1;do{for(tf[0]=tb[tg=0];tg<tv;)tb[tg++]=tf[1]=tf[0]/10,tf[0]=(tf[0]-10*tf[1]<<16)+tb[tg];tb[tg]=tf[1]=tf[0]/10,tf[0]=tf[0]-10*tf[1],td="".concat(tf[0]).concat(td)}while(t_[0]||t_[1]||t_[2]||t_[3]);return null!=td?td:"0"}var ti=class r{static new(T,td){switch(td){case!0:return new vn(T);case!1:return new Sn(T)}switch(T.constructor){case Int8Array:case Int16Array:case Int32Array:case BigInt64Array:return new vn(T)}return 16===T.byteLength?new Qn(T):new Sn(T)}static signed(T){return new vn(T)}static unsigned(T){return new Sn(T)}static decimal(T){return new Qn(T)}constructor(T,td){return r.new(T,td)}};function Gt(T){if("bigint"==typeof T&&(T<Number.MIN_SAFE_INTEGER||T>Number.MAX_SAFE_INTEGER))throw TypeError("".concat(T," is not safe to convert to a number."));return Number(T)}var r,Ot,yt,ht,Nt,G,jt,tt,h,pe,zc,jc,Wc,$c,Yc,Xc,Gc,Kc,Jc,qc,Zc,Qc,tl,el,rl,nl,il,sl,ol,D=class r{static isNull(T){return(null==T?void 0:T.typeId)===h.Null}static isInt(T){return(null==T?void 0:T.typeId)===h.Int}static isFloat(T){return(null==T?void 0:T.typeId)===h.Float}static isBinary(T){return(null==T?void 0:T.typeId)===h.Binary}static isUtf8(T){return(null==T?void 0:T.typeId)===h.Utf8}static isBool(T){return(null==T?void 0:T.typeId)===h.Bool}static isDecimal(T){return(null==T?void 0:T.typeId)===h.Decimal}static isDate(T){return(null==T?void 0:T.typeId)===h.Date}static isTime(T){return(null==T?void 0:T.typeId)===h.Time}static isTimestamp(T){return(null==T?void 0:T.typeId)===h.Timestamp}static isInterval(T){return(null==T?void 0:T.typeId)===h.Interval}static isList(T){return(null==T?void 0:T.typeId)===h.List}static isStruct(T){return(null==T?void 0:T.typeId)===h.Struct}static isUnion(T){return(null==T?void 0:T.typeId)===h.Union}static isFixedSizeBinary(T){return(null==T?void 0:T.typeId)===h.FixedSizeBinary}static isFixedSizeList(T){return(null==T?void 0:T.typeId)===h.FixedSizeList}static isMap(T){return(null==T?void 0:T.typeId)===h.Map}static isDictionary(T){return(null==T?void 0:T.typeId)===h.Dictionary}static isDenseUnion(T){return r.isUnion(T)&&T.mode===yt.Dense}static isSparseUnion(T){return r.isUnion(T)&&T.mode===yt.Sparse}get typeId(){return h.NONE}};zc=Symbol.toStringTag,D[zc]=(r=D.prototype,r.children=null,r.ArrayType=Array,r[Symbol.toStringTag]="DataType");var Wt=class extends D{toString(){return"Null"}get typeId(){return h.Null}};jc=Symbol.toStringTag,Wt[jc]=(r=Wt.prototype,r[Symbol.toStringTag]="Null");var St=class extends D{constructor(T,td){super(),this.isSigned=T,this.bitWidth=td}get typeId(){return h.Int}get ArrayType(){switch(this.bitWidth){case 8:return this.isSigned?Int8Array:Uint8Array;case 16:return this.isSigned?Int16Array:Uint16Array;case 32:return this.isSigned?Int32Array:Uint32Array;case 64:return this.isSigned?BigInt64Array:BigUint64Array}throw Error("Unrecognized ".concat(this[Symbol.toStringTag]," type"))}toString(){return"".concat(this.isSigned?"I":"Ui","nt").concat(this.bitWidth)}};Wc=Symbol.toStringTag,St[Wc]=(r=St.prototype,r.isSigned=null,r.bitWidth=null,r[Symbol.toStringTag]="Int");var ds=class extends St{constructor(){super(!0,8)}get ArrayType(){return Int8Array}},fs=class extends St{constructor(){super(!0,16)}get ArrayType(){return Int16Array}},ze=class extends St{constructor(){super(!0,32)}get ArrayType(){return Int32Array}},hs=class extends St{constructor(){super(!0,64)}get ArrayType(){return BigInt64Array}},ps=class extends St{constructor(){super(!1,8)}get ArrayType(){return Uint8Array}},ms=class extends St{constructor(){super(!1,16)}get ArrayType(){return Uint16Array}},ys=class extends St{constructor(){super(!1,32)}get ArrayType(){return Uint32Array}},_s=class extends St{constructor(){super(!1,64)}get ArrayType(){return BigUint64Array}};Object.defineProperty(ds.prototype,"ArrayType",{value:Int8Array}),Object.defineProperty(fs.prototype,"ArrayType",{value:Int16Array}),Object.defineProperty(ze.prototype,"ArrayType",{value:Int32Array}),Object.defineProperty(hs.prototype,"ArrayType",{value:BigInt64Array}),Object.defineProperty(ps.prototype,"ArrayType",{value:Uint8Array}),Object.defineProperty(ms.prototype,"ArrayType",{value:Uint16Array}),Object.defineProperty(ys.prototype,"ArrayType",{value:Uint32Array}),Object.defineProperty(_s.prototype,"ArrayType",{value:BigUint64Array});var Kt=class extends D{constructor(T){super(),this.precision=T}get typeId(){return h.Float}get ArrayType(){switch(this.precision){case ht.HALF:return Uint16Array;case ht.SINGLE:return Float32Array;case ht.DOUBLE:return Float64Array}throw Error("Unrecognized ".concat(this[Symbol.toStringTag]," type"))}toString(){return"Float".concat(this.precision<<5||16)}};$c=Symbol.toStringTag,Kt[$c]=(r=Kt.prototype,r.precision=null,r[Symbol.toStringTag]="Float");var bs=class extends Kt{constructor(){super(ht.HALF)}},gs=class extends Kt{constructor(){super(ht.SINGLE)}},ws=class extends Kt{constructor(){super(ht.DOUBLE)}};Object.defineProperty(bs.prototype,"ArrayType",{value:Uint16Array}),Object.defineProperty(gs.prototype,"ArrayType",{value:Float32Array}),Object.defineProperty(ws.prototype,"ArrayType",{value:Float64Array});var nr=class extends D{constructor(){super()}get typeId(){return h.Binary}toString(){return"Binary"}};Yc=Symbol.toStringTag,nr[Yc]=(r=nr.prototype,r.ArrayType=Uint8Array,r[Symbol.toStringTag]="Binary");var ir=class extends D{constructor(){super()}get typeId(){return h.Utf8}toString(){return"Utf8"}};Xc=Symbol.toStringTag,ir[Xc]=(r=ir.prototype,r.ArrayType=Uint8Array,r[Symbol.toStringTag]="Utf8");var sr=class extends D{constructor(){super()}get typeId(){return h.Bool}toString(){return"Bool"}};Gc=Symbol.toStringTag,sr[Gc]=(r=sr.prototype,r.ArrayType=Uint8Array,r[Symbol.toStringTag]="Bool");var or=class extends D{constructor(T,td,tf=128){super(),this.scale=T,this.precision=td,this.bitWidth=tf}get typeId(){return h.Decimal}toString(){return"Decimal[".concat(this.precision,"e").concat(this.scale>0?"+":"").concat(this.scale,"]")}};Kc=Symbol.toStringTag,or[Kc]=(r=or.prototype,r.scale=null,r.precision=null,r.ArrayType=Uint32Array,r[Symbol.toStringTag]="Decimal");var ar=class extends D{constructor(T){super(),this.unit=T}get typeId(){return h.Date}toString(){return"Date".concat((this.unit+1)*32,"<").concat(Nt[this.unit],">")}};Jc=Symbol.toStringTag,ar[Jc]=(r=ar.prototype,r.unit=null,r.ArrayType=Int32Array,r[Symbol.toStringTag]="Date");var Ae=class extends D{constructor(T,td){super(),this.unit=T,this.bitWidth=td}get typeId(){return h.Time}toString(){return"Time".concat(this.bitWidth,"<").concat(G[this.unit],">")}get ArrayType(){switch(this.bitWidth){case 32:return Int32Array;case 64:return BigInt64Array}throw Error("Unrecognized ".concat(this[Symbol.toStringTag]," type"))}};qc=Symbol.toStringTag,Ae[qc]=(r=Ae.prototype,r.unit=null,r.bitWidth=null,r[Symbol.toStringTag]="Time");var cr=class extends D{constructor(T,td){super(),this.unit=T,this.timezone=td}get typeId(){return h.Timestamp}toString(){return"Timestamp<".concat(G[this.unit]).concat(this.timezone?", ".concat(this.timezone):"",">")}};Zc=Symbol.toStringTag,cr[Zc]=(r=cr.prototype,r.unit=null,r.timezone=null,r.ArrayType=Int32Array,r[Symbol.toStringTag]="Timestamp");var lr=class extends D{constructor(T){super(),this.unit=T}get typeId(){return h.Interval}toString(){return"Interval<".concat(jt[this.unit],">")}};Qc=Symbol.toStringTag,lr[Qc]=(r=lr.prototype,r.unit=null,r.ArrayType=Int32Array,r[Symbol.toStringTag]="Interval");var Te=class extends D{constructor(T){super(),this.children=[T]}get typeId(){return h.List}toString(){return"List<".concat(this.valueType,">")}get valueType(){return this.children[0].type}get valueField(){return this.children[0]}get ArrayType(){return this.valueType.ArrayType}};tl=Symbol.toStringTag,Te[tl]=(r=Te.prototype,r.children=null,r[Symbol.toStringTag]="List");var ut=class extends D{constructor(T){super(),this.children=T}get typeId(){return h.Struct}toString(){return"Struct<{".concat(this.children.map(T=>"".concat(T.name,":").concat(T.type)).join(", "),"}>")}};el=Symbol.toStringTag,ut[el]=(r=ut.prototype,r.children=null,r[Symbol.toStringTag]="Struct");var xe=class extends D{constructor(T,td,tf){super(),this.mode=T,this.children=tf,this.typeIds=td=Int32Array.from(td),this.typeIdToChildIndex=td.reduce((T,td,tf)=>(T[td]=tf)&&T||T,Object.create(null))}get typeId(){return h.Union}toString(){return"".concat(this[Symbol.toStringTag],"<").concat(this.children.map(T=>"".concat(T.type)).join(" | "),">")}};rl=Symbol.toStringTag,xe[rl]=(r=xe.prototype,r.mode=null,r.typeIds=null,r.children=null,r.typeIdToChildIndex=null,r.ArrayType=Int8Array,r[Symbol.toStringTag]="Union");var ur=class extends D{constructor(T){super(),this.byteWidth=T}get typeId(){return h.FixedSizeBinary}toString(){return"FixedSizeBinary[".concat(this.byteWidth,"]")}};nl=Symbol.toStringTag,ur[nl]=(r=ur.prototype,r.byteWidth=null,r.ArrayType=Uint8Array,r[Symbol.toStringTag]="FixedSizeBinary");var De=class extends D{constructor(T,td){super(),this.listSize=T,this.children=[td]}get typeId(){return h.FixedSizeList}get valueType(){return this.children[0].type}get valueField(){return this.children[0]}get ArrayType(){return this.valueType.ArrayType}toString(){return"FixedSizeList[".concat(this.listSize,"]<").concat(this.valueType,">")}};il=Symbol.toStringTag,De[il]=(r=De.prototype,r.children=null,r.listSize=null,r[Symbol.toStringTag]="FixedSizeList");var Ee=class extends D{constructor(T,td=!1){super(),this.children=[T],this.keysSorted=td}get typeId(){return h.Map}get keyType(){return this.children[0].type.children[0].type}get valueType(){return this.children[0].type.children[1].type}get childType(){return this.children[0].type}toString(){return"Map<{".concat(this.children[0].type.children.map(T=>"".concat(T.name,":").concat(T.type)).join(", "),"}>")}};sl=Symbol.toStringTag,Ee[sl]=(r=Ee.prototype,r.children=null,r.keysSorted=null,r[Symbol.toStringTag]="Map_");var tp=(r=-1,()=>++r),ie=class extends D{constructor(T,td,tf,tb){super(),this.indices=td,this.dictionary=T,this.isOrdered=tb||!1,this.id=null==tf?tp():Gt(tf)}get typeId(){return h.Dictionary}get children(){return this.dictionary.children}get valueType(){return this.dictionary}get ArrayType(){return this.dictionary.ArrayType}toString(){return"Dictionary<".concat(this.indices,", ").concat(this.dictionary,">")}};function se(T){let td=T;switch(T.typeId){case h.Decimal:return T.bitWidth/32;case h.Timestamp:return 2;case h.Date:case h.Interval:return 1+td.unit;case h.FixedSizeList:return td.listSize;case h.FixedSizeBinary:return td.byteWidth;default:return 1}}ol=Symbol.toStringTag,ie[ol]=(r=ie.prototype,r.id=null,r.indices=null,r.isOrdered=null,r.dictionary=null,r[Symbol.toStringTag]="Dictionary");var E=class{visitMany(T,...td){return T.map((T,tf)=>this.visit(T,...td.map(T=>T[tf])))}visit(...T){return this.getVisitFn(T[0],!1).apply(this,T)}getVisitFn(T,td=!0){return ep(this,T,td)}getVisitFnByTypeId(T,td=!0){return Fn(this,T,td)}visitNull(T,...td){return null}visitBool(T,...td){return null}visitInt(T,...td){return null}visitFloat(T,...td){return null}visitUtf8(T,...td){return null}visitBinary(T,...td){return null}visitFixedSizeBinary(T,...td){return null}visitDate(T,...td){return null}visitTimestamp(T,...td){return null}visitTime(T,...td){return null}visitDecimal(T,...td){return null}visitList(T,...td){return null}visitStruct(T,...td){return null}visitUnion(T,...td){return null}visitDictionary(T,...td){return null}visitInterval(T,...td){return null}visitFixedSizeList(T,...td){return null}visitMap(T,...td){return null}};function ep(T,td,tf=!0){return"number"==typeof td?Fn(T,td,tf):"string"==typeof td&&td in h?Fn(T,h[td],tf):td&&td instanceof D?Fn(T,al(td),tf):null!=td&&td.type&&td.type instanceof D?Fn(T,al(td.type),tf):Fn(T,h.NONE,tf)}function Fn(T,td,tf=!0){let tb=null;switch(td){case h.Null:tb=T.visitNull;break;case h.Bool:tb=T.visitBool;break;case h.Int:tb=T.visitInt;break;case h.Int8:tb=T.visitInt8||T.visitInt;break;case h.Int16:tb=T.visitInt16||T.visitInt;break;case h.Int32:tb=T.visitInt32||T.visitInt;break;case h.Int64:tb=T.visitInt64||T.visitInt;break;case h.Uint8:tb=T.visitUint8||T.visitInt;break;case h.Uint16:tb=T.visitUint16||T.visitInt;break;case h.Uint32:tb=T.visitUint32||T.visitInt;break;case h.Uint64:tb=T.visitUint64||T.visitInt;break;case h.Float:tb=T.visitFloat;break;case h.Float16:tb=T.visitFloat16||T.visitFloat;break;case h.Float32:tb=T.visitFloat32||T.visitFloat;break;case h.Float64:tb=T.visitFloat64||T.visitFloat;break;case h.Utf8:tb=T.visitUtf8;break;case h.Binary:tb=T.visitBinary;break;case h.FixedSizeBinary:tb=T.visitFixedSizeBinary;break;case h.Date:tb=T.visitDate;break;case h.DateDay:tb=T.visitDateDay||T.visitDate;break;case h.DateMillisecond:tb=T.visitDateMillisecond||T.visitDate;break;case h.Timestamp:tb=T.visitTimestamp;break;case h.TimestampSecond:tb=T.visitTimestampSecond||T.visitTimestamp;break;case h.TimestampMillisecond:tb=T.visitTimestampMillisecond||T.visitTimestamp;break;case h.TimestampMicrosecond:tb=T.visitTimestampMicrosecond||T.visitTimestamp;break;case h.TimestampNanosecond:tb=T.visitTimestampNanosecond||T.visitTimestamp;break;case h.Time:tb=T.visitTime;break;case h.TimeSecond:tb=T.visitTimeSecond||T.visitTime;break;case h.TimeMillisecond:tb=T.visitTimeMillisecond||T.visitTime;break;case h.TimeMicrosecond:tb=T.visitTimeMicrosecond||T.visitTime;break;case h.TimeNanosecond:tb=T.visitTimeNanosecond||T.visitTime;break;case h.Decimal:tb=T.visitDecimal;break;case h.List:tb=T.visitList;break;case h.Struct:tb=T.visitStruct;break;case h.Union:tb=T.visitUnion;break;case h.DenseUnion:tb=T.visitDenseUnion||T.visitUnion;break;case h.SparseUnion:tb=T.visitSparseUnion||T.visitUnion;break;case h.Dictionary:tb=T.visitDictionary;break;case h.Interval:tb=T.visitInterval;break;case h.IntervalDayTime:tb=T.visitIntervalDayTime||T.visitInterval;break;case h.IntervalYearMonth:tb=T.visitIntervalYearMonth||T.visitInterval;break;case h.FixedSizeList:tb=T.visitFixedSizeList;break;case h.Map:tb=T.visitMap}if("function"==typeof tb)return tb;if(!tf)return()=>null;throw Error("Unrecognized type '".concat(h[td],"'"))}function al(T){switch(T.typeId){case h.Null:return h.Null;case h.Int:{let{bitWidth:td,isSigned:tf}=T;switch(td){case 8:return tf?h.Int8:h.Uint8;case 16:return tf?h.Int16:h.Uint16;case 32:return tf?h.Int32:h.Uint32;case 64:return tf?h.Int64:h.Uint64}return h.Int}case h.Float:switch(T.precision){case ht.HALF:return h.Float16;case ht.SINGLE:return h.Float32;case ht.DOUBLE:return h.Float64}return h.Float;case h.Binary:return h.Binary;case h.Utf8:return h.Utf8;case h.Bool:return h.Bool;case h.Decimal:return h.Decimal;case h.Time:switch(T.unit){case G.SECOND:return h.TimeSecond;case G.MILLISECOND:return h.TimeMillisecond;case G.MICROSECOND:return h.TimeMicrosecond;case G.NANOSECOND:return h.TimeNanosecond}return h.Time;case h.Timestamp:switch(T.unit){case G.SECOND:return h.TimestampSecond;case G.MILLISECOND:return h.TimestampMillisecond;case G.MICROSECOND:return h.TimestampMicrosecond;case G.NANOSECOND:return h.TimestampNanosecond}return h.Timestamp;case h.Date:switch(T.unit){case Nt.DAY:return h.DateDay;case Nt.MILLISECOND:return h.DateMillisecond}return h.Date;case h.Interval:switch(T.unit){case jt.DAY_TIME:return h.IntervalDayTime;case jt.YEAR_MONTH:return h.IntervalYearMonth}return h.Interval;case h.Map:return h.Map;case h.List:return h.List;case h.Struct:return h.Struct;case h.Union:switch(T.mode){case yt.Dense:return h.DenseUnion;case yt.Sparse:return h.SparseUnion}return h.Union;case h.FixedSizeBinary:return h.FixedSizeBinary;case h.FixedSizeList:return h.FixedSizeList;case h.Dictionary:return h.Dictionary}throw Error("Unrecognized type '".concat(h[T.typeId],"'"))}E.prototype.visitInt8=null,E.prototype.visitInt16=null,E.prototype.visitInt32=null,E.prototype.visitInt64=null,E.prototype.visitUint8=null,E.prototype.visitUint16=null,E.prototype.visitUint32=null,E.prototype.visitUint64=null,E.prototype.visitFloat16=null,E.prototype.visitFloat32=null,E.prototype.visitFloat64=null,E.prototype.visitDateDay=null,E.prototype.visitDateMillisecond=null,E.prototype.visitTimestampSecond=null,E.prototype.visitTimestampMillisecond=null,E.prototype.visitTimestampMicrosecond=null,E.prototype.visitTimestampNanosecond=null,E.prototype.visitTimeSecond=null,E.prototype.visitTimeMillisecond=null,E.prototype.visitTimeMicrosecond=null,E.prototype.visitTimeNanosecond=null,E.prototype.visitDenseUnion=null,E.prototype.visitSparseUnion=null,E.prototype.visitIntervalDayTime=null,E.prototype.visitIntervalYearMonth=null;var oa={};Xr(oa,{float64ToUint16:()=>ei,uint16ToFloat64:()=>vs});var cl=new Float64Array(1),Bn=new Uint32Array(cl.buffer);function vs(T){let td=(31744&T)>>10,tf=(1023&T)/1024,tb=Math.pow(-1,(32768&T)>>15);switch(td){case 31:return tb*(tf?Number.NaN:1/0);case 0:return tb*(tf?6103515625e-14*tf:0)}return tb*Math.pow(2,td-15)*(1+tf)}function ei(T){if(T!=T)return 32256;cl[0]=T;let td=(2147483648&Bn[1])>>16&65535,tf=2146435072&Bn[1],tb=0;return tf>=1089470464?Bn[0]>0?tf=31744:(tf=(2080374784&tf)>>16,tb=(1048575&Bn[1])>>10):tf<=1056964608?(tb=1048576+((tb=1048576+(1048575&Bn[1]))<<(tf>>20)-998)>>21,tf=0):(tf=tf-1056964608>>10,tb=(1048575&Bn[1])+512>>10),td|tf|65535&tb}var k=class extends E{};function j(T){return(td,tf,tb)=>{if(td.setValid(tf,null!=tb))return T(td,tf,tb)}}var rp=(T,td,tf)=>{T[td]=Math.trunc(tf/864e5)},aa=(T,td,tf)=>{T[td]=Math.trunc(tf%4294967296),T[td+1]=Math.trunc(tf/4294967296)},np=(T,td,tf)=>{T[td]=Math.trunc(1e3*tf%4294967296),T[td+1]=Math.trunc(1e3*tf/4294967296)},ip=(T,td,tf)=>{T[td]=Math.trunc(1e6*tf%4294967296),T[td+1]=Math.trunc(1e6*tf/4294967296)},ll=(T,td,tf,tb)=>{if(tf+1<td.length){let{[tf]:t_,[tf+1]:tg}=td;T.set(tb.subarray(0,tg-t_),t_)}},sp=({offset:T,values:td},tf,tb)=>{let t_=T+tf;tb?td[t_>>3]|=1<<t_%8:td[t_>>3]&=~(1<<t_%8)},dr=({values:T},td,tf)=>{T[td]=tf},ca=({values:T},td,tf)=>{T[td]=tf},ul=({values:T},td,tf)=>{T[td]=ei(tf)},op=(T,td,tf)=>{switch(T.type.precision){case ht.HALF:return ul(T,td,tf);case ht.SINGLE:case ht.DOUBLE:return ca(T,td,tf)}},Ss=({values:T},td,tf)=>{rp(T,td,tf.valueOf())},Is=({values:T},td,tf)=>{aa(T,2*td,tf.valueOf())},la=({stride:T,values:td},tf,tb)=>{td.set(tb.subarray(0,T),T*tf)},ap=({values:T,valueOffsets:td},tf,tb)=>ll(T,td,tf,tb),cp=({values:T,valueOffsets:td},tf,tb)=>{ll(T,td,tf,Br(tb))},ua=(T,td,tf)=>{T.type.unit===Nt.DAY?Ss(T,td,tf):Is(T,td,tf)},Fs=({values:T},td,tf)=>aa(T,2*td,tf/1e3),Bs=({values:T},td,tf)=>aa(T,2*td,tf),As=({values:T},td,tf)=>np(T,2*td,tf),Ts=({values:T},td,tf)=>ip(T,2*td,tf),da=(T,td,tf)=>{switch(T.type.unit){case G.SECOND:return Fs(T,td,tf);case G.MILLISECOND:return Bs(T,td,tf);case G.MICROSECOND:return As(T,td,tf);case G.NANOSECOND:return Ts(T,td,tf)}},xs=({values:T},td,tf)=>{T[td]=tf},Ds=({values:T},td,tf)=>{T[td]=tf},Es=({values:T},td,tf)=>{T[td]=tf},Os=({values:T},td,tf)=>{T[td]=tf},fa=(T,td,tf)=>{switch(T.type.unit){case G.SECOND:return xs(T,td,tf);case G.MILLISECOND:return Ds(T,td,tf);case G.MICROSECOND:return Es(T,td,tf);case G.NANOSECOND:return Os(T,td,tf)}},ha=({values:T,stride:td},tf,tb)=>{T.set(tb.subarray(0,td),td*tf)},lp=(T,td,tf)=>{let tb=T.children[0],t_=T.valueOffsets,tg=Lt.getVisitFn(tb);if(Array.isArray(tf))for(let T=-1,tv=t_[td],tw=t_[td+1];tv<tw;)tg(tb,tv++,tf[++T]);else for(let T=-1,tv=t_[td],tw=t_[td+1];tv<tw;)tg(tb,tv++,tf.get(++T))},up=(T,td,tf)=>{let tb=T.children[0],{valueOffsets:t_}=T,tg=Lt.getVisitFn(tb),{[td]:tv,[td+1]:tw}=t_;for(let T of tf instanceof Map?tf.entries():Object.entries(tf))if(tg(tb,tv,T),++tv>=tw)break},dp=(T,td)=>(tf,tb,t_,tg)=>tb&&tf(tb,T,td[tg]),fp=(T,td)=>(tf,tb,t_,tg)=>tb&&tf(tb,T,td.get(tg)),hp=(T,td)=>(tf,tb,t_,tg)=>tb&&tf(tb,T,td.get(t_.name)),pp=(T,td)=>(tf,tb,t_,tg)=>tb&&tf(tb,T,td[t_.name]),mp=(T,td,tf)=>{let tb=T.type.children.map(T=>Lt.getVisitFn(T.type)),t_=tf instanceof Map?hp(td,tf):tf instanceof J?fp(td,tf):Array.isArray(tf)?dp(td,tf):pp(td,tf);T.type.children.forEach((td,tf)=>t_(tb[tf],T.children[tf],td,tf))},yp=(T,td,tf)=>{T.type.mode===yt.Dense?dl(T,td,tf):fl(T,td,tf)},dl=(T,td,tf)=>{let tb=T.type.typeIdToChildIndex[T.typeIds[td]],t_=T.children[tb];Lt.visit(t_,T.valueOffsets[td],tf)},fl=(T,td,tf)=>{let tb=T.type.typeIdToChildIndex[T.typeIds[td]],t_=T.children[tb];Lt.visit(t_,td,tf)},_p=(T,td,tf)=>{var tb;null===(tb=T.dictionary)||void 0===tb||tb.set(T.values[td],tf)},pa=(T,td,tf)=>{T.type.unit===jt.DAY_TIME?Rs(T,td,tf):Ms(T,td,tf)},Rs=({values:T},td,tf)=>{T.set(tf.subarray(0,2),2*td)},Ms=({values:T},td,tf)=>{T[td]=12*tf[0]+tf[1]%12},bp=(T,td,tf)=>{let{stride:tb}=T,t_=T.children[0],tg=Lt.getVisitFn(t_);if(Array.isArray(tf))for(let T=-1,tv=td*tb;++T<tb;)tg(t_,tv+T,tf[T]);else for(let T=-1,tv=td*tb;++T<tb;)tg(t_,tv+T,tf.get(T))};k.prototype.visitBool=j(sp),k.prototype.visitInt=j(dr),k.prototype.visitInt8=j(dr),k.prototype.visitInt16=j(dr),k.prototype.visitInt32=j(dr),k.prototype.visitInt64=j(dr),k.prototype.visitUint8=j(dr),k.prototype.visitUint16=j(dr),k.prototype.visitUint32=j(dr),k.prototype.visitUint64=j(dr),k.prototype.visitFloat=j(op),k.prototype.visitFloat16=j(ul),k.prototype.visitFloat32=j(ca),k.prototype.visitFloat64=j(ca),k.prototype.visitUtf8=j(cp),k.prototype.visitBinary=j(ap),k.prototype.visitFixedSizeBinary=j(la),k.prototype.visitDate=j(ua),k.prototype.visitDateDay=j(Ss),k.prototype.visitDateMillisecond=j(Is),k.prototype.visitTimestamp=j(da),k.prototype.visitTimestampSecond=j(Fs),k.prototype.visitTimestampMillisecond=j(Bs),k.prototype.visitTimestampMicrosecond=j(As),k.prototype.visitTimestampNanosecond=j(Ts),k.prototype.visitTime=j(fa),k.prototype.visitTimeSecond=j(xs),k.prototype.visitTimeMillisecond=j(Ds),k.prototype.visitTimeMicrosecond=j(Es),k.prototype.visitTimeNanosecond=j(Os),k.prototype.visitDecimal=j(ha),k.prototype.visitList=j(lp),k.prototype.visitStruct=j(mp),k.prototype.visitUnion=j(yp),k.prototype.visitDenseUnion=j(dl),k.prototype.visitSparseUnion=j(fl),k.prototype.visitDictionary=j(_p),k.prototype.visitInterval=j(pa),k.prototype.visitIntervalDayTime=j(Rs),k.prototype.visitIntervalYearMonth=j(Ms),k.prototype.visitFixedSizeList=j(bp),k.prototype.visitMap=j(up);var Lt=new k,Oe=Symbol.for("parent"),An=Symbol.for("rowIndex"),Ar=class{constructor(T,td){return this[Oe]=T,this[An]=td,new Proxy(this,new ya)}toArray(){return Object.values(this.toJSON())}toJSON(){let T=this[An],td=this[Oe],tf=td.type.children,tb={};for(let t_=-1,tg=tf.length;++t_<tg;)tb[tf[t_].name]=Bt.visit(td.children[t_],T);return tb}toString(){return"{".concat([...this].map(([T,td])=>"".concat(He(T),": ").concat(He(td))).join(", "),"}")}[Symbol.for("nodejs.util.inspect.custom")](){return this.toString()}[Symbol.iterator](){return new ma(this[Oe],this[An])}},ma=class{constructor(T,td){this.childIndex=0,this.children=T.children,this.rowIndex=td,this.childFields=T.type.children,this.numChildren=this.childFields.length}[Symbol.iterator](){return this}next(){let T=this.childIndex;return T<this.numChildren?(this.childIndex=T+1,{done:!1,value:[this.childFields[T].name,Bt.visit(this.children[T],this.rowIndex)]}):{done:!0,value:null}}};Object.defineProperties(Ar.prototype,{[Symbol.toStringTag]:{enumerable:!1,configurable:!1,value:"Row"},[Oe]:{writable:!0,enumerable:!1,configurable:!1,value:null},[An]:{writable:!0,enumerable:!1,configurable:!1,value:-1}});var ya=class{isExtensible(){return!1}deleteProperty(){return!1}preventExtensions(){return!0}ownKeys(T){return T[Oe].type.children.map(T=>T.name)}has(T,td){return -1!==T[Oe].type.children.findIndex(T=>T.name===td)}getOwnPropertyDescriptor(T,td){if(-1!==T[Oe].type.children.findIndex(T=>T.name===td))return{writable:!0,enumerable:!0,configurable:!0}}get(T,td){if(Reflect.has(T,td))return T[td];let tf=T[Oe].type.children.findIndex(T=>T.name===td);if(-1!==tf){let tb=Bt.visit(T[Oe].children[tf],T[An]);return Reflect.set(T,td,tb),tb}}set(T,td,tf){let tb=T[Oe].type.children.findIndex(T=>T.name===td);return -1!==tb?(Lt.visit(T[Oe].children[tb],T[An],tf),Reflect.set(T,td,tf)):(!!Reflect.has(T,td)||"symbol"==typeof td)&&Reflect.set(T,td,tf)}},R=class extends E{};function V(T){return(td,tf)=>td.getValid(tf)?T(td,tf):null}var gp=(T,td)=>864e5*T[td],_a=(T,td)=>4294967296*T[td+1]+(T[td]>>>0),wp=(T,td)=>T[td+1]/1e3*4294967296+(T[td]>>>0)/1e3,vp=(T,td)=>T[td+1]/1e6*4294967296+(T[td]>>>0)/1e6,hl=T=>new Date(T),Sp=(T,td)=>hl(gp(T,td)),Ip=(T,td)=>hl(_a(T,td)),Fp=(T,td)=>null,pl=(T,td,tf)=>{if(tf+1>=td.length)return null;let tb=td[tf],t_=td[tf+1];return T.subarray(tb,t_)},Bp=({offset:T,values:td},tf)=>{let tb=T+tf;return(td[tb>>3]&1<<tb%8)!=0},ml=({values:T},td)=>Sp(T,td),yl=({values:T},td)=>Ip(T,2*td),Tr=({stride:T,values:td},tf)=>td[T*tf],Ap=({stride:T,values:td},tf)=>vs(td[T*tf]),_l=({values:T},td)=>T[td],Tp=({stride:T,values:td},tf)=>td.subarray(T*tf,T*(tf+1)),xp=({values:T,valueOffsets:td},tf)=>pl(T,td,tf),Dp=({values:T,valueOffsets:td},tf)=>{let tb=pl(T,td,tf);return null!==tb?Jn(tb):null},Ep=({values:T},td)=>T[td],Op=({type:T,values:td},tf)=>T.precision!==ht.HALF?td[tf]:vs(td[tf]),Rp=(T,td)=>T.type.unit===Nt.DAY?ml(T,td):yl(T,td),bl=({values:T},td)=>1e3*_a(T,2*td),gl=({values:T},td)=>_a(T,2*td),wl=({values:T},td)=>wp(T,2*td),vl=({values:T},td)=>vp(T,2*td),Mp=(T,td)=>{switch(T.type.unit){case G.SECOND:return bl(T,td);case G.MILLISECOND:return gl(T,td);case G.MICROSECOND:return wl(T,td);case G.NANOSECOND:return vl(T,td)}},Sl=({values:T},td)=>T[td],Il=({values:T},td)=>T[td],Fl=({values:T},td)=>T[td],Bl=({values:T},td)=>T[td],Up=(T,td)=>{switch(T.type.unit){case G.SECOND:return Sl(T,td);case G.MILLISECOND:return Il(T,td);case G.MICROSECOND:return Fl(T,td);case G.NANOSECOND:return Bl(T,td)}},Np=({values:T,stride:td},tf)=>ti.decimal(T.subarray(td*tf,td*(tf+1))),Lp=(T,td)=>{let{valueOffsets:tf,stride:tb,children:t_}=T,{[td*tb]:tg,[td*tb+1]:tv}=tf;return new J([t_[0].slice(tg,tv-tg)])},kp=(T,td)=>{let{valueOffsets:tf,children:tb}=T,{[td]:t_,[td+1]:tg}=tf;return new je(tb[0].slice(t_,tg-t_))},Cp=(T,td)=>new Ar(T,td),Pp=(T,td)=>T.type.mode===yt.Dense?Al(T,td):Tl(T,td),Al=(T,td)=>{let tf=T.type.typeIdToChildIndex[T.typeIds[td]],tb=T.children[tf];return Bt.visit(tb,T.valueOffsets[td])},Tl=(T,td)=>{let tf=T.type.typeIdToChildIndex[T.typeIds[td]],tb=T.children[tf];return Bt.visit(tb,td)},Vp=(T,td)=>{var tf;return null===(tf=T.dictionary)||void 0===tf?void 0:tf.get(T.values[td])},Hp=(T,td)=>T.type.unit===jt.DAY_TIME?xl(T,td):Dl(T,td),xl=({values:T},td)=>T.subarray(2*td,2*(td+1)),Dl=({values:T},td)=>{let tf=T[td],tb=new Int32Array(2);return tb[0]=Math.trunc(tf/12),tb[1]=Math.trunc(tf%12),tb},zp=(T,td)=>{let{stride:tf,children:tb}=T;return new J([tb[0].slice(td*tf,tf)])};R.prototype.visitNull=V(Fp),R.prototype.visitBool=V(Bp),R.prototype.visitInt=V(Ep),R.prototype.visitInt8=V(Tr),R.prototype.visitInt16=V(Tr),R.prototype.visitInt32=V(Tr),R.prototype.visitInt64=V(_l),R.prototype.visitUint8=V(Tr),R.prototype.visitUint16=V(Tr),R.prototype.visitUint32=V(Tr),R.prototype.visitUint64=V(_l),R.prototype.visitFloat=V(Op),R.prototype.visitFloat16=V(Ap),R.prototype.visitFloat32=V(Tr),R.prototype.visitFloat64=V(Tr),R.prototype.visitUtf8=V(Dp),R.prototype.visitBinary=V(xp),R.prototype.visitFixedSizeBinary=V(Tp),R.prototype.visitDate=V(Rp),R.prototype.visitDateDay=V(ml),R.prototype.visitDateMillisecond=V(yl),R.prototype.visitTimestamp=V(Mp),R.prototype.visitTimestampSecond=V(bl),R.prototype.visitTimestampMillisecond=V(gl),R.prototype.visitTimestampMicrosecond=V(wl),R.prototype.visitTimestampNanosecond=V(vl),R.prototype.visitTime=V(Up),R.prototype.visitTimeSecond=V(Sl),R.prototype.visitTimeMillisecond=V(Il),R.prototype.visitTimeMicrosecond=V(Fl),R.prototype.visitTimeNanosecond=V(Bl),R.prototype.visitDecimal=V(Np),R.prototype.visitList=V(Lp),R.prototype.visitStruct=V(Cp),R.prototype.visitUnion=V(Pp),R.prototype.visitDenseUnion=V(Al),R.prototype.visitSparseUnion=V(Tl),R.prototype.visitDictionary=V(Vp),R.prototype.visitInterval=V(Hp),R.prototype.visitIntervalDayTime=V(xl),R.prototype.visitIntervalYearMonth=V(Dl),R.prototype.visitFixedSizeList=V(zp),R.prototype.visitMap=V(kp);var Bt=new R,me=Symbol.for("keys"),Tn=Symbol.for("vals"),je=class{constructor(T){return this[me]=new J([T.children[0]]).memoize(),this[Tn]=T.children[1],new Proxy(this,new ga)}[Symbol.iterator](){return new ba(this[me],this[Tn])}get size(){return this[me].length}toArray(){return Object.values(this.toJSON())}toJSON(){let T=this[me],td=this[Tn],tf={};for(let tb=-1,t_=T.length;++tb<t_;)tf[T.get(tb)]=Bt.visit(td,tb);return tf}toString(){return"{".concat([...this].map(([T,td])=>"".concat(He(T),": ").concat(He(td))).join(", "),"}")}[Symbol.for("nodejs.util.inspect.custom")](){return this.toString()}},ba=class{constructor(T,td){this.keys=T,this.vals=td,this.keyIndex=0,this.numKeys=T.length}[Symbol.iterator](){return this}next(){let T=this.keyIndex;return T===this.numKeys?{done:!0,value:null}:(this.keyIndex++,{done:!1,value:[this.keys.get(T),Bt.visit(this.vals,T)]})}},ga=class{isExtensible(){return!1}deleteProperty(){return!1}preventExtensions(){return!0}ownKeys(T){return T[me].toArray().map(String)}has(T,td){return T[me].includes(td)}getOwnPropertyDescriptor(T,td){if(-1!==T[me].indexOf(td))return{writable:!0,enumerable:!0,configurable:!0}}get(T,td){if(Reflect.has(T,td))return T[td];let tf=T[me].indexOf(td);if(-1!==tf){let tb=Bt.visit(Reflect.get(T,Tn),tf);return Reflect.set(T,td,tb),tb}}set(T,td,tf){let tb=T[me].indexOf(td);return -1!==tb?(Lt.visit(Reflect.get(T,Tn),tb,tf),Reflect.set(T,td,tf)):!!Reflect.has(T,td)&&Reflect.set(T,td,tf)}};function jp(T,td,tf){let tb=T.length,t_=td>-1?td:tb+td%tb;return tf?tf(T,t_):t_}function ri(T,td,tf,tb){let{length:t_=0}=T,tg="number"!=typeof td?0:td,tv="number"!=typeof tf?t_:tf;return tg<0&&(tg=(tg%t_+t_)%t_),tv<0&&(tv=(tv%t_+t_)%t_),tv<tg&&(El=tg,tg=tv,tv=El),tv>t_&&(tv=t_),tb?tb(T,tg,tv):[tg,tv]}Object.defineProperties(je.prototype,{[Symbol.toStringTag]:{enumerable:!1,configurable:!1,value:"Row"},[me]:{writable:!0,enumerable:!1,configurable:!1,value:null},[Tn]:{writable:!0,enumerable:!1,configurable:!1,value:null}});var Ol=T=>T!=T;function xr(T){if("object"!=typeof T||null===T)return Ol(T)?Ol:td=>td===T;if(T instanceof Date){let td=T.valueOf();return T=>T instanceof Date&&T.valueOf()===td}return ArrayBuffer.isView(T)?td=>!!td&&ta(T,td):T instanceof Map?$p(T):Array.isArray(T)?Wp(T):T instanceof J?Yp(T):Xp(T,!0)}function Wp(T){let td=[];for(let tf=-1,tb=T.length;++tf<tb;)td[tf]=xr(T[tf]);return Us(td)}function $p(T){let td=-1,tf=[];for(let tb of T.values())tf[++td]=xr(tb);return Us(tf)}function Yp(T){let td=[];for(let tf=-1,tb=T.length;++tf<tb;)td[tf]=xr(T.get(tf));return Us(td)}function Xp(T,td=!1){let tf=Object.keys(T);if(!td&&0===tf.length)return()=>!1;let tb=[];for(let td=-1,t_=tf.length;++td<t_;)tb[td]=xr(T[tf[td]]);return Us(tb,tf)}function Us(T,td){return tf=>{if(!tf||"object"!=typeof tf)return!1;switch(tf.constructor){case Array:return Gp(T,tf);case Map:return Rl(T,tf,tf.keys());case je:case Ar:case Object:case void 0:return Rl(T,tf,td||Object.keys(tf))}return tf instanceof J&&Kp(T,tf)}}function Gp(T,td){let tf=T.length;if(td.length!==tf)return!1;for(let tb=-1;++tb<tf;)if(!T[tb](td[tb]))return!1;return!0}function Kp(T,td){let tf=T.length;if(td.length!==tf)return!1;for(let tb=-1;++tb<tf;)if(!T[tb](td.get(tb)))return!1;return!0}function Rl(T,td,tf){let tb=tf[Symbol.iterator](),t_=td instanceof Map?td.keys():Object.keys(td)[Symbol.iterator](),tg=td instanceof Map?td.values():Object.values(td)[Symbol.iterator](),tv=0,tw=T.length,tI=tg.next(),tS=tb.next(),tA=t_.next();for(;tv<tw&&!tS.done&&!tA.done&&!tI.done&&!(tS.value!==tA.value||!T[tv](tI.value));++tv,tS=tb.next(),tA=t_.next(),tI=tg.next());return tv===tw&&!!tS.done&&!!tA.done&&!!tI.done||(tb.return&&tb.return(),t_.return&&t_.return(),tg.return&&tg.return(),!1)}var va={};function Ls(T,td,tf,tb){return(tf&1<<tb)!=0}function Ml(T,td,tf,tb){return(tf&1<<tb)>>tb}function Jp(T,td,tf){return tf?!!(T[td>>3]|=1<<td%8)||!0:!(T[td>>3]&=~(1<<td%8))&&!1}function xn(T,td,tf){let tb=tf.byteLength+7&-8;if(T>0||tf.byteLength<tb){let t_=new Uint8Array(tb);return t_.set(T%8==0?tf.subarray(T>>3):qr(new Jr(tf,T,td,null,Ls)).subarray(0,tb)),t_}return tf}function qr(T){let td=[],tf=0,tb=0,t_=0;for(let tg of T)tg&&(t_|=1<<tb),8==++tb&&(td[tf++]=t_,t_=tb=0);(0===tf||tb>0)&&(td[tf++]=t_);let tg=new Uint8Array(td.length+7&-8);return tg.set(td),tg}Xr(va,{BitIterator:()=>Jr,getBit:()=>Ml,getBool:()=>Ls,packBools:()=>qr,popcnt_array:()=>Ul,popcnt_bit_range:()=>ni,popcnt_uint32:()=>Ns,setBool:()=>Jp,truncateBitmap:()=>xn});var Jr=class{constructor(T,td,tf,tb,t_){this.bytes=T,this.length=tf,this.context=tb,this.get=t_,this.bit=td%8,this.byteIndex=td>>3,this.byte=T[this.byteIndex++],this.index=0}next(){return this.index<this.length?(8===this.bit&&(this.bit=0,this.byte=this.bytes[this.byteIndex++]),{value:this.get(this.context,this.index++,this.byte,this.bit++)}):{done:!0,value:null}}[Symbol.iterator](){return this}};function ni(T,td,tf){if(tf-td<=0)return 0;if(tf-td<8){let tb=0;for(let t_ of new Jr(T,td,tf-td,T,Ml))tb+=t_;return tb}let tb=tf>>3<<3,t_=td+(td%8==0?0:8-td%8);return ni(T,td,t_)+ni(T,tb,tf)+Ul(T,t_>>3,tb-t_>>3)}function Ul(T,td,tf){let tb=0,t_=Math.trunc(td),tg=new DataView(T.buffer,T.byteOffset,T.byteLength),tv=void 0===tf?T.byteLength:t_+tf;for(;tv-t_>=4;)tb+=Ns(tg.getUint32(t_)),t_+=4;for(;tv-t_>=2;)tb+=Ns(tg.getUint16(t_)),t_+=2;for(;tv-t_>=1;)tb+=Ns(tg.getUint8(t_)),t_+=1;return tb}function Ns(T){let td=Math.trunc(T);return td-=td>>>1&1431655765,((td=(858993459&td)+(td>>>2&858993459))+(td>>>4)&252645135)*16843009>>>24}var qp=-1,at=class r{get typeId(){return this.type.typeId}get ArrayType(){return this.type.ArrayType}get buffers(){return[this.valueOffsets,this.values,this.nullBitmap,this.typeIds]}get byteLength(){let T=0,{valueOffsets:td,values:tf,nullBitmap:tb,typeIds:t_}=this;return td&&(T+=td.byteLength),tf&&(T+=tf.byteLength),tb&&(T+=tb.byteLength),t_&&(T+=t_.byteLength),this.children.reduce((T,td)=>T+td.byteLength,T)}get nullCount(){let T=this._nullCount,td;return T<=qp&&(td=this.nullBitmap)&&(this._nullCount=T=this.length-ni(td,this.offset,this.offset+this.length)),T}constructor(T,td,tf,tb,t_,tg=[],tv){let tw;this.type=T,this.children=tg,this.dictionary=tv,this.offset=Math.floor(Math.max(td||0,0)),this.length=Math.floor(Math.max(tf||0,0)),this._nullCount=Math.floor(Math.max(tb||0,-1)),t_ instanceof r?(this.stride=t_.stride,this.values=t_.values,this.typeIds=t_.typeIds,this.nullBitmap=t_.nullBitmap,this.valueOffsets=t_.valueOffsets):(this.stride=se(T),t_&&((tw=t_[0])&&(this.valueOffsets=tw),(tw=t_[1])&&(this.values=tw),(tw=t_[2])&&(this.nullBitmap=tw),(tw=t_[3])&&(this.typeIds=tw))),this.nullable=0!==this._nullCount&&this.nullBitmap&&this.nullBitmap.byteLength>0}getValid(T){if(this.nullable&&this.nullCount>0){let td=this.offset+T;return(this.nullBitmap[td>>3]&1<<td%8)!=0}return!0}setValid(T,td){if(!this.nullable)return td;if(!this.nullBitmap||this.nullBitmap.byteLength<=T>>3){let{nullBitmap:T}=this._changeLengthAndBackfillNullBitmap(this.length);Object.assign(this,{nullBitmap:T,_nullCount:0})}let{nullBitmap:tf,offset:tb}=this,t_=tb+T>>3,tg=(tb+T)%8,tv=tf[t_]>>tg&1;return td?0===tv&&(tf[t_]|=1<<tg,this._nullCount=this.nullCount+1):1===tv&&(tf[t_]&=~(1<<tg),this._nullCount=this.nullCount-1),td}clone(T=this.type,td=this.offset,tf=this.length,tb=this._nullCount,t_=this,tg=this.children){return new r(T,td,tf,tb,t_,tg,this.dictionary)}slice(T,td){let{stride:tf,typeId:tb,children:t_}=this,tg=+(0===this._nullCount)-1,tv=16===tb?tf:1,tw=this._sliceBuffers(T,td,tf,tb);return this.clone(this.type,this.offset+T,td,tg,tw,0===t_.length||this.valueOffsets?t_:this._sliceChildren(t_,tv*T,tv*td))}_changeLengthAndBackfillNullBitmap(T){if(this.typeId===h.Null)return this.clone(this.type,0,T,0);let{length:td,nullCount:tf}=this,tb=new Uint8Array((T+63&-64)>>3).fill(255,0,td>>3);tb[td>>3]=(1<<td-(-8&td))-1,tf>0&&tb.set(xn(this.offset,td,this.nullBitmap),0);let t_=this.buffers;return t_[pe.VALIDITY]=tb,this.clone(this.type,0,T,tf+(T-td),t_)}_sliceBuffers(T,td,tf,tb){let t_,{buffers:tg}=this;return(t_=tg[pe.TYPE])&&(tg[pe.TYPE]=t_.subarray(T,T+td)),(t_=tg[pe.OFFSET])&&(tg[pe.OFFSET]=t_.subarray(T,T+td+1))||(t_=tg[pe.DATA])&&(tg[pe.DATA]=6===tb?t_:t_.subarray(tf*T,tf*(T+td))),tg}_sliceChildren(T,td,tf){return T.map(T=>T.slice(td,tf))}};at.prototype.children=Object.freeze([]);var Sa=class r extends E{visit(T){return this.getVisitFn(T.type).call(this,T)}visitNull(T){let{type:td,offset:tf=0,length:tb=0}=T;return new at(td,tf,tb,0)}visitBool(T){let{type:td,offset:tf=0}=T,tb=L(T.nullBitmap),t_=W(td.ArrayType,T.data),{length:tg=t_.length>>3,nullCount:tv=T.nullBitmap?-1:0}=T;return new at(td,tf,tg,tv,[void 0,t_,tb])}visitInt(T){let{type:td,offset:tf=0}=T,tb=L(T.nullBitmap),t_=W(td.ArrayType,T.data),{length:tg=t_.length,nullCount:tv=T.nullBitmap?-1:0}=T;return new at(td,tf,tg,tv,[void 0,t_,tb])}visitFloat(T){let{type:td,offset:tf=0}=T,tb=L(T.nullBitmap),t_=W(td.ArrayType,T.data),{length:tg=t_.length,nullCount:tv=T.nullBitmap?-1:0}=T;return new at(td,tf,tg,tv,[void 0,t_,tb])}visitUtf8(T){let{type:td,offset:tf=0}=T,tb=L(T.data),t_=L(T.nullBitmap),tg=Kr(T.valueOffsets),{length:tv=tg.length-1,nullCount:tw=T.nullBitmap?-1:0}=T;return new at(td,tf,tv,tw,[tg,tb,t_])}visitBinary(T){let{type:td,offset:tf=0}=T,tb=L(T.data),t_=L(T.nullBitmap),tg=Kr(T.valueOffsets),{length:tv=tg.length-1,nullCount:tw=T.nullBitmap?-1:0}=T;return new at(td,tf,tv,tw,[tg,tb,t_])}visitFixedSizeBinary(T){let{type:td,offset:tf=0}=T,tb=L(T.nullBitmap),t_=W(td.ArrayType,T.data),{length:tg=t_.length/se(td),nullCount:tv=T.nullBitmap?-1:0}=T;return new at(td,tf,tg,tv,[void 0,t_,tb])}visitDate(T){let{type:td,offset:tf=0}=T,tb=L(T.nullBitmap),t_=W(td.ArrayType,T.data),{length:tg=t_.length/se(td),nullCount:tv=T.nullBitmap?-1:0}=T;return new at(td,tf,tg,tv,[void 0,t_,tb])}visitTimestamp(T){let{type:td,offset:tf=0}=T,tb=L(T.nullBitmap),t_=W(td.ArrayType,T.data),{length:tg=t_.length/se(td),nullCount:tv=T.nullBitmap?-1:0}=T;return new at(td,tf,tg,tv,[void 0,t_,tb])}visitTime(T){let{type:td,offset:tf=0}=T,tb=L(T.nullBitmap),t_=W(td.ArrayType,T.data),{length:tg=t_.length/se(td),nullCount:tv=T.nullBitmap?-1:0}=T;return new at(td,tf,tg,tv,[void 0,t_,tb])}visitDecimal(T){let{type:td,offset:tf=0}=T,tb=L(T.nullBitmap),t_=W(td.ArrayType,T.data),{length:tg=t_.length/se(td),nullCount:tv=T.nullBitmap?-1:0}=T;return new at(td,tf,tg,tv,[void 0,t_,tb])}visitList(T){let{type:td,offset:tf=0,child:tb}=T,t_=L(T.nullBitmap),tg=Kr(T.valueOffsets),{length:tv=tg.length-1,nullCount:tw=T.nullBitmap?-1:0}=T;return new at(td,tf,tv,tw,[tg,void 0,t_],[tb])}visitStruct(T){let{type:td,offset:tf=0,children:tb=[]}=T,t_=L(T.nullBitmap),{length:tg=tb.reduce((T,{length:td})=>Math.max(T,td),0),nullCount:tv=T.nullBitmap?-1:0}=T;return new at(td,tf,tg,tv,[void 0,void 0,t_],tb)}visitUnion(T){let{type:td,offset:tf=0,children:tb=[]}=T,t_=L(T.nullBitmap),tg=W(td.ArrayType,T.typeIds),{length:tv=tg.length,nullCount:tw=T.nullBitmap?-1:0}=T;return D.isSparseUnion(td)?new at(td,tf,tv,tw,[void 0,void 0,t_,tg],tb):new at(td,tf,tv,tw,[Kr(T.valueOffsets),void 0,t_,tg],tb)}visitDictionary(T){let{type:td,offset:tf=0}=T,tb=L(T.nullBitmap),t_=W(td.indices.ArrayType,T.data),{dictionary:tg=new J([new r().visit({type:td.dictionary})])}=T,{length:tv=t_.length,nullCount:tw=T.nullBitmap?-1:0}=T;return new at(td,tf,tv,tw,[void 0,t_,tb],[],tg)}visitInterval(T){let{type:td,offset:tf=0}=T,tb=L(T.nullBitmap),t_=W(td.ArrayType,T.data),{length:tg=t_.length/se(td),nullCount:tv=T.nullBitmap?-1:0}=T;return new at(td,tf,tg,tv,[void 0,t_,tb])}visitFixedSizeList(T){let{type:td,offset:tf=0,child:tb=new r().visit({type:td.valueType})}=T,t_=L(T.nullBitmap),{length:tg=tb.length/se(td),nullCount:tv=T.nullBitmap?-1:0}=T;return new at(td,tf,tg,tv,[void 0,void 0,t_],[tb])}visitMap(T){let{type:td,offset:tf=0,child:tb=new r().visit({type:td.childType})}=T,t_=L(T.nullBitmap),tg=Kr(T.valueOffsets),{length:tv=tg.length-1,nullCount:tw=T.nullBitmap?-1:0}=T;return new at(td,tf,tv,tw,[tg,void 0,t_],[tb])}};function P(T){return new Sa().visit(T)}var ii=class{constructor(T=0,td){this.numChunks=T,this.getChunkIterator=td,this.chunkIndex=0,this.chunkIterator=this.getChunkIterator(0)}next(){for(;this.chunkIndex<this.numChunks;){let T=this.chunkIterator.next();if(!T.done)return T;++this.chunkIndex<this.numChunks&&(this.chunkIterator=this.getChunkIterator(this.chunkIndex))}return{done:!0,value:null}}[Symbol.iterator](){return this}};function ks(T){return T.reduce((T,td)=>T+td.nullCount,0)}function Cs(T){return T.reduce((T,td,tf)=>(T[tf+1]=T[tf]+td.length,T),new Uint32Array(T.length+1))}function Ps(T,td,tf,tb){let t_=[];for(let tg=-1,tv=T.length;++tg<tv;){let tv=T[tg],tw=td[tg],{length:tI}=tv;if(tw>=tb)break;if(tf>=tw+tI)continue;if(tw>=tf&&tw+tI<=tb){t_.push(tv);continue}let tS=Math.max(0,tf-tw),tA=Math.min(tb-tw,tI);t_.push(tv.slice(tS,tA-tS))}return 0===t_.length&&t_.push(T[0].slice(0,0)),t_}function Ia(T,td,tf,tb){let t_=0,tg=0,tv=td.length-1;do{if(t_>=tv-1)return tf<td[tv]?tb(T,t_,tf-td[t_]):null;tf<td[tg=t_+Math.trunc((tv-t_)*.5)]?tv=tg:t_=tg}while(t_<tv)}function si(T,td){return T.getValid(td)}function Dr(T){function td(td,tf,tb){return T(td[tf],tb)}return function(T){return Ia(this.data,this._offsets,T,td)}}function Vs(T){let td;function tf(tf,tb,t_){return T(tf[tb],t_,td)}return function(T,tb){let t_=this.data;td=tb;let tg=Ia(t_,this._offsets,T,tf);return td=void 0,tg}}function Hs(T){let td;function tf(tf,tb,t_){let tg=t_,tv=0,tw=0;for(let t_=tb-1,tI=tf.length;++t_<tI;){let tb=tf[t_];if(~(tv=T(tb,td,tg)))return tw+tv;tg=0,tw+=tb.length}return -1}return function(T,tb){td=T;let t_=this.data,tg="number"!=typeof tb?tf(t_,0,0):Ia(t_,this._offsets,tb,tf);return td=void 0,tg}}var M=class extends E{};function Zp(T,td){return null===td&&T.length>0?0:-1}function Qp(T,td){let{nullBitmap:tf}=T;if(!tf||T.nullCount<=0)return -1;let tb=0;for(let t_ of new Jr(tf,T.offset+(td||0),T.length,tf,Ls)){if(!t_)return tb;++tb}return -1}function $(T,td,tf){if(void 0===td)return -1;if(null===td)return Qp(T,tf);let tb=Bt.getVisitFn(T),t_=xr(td);for(let td=(tf||0)-1,tg=T.length;++td<tg;)if(t_(tb(T,td)))return td;return -1}function Nl(T,td,tf){let tb=Bt.getVisitFn(T),t_=xr(td);for(let td=(tf||0)-1,tg=T.length;++td<tg;)if(t_(tb(T,td)))return td;return -1}M.prototype.visitNull=Zp,M.prototype.visitBool=$,M.prototype.visitInt=$,M.prototype.visitInt8=$,M.prototype.visitInt16=$,M.prototype.visitInt32=$,M.prototype.visitInt64=$,M.prototype.visitUint8=$,M.prototype.visitUint16=$,M.prototype.visitUint32=$,M.prototype.visitUint64=$,M.prototype.visitFloat=$,M.prototype.visitFloat16=$,M.prototype.visitFloat32=$,M.prototype.visitFloat64=$,M.prototype.visitUtf8=$,M.prototype.visitBinary=$,M.prototype.visitFixedSizeBinary=$,M.prototype.visitDate=$,M.prototype.visitDateDay=$,M.prototype.visitDateMillisecond=$,M.prototype.visitTimestamp=$,M.prototype.visitTimestampSecond=$,M.prototype.visitTimestampMillisecond=$,M.prototype.visitTimestampMicrosecond=$,M.prototype.visitTimestampNanosecond=$,M.prototype.visitTime=$,M.prototype.visitTimeSecond=$,M.prototype.visitTimeMillisecond=$,M.prototype.visitTimeMicrosecond=$,M.prototype.visitTimeNanosecond=$,M.prototype.visitDecimal=$,M.prototype.visitList=$,M.prototype.visitStruct=$,M.prototype.visitUnion=$,M.prototype.visitDenseUnion=Nl,M.prototype.visitSparseUnion=Nl,M.prototype.visitDictionary=$,M.prototype.visitInterval=$,M.prototype.visitIntervalDayTime=$,M.prototype.visitIntervalYearMonth=$,M.prototype.visitFixedSizeList=$,M.prototype.visitMap=$;var Zr=new M,U=class extends E{};function H(T){let{type:td}=T;if(0===T.nullCount&&1===T.stride&&(td.typeId===h.Timestamp||td instanceof St&&64!==td.bitWidth||td instanceof Ae&&64!==td.bitWidth||td instanceof Kt&&td.precision!==ht.HALF))return new ii(T.data.length,td=>{let tf=T.data[td];return tf.values.subarray(0,tf.length)[Symbol.iterator]()});let tf=0;return new ii(T.data.length,td=>{let tb=T.data[td].length,t_=T.slice(tf,tf+tb);return tf+=tb,new Fa(t_)})}var Fa=class{constructor(T){this.vector=T,this.index=0}next(){return this.index<this.vector.length?{value:this.vector.get(this.index++)}:{done:!0,value:null}}[Symbol.iterator](){return this}};U.prototype.visitNull=H,U.prototype.visitBool=H,U.prototype.visitInt=H,U.prototype.visitInt8=H,U.prototype.visitInt16=H,U.prototype.visitInt32=H,U.prototype.visitInt64=H,U.prototype.visitUint8=H,U.prototype.visitUint16=H,U.prototype.visitUint32=H,U.prototype.visitUint64=H,U.prototype.visitFloat=H,U.prototype.visitFloat16=H,U.prototype.visitFloat32=H,U.prototype.visitFloat64=H,U.prototype.visitUtf8=H,U.prototype.visitBinary=H,U.prototype.visitFixedSizeBinary=H,U.prototype.visitDate=H,U.prototype.visitDateDay=H,U.prototype.visitDateMillisecond=H,U.prototype.visitTimestamp=H,U.prototype.visitTimestampSecond=H,U.prototype.visitTimestampMillisecond=H,U.prototype.visitTimestampMicrosecond=H,U.prototype.visitTimestampNanosecond=H,U.prototype.visitTime=H,U.prototype.visitTimeSecond=H,U.prototype.visitTimeMillisecond=H,U.prototype.visitTimeMicrosecond=H,U.prototype.visitTimeNanosecond=H,U.prototype.visitDecimal=H,U.prototype.visitList=H,U.prototype.visitStruct=H,U.prototype.visitUnion=H,U.prototype.visitDenseUnion=H,U.prototype.visitSparseUnion=H,U.prototype.visitDictionary=H,U.prototype.visitInterval=H,U.prototype.visitIntervalDayTime=H,U.prototype.visitIntervalYearMonth=H,U.prototype.visitFixedSizeList=H,U.prototype.visitMap=H;var Dn=new U,tm=(T,td)=>T+td,We=class extends E{visitNull(T,td){return 0}visitInt(T,td){return T.type.bitWidth/8}visitFloat(T,td){return T.type.ArrayType.BYTES_PER_ELEMENT}visitBool(T,td){return 1/8}visitDecimal(T,td){return T.type.bitWidth/8}visitDate(T,td){return(T.type.unit+1)*4}visitTime(T,td){return T.type.bitWidth/8}visitTimestamp(T,td){return T.type.unit===G.SECOND?4:8}visitInterval(T,td){return(T.type.unit+1)*4}visitStruct(T,td){return T.children.reduce((T,tf)=>T+oe.visit(tf,td),0)}visitFixedSizeBinary(T,td){return T.type.byteWidth}visitMap(T,td){return 8+T.children.reduce((T,tf)=>T+oe.visit(tf,td),0)}visitDictionary(T,td){var tf;return T.type.indices.bitWidth/8+((null===(tf=T.dictionary)||void 0===tf?void 0:tf.getByteLength(T.values[td]))||0)}},em=({valueOffsets:T},td)=>8+(T[td+1]-T[td]),rm=({valueOffsets:T},td)=>8+(T[td+1]-T[td]),nm=({valueOffsets:T,stride:td,children:tf},tb)=>{let t_=tf[0],{[tb*td]:tg}=T,{[tb*td+1]:tv}=T,tw=oe.getVisitFn(t_.type),tI=t_.slice(tg,tv-tg),tS=8;for(let T=-1,td=tv-tg;++T<td;)tS+=tw(tI,T);return tS},im=({stride:T,children:td},tf)=>{let tb=td[0],t_=tb.slice(tf*T,T),tg=oe.getVisitFn(tb.type),tv=0;for(let T=-1,td=t_.length;++T<td;)tv+=tg(t_,T);return tv},sm=(T,td)=>T.type.mode===yt.Dense?Ll(T,td):kl(T,td),Ll=({type:T,children:td,typeIds:tf,valueOffsets:tb},t_)=>{let tg=T.typeIdToChildIndex[tf[t_]];return 8+oe.visit(td[tg],tb[t_])},kl=({children:T},td)=>4+oe.visitMany(T,T.map(()=>td)).reduce(tm,0);We.prototype.visitUtf8=em,We.prototype.visitBinary=rm,We.prototype.visitList=nm,We.prototype.visitFixedSizeList=im,We.prototype.visitUnion=sm,We.prototype.visitDenseUnion=Ll,We.prototype.visitSparseUnion=kl;var r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,El,Cl,oe=new We,Pl={},Vl={},J=class r{constructor(T){var td,tf,tb;let t_=T[0]instanceof r?T.flatMap(T=>T.data):T;if(0===t_.length||t_.some(T=>!(T instanceof at)))throw TypeError("Vector constructor expects an Array of Data instances.");let tg=null===(td=t_[0])||void 0===td?void 0:td.type;switch(t_.length){case 0:this._offsets=[0];break;case 1:{let{get:T,set:td,indexOf:tf,byteLength:tb}=Pl[tg.typeId],tv=t_[0];this.isValid=T=>si(tv,T),this.get=td=>T(tv,td),this.set=(T,tf)=>td(tv,T,tf),this.indexOf=T=>tf(tv,T),this.getByteLength=T=>tb(tv,T),this._offsets=[0,tv.length];break}default:Object.setPrototypeOf(this,Vl[tg.typeId]),this._offsets=Cs(t_)}this.data=t_,this.type=tg,this.stride=se(tg),this.numChildren=null!==(tb=null===(tf=tg.children)||void 0===tf?void 0:tf.length)&&void 0!==tb?tb:0,this.length=this._offsets.at(-1)}get byteLength(){return -1===this._byteLength&&(this._byteLength=this.data.reduce((T,td)=>T+td.byteLength,0)),this._byteLength}get nullCount(){return -1===this._nullCount&&(this._nullCount=ks(this.data)),this._nullCount}get ArrayType(){return this.type.ArrayType}get[Symbol.toStringTag](){return"".concat(this.VectorName,"<").concat(this.type[Symbol.toStringTag],">")}get VectorName(){return"".concat(h[this.type.typeId],"Vector")}isValid(T){return!1}get(T){return null}set(T,td){}indexOf(T,td){return -1}includes(T,td){return this.indexOf(T,td)>0}getByteLength(T){return 0}[Symbol.iterator](){return Dn.visit(this)}concat(...T){return new r(this.data.concat(T.flatMap(T=>T.data).flat(Number.POSITIVE_INFINITY)))}slice(T,td){return new r(ri(this,T,td,({data:T,_offsets:td},tf,tb)=>Ps(T,td,tf,tb)))}toJSON(){return[...this]}toArray(){let{type:T,data:td,length:tf,stride:tb,ArrayType:t_}=this;switch(T.typeId){case h.Int:case h.Float:case h.Decimal:case h.Time:case h.Timestamp:switch(td.length){case 0:return new t_;case 1:return td[0].values.subarray(0,tf*tb);default:return td.reduce((T,{values:td,length:tf})=>(T.array.set(td.subarray(0,tf*tb),T.offset),T.offset+=tf*tb,T),{array:new t_(tf*tb),offset:0}).array}}return[...this]}toString(){return"[".concat([...this].join(","),"]")}getChild(T){var td;return this.getChildAt(null===(td=this.type.children)||void 0===td?void 0:td.findIndex(td=>td.name===T))}getChildAt(T){return T>-1&&T<this.numChildren?new r(this.data.map(({children:td})=>td[T])):null}get isMemoized(){return!!D.isDictionary(this.type)&&this.data[0].dictionary.isMemoized}memoize(){if(D.isDictionary(this.type)){let T=new zs(this.data[0].dictionary);return new r(this.data.map(td=>{let tf=td.clone();return tf.dictionary=T,tf}))}return new zs(this)}unmemoize(){if(D.isDictionary(this.type)&&this.isMemoized){let T=this.data[0].dictionary.unmemoize();return new r(this.data.map(td=>{let tf=td.clone();return tf.dictionary=T,tf}))}return this}};Cl=Symbol.toStringTag,J[Cl]=(T=>{for(let td of(T.type=D.prototype,T.data=[],T.length=0,T.stride=1,T.numChildren=0,T._nullCount=-1,T._byteLength=-1,T._offsets=new Uint32Array([0]),T[Symbol.isConcatSpreadable]=!0,Object.keys(h).map(T=>h[T]).filter(T=>"number"==typeof T&&T!==h.NONE))){let tf=Bt.getVisitFnByTypeId(td),tb=Lt.getVisitFnByTypeId(td),t_=Zr.getVisitFnByTypeId(td),tg=oe.getVisitFnByTypeId(td);Pl[td]={get:tf,set:tb,indexOf:t_,byteLength:tg},Vl[td]=Object.create(T,{isValid:{value:Dr(si)},get:{value:Dr(Bt.getVisitFnByTypeId(td))},set:{value:Vs(Lt.getVisitFnByTypeId(td))},indexOf:{value:Hs(Zr.getVisitFnByTypeId(td))},getByteLength:{value:Dr(oe.getVisitFnByTypeId(td))}})}return"Vector"})(J.prototype);var zs=class r extends J{constructor(T){super(T.data);let td=this.get,tf=this.set,tb=this.slice,t_=Array(this.length);Object.defineProperty(this,"get",{value(T){let tf=t_[T];if(void 0!==tf)return tf;let tb=td.call(this,T);return t_[T]=tb,tb}}),Object.defineProperty(this,"set",{value(T,td){tf.call(this,T,td),t_[T]=td}}),Object.defineProperty(this,"slice",{value:(T,td)=>new r(tb.call(this,T,td))}),Object.defineProperty(this,"isMemoized",{value:!0}),Object.defineProperty(this,"unmemoize",{value:()=>new J(this.data)}),Object.defineProperty(this,"memoize",{value:()=>this})}};function Hl(T){if(!T||T.length<=0)return function(T){return!0};let td="",tf=T.filter(T=>T==T);return tf.length>0&&(td="\n    switch (x) {".concat(tf.map(T=>"\n        case ".concat(om(T),":")).join(""),"\n            return false;\n    }")),T.length!==tf.length&&(td="if (x !== x) return false;\n".concat(td)),Function("x","".concat(td,"\nreturn true;"))}function om(T){return"bigint"!=typeof T?He(T):"".concat(He(T),"n")}var Ba=(T,td)=>(Math.ceil(T)*td+63&-64||64)/td,am=(T,td=0)=>T.length>=td?T.subarray(0,td):wn(new T.constructor(td),T,0),Er=class{constructor(T,td=1){this.buffer=T,this.stride=td,this.BYTES_PER_ELEMENT=T.BYTES_PER_ELEMENT,this.ArrayType=T.constructor,this._resize(this.length=Math.ceil(T.length/td))}get byteLength(){return Math.ceil(this.length*this.stride)*this.BYTES_PER_ELEMENT}get reservedLength(){return this.buffer.length/this.stride}get reservedByteLength(){return this.buffer.byteLength}set(T,td){return this}append(T){return this.set(this.length,T)}reserve(T){if(T>0){this.length+=T;let td=this.stride,tf=this.length*td,tb=this.buffer.length;tf>=tb&&this._resize(0===tb?Ba(1*tf,this.BYTES_PER_ELEMENT):Ba(2*tf,this.BYTES_PER_ELEMENT))}return this}flush(T=this.length){T=Ba(T*this.stride,this.BYTES_PER_ELEMENT);let td=am(this.buffer,T);return this.clear(),td}clear(){return this.length=0,this._resize(0),this}_resize(T){return this.buffer=wn(new this.ArrayType(T),this.buffer)}};Er.prototype.offset=0;var fr=class extends Er{last(){return this.get(this.length-1)}get(T){return this.buffer[T]}set(T,td){return this.reserve(T-this.length+1),this.buffer[T*this.stride]=td,this}},En=class extends fr{constructor(T=new Uint8Array(0)){super(T,1/8),this.numValid=0}get numInvalid(){return this.length-this.numValid}get(T){return this.buffer[T>>3]>>T%8&1}set(T,td){let{buffer:tf}=this.reserve(T-this.length+1),tb=T>>3,t_=T%8,tg=tf[tb]>>t_&1;return td?0===tg&&(tf[tb]|=1<<t_,++this.numValid):1===tg&&(tf[tb]&=~(1<<t_),--this.numValid),this}clear(){return this.numValid=0,super.clear()}},On=class extends fr{constructor(T=new Int32Array(1)){super(T,1)}append(T){return this.set(this.length-1,T)}set(T,td){let tf=this.length-1,tb=this.reserve(T-tf+1).buffer;return tf<T++&&tb.fill(tb[tf],tf,T),tb[T]=tb[T-1]+td,this}flush(T=this.length-1){return T>this.length&&this.set(T-1,0),super.flush(T+1)}},pt=class{static throughNode(T){throw Error('"throughNode" not available in this environment')}static throughDOM(T){throw Error('"throughDOM" not available in this environment')}constructor({type:T,nullValues:td}){this.length=0,this.finished=!1,this.type=T,this.children=[],this.nullValues=td,this.stride=se(T),this._nulls=new En,td&&td.length>0&&(this._isValid=Hl(td))}toVector(){return new J([this.flush()])}get ArrayType(){return this.type.ArrayType}get nullCount(){return this._nulls.numInvalid}get numChildren(){return this.children.length}get byteLength(){let T=0,{_offsets:td,_values:tf,_nulls:tb,_typeIds:t_,children:tg}=this;return td&&(T+=td.byteLength),tf&&(T+=tf.byteLength),tb&&(T+=tb.byteLength),t_&&(T+=t_.byteLength),tg.reduce((T,td)=>T+td.byteLength,T)}get reservedLength(){return this._nulls.reservedLength}get reservedByteLength(){let T=0;return this._offsets&&(T+=this._offsets.reservedByteLength),this._values&&(T+=this._values.reservedByteLength),this._nulls&&(T+=this._nulls.reservedByteLength),this._typeIds&&(T+=this._typeIds.reservedByteLength),this.children.reduce((T,td)=>T+td.reservedByteLength,T)}get valueOffsets(){return this._offsets?this._offsets.buffer:null}get values(){return this._values?this._values.buffer:null}get nullBitmap(){return this._nulls?this._nulls.buffer:null}get typeIds(){return this._typeIds?this._typeIds.buffer:null}append(T){return this.set(this.length,T)}isValid(T){return this._isValid(T)}set(T,td){return this.setValid(T,this.isValid(td))&&this.setValue(T,td),this}setValue(T,td){this._setValue(this,T,td)}setValid(T,td){return this.length=this._nulls.set(T,+td).length,td}addChild(T,td="".concat(this.numChildren)){throw Error('Cannot append children to non-nested type "'.concat(this.type,'"'))}getChildAt(T){return this.children[T]||null}flush(){let T,td,tf,tb,{type:t_,length:tg,nullCount:tv,_typeIds:tw,_offsets:tI,_values:tS,_nulls:tA}=this;(td=null==tw?void 0:tw.flush(tg))?tb=null==tI?void 0:tI.flush(tg):T=(tb=null==tI?void 0:tI.flush(tg))?null==tS?void 0:tS.flush(tI.last()):null==tS?void 0:tS.flush(tg),tv>0&&(tf=null==tA?void 0:tA.flush(tg));let tT=this.children.map(T=>T.flush());return this.clear(),P({type:t_,length:tg,nullCount:tv,children:tT,child:tT[0],data:T,typeIds:td,nullBitmap:tf,valueOffsets:tb})}finish(){for(let T of(this.finished=!0,this.children))T.finish();return this}clear(){var T,td,tf,tb;for(let t_ of(this.length=0,null===(T=this._nulls)||void 0===T||T.clear(),null===(td=this._values)||void 0===td||td.clear(),null===(tf=this._offsets)||void 0===tf||tf.clear(),null===(tb=this._typeIds)||void 0===tb||tb.clear(),this.children))t_.clear();return this}};pt.prototype.length=1,pt.prototype.stride=1,pt.prototype.children=null,pt.prototype.finished=!1,pt.prototype.nullValues=null,pt.prototype._isValid=()=>!0;var Rt=class extends pt{constructor(T){super(T),this._values=new fr(new this.ArrayType(0),this.stride)}setValue(T,td){let tf=this._values;return tf.reserve(T-tf.length+1),super.setValue(T,td)}},$e=class extends pt{constructor(T){super(T),this._pendingLength=0,this._offsets=new On}setValue(T,td){let tf=this._pending||(this._pending=new Map),tb=tf.get(T);tb&&(this._pendingLength-=tb.length),this._pendingLength+=td instanceof je?td[me].length:td.length,tf.set(T,td)}setValid(T,td){return!!super.setValid(T,td)||((this._pending||(this._pending=new Map)).set(T,void 0),!1)}clear(){return this._pendingLength=0,this._pending=void 0,super.clear()}flush(){return this._flush(),super.flush()}finish(){return this._flush(),super.finish()}_flush(){let T=this._pending,td=this._pendingLength;return this._pendingLength=0,this._pending=void 0,T&&T.size>0&&this._flushPending(T,td),this}},Qr=class{constructor(){this.bb=null,this.bb_pos=0}__init(T,td){return this.bb_pos=T,this.bb=td,this}offset(){return this.bb.readInt64(this.bb_pos)}metaDataLength(){return this.bb.readInt32(this.bb_pos+8)}bodyLength(){return this.bb.readInt64(this.bb_pos+16)}static sizeOf(){return 24}static createBlock(T,td,tf,tb){return T.prep(8,24),T.writeInt64(BigInt(null!=tb?tb:0)),T.pad(4),T.writeInt32(tf),T.writeInt64(BigInt(null!=td?td:0)),T.offset()}},Ye=new Int32Array(2),js=new Float32Array(Ye.buffer),Ws=new Float64Array(Ye.buffer),Rn=1===new Uint16Array(new Uint8Array([1,0]).buffer)[0];!function(T){T[T.UTF8_BYTES=1]="UTF8_BYTES",T[T.UTF16_STRING=2]="UTF16_STRING"}(oi||(oi={}));var ae=class r{constructor(T){this.bytes_=T,this.position_=0,this.text_decoder_=new TextDecoder}static allocate(T){return new r(new Uint8Array(T))}clear(){this.position_=0}bytes(){return this.bytes_}position(){return this.position_}setPosition(T){this.position_=T}capacity(){return this.bytes_.length}readInt8(T){return this.readUint8(T)<<24>>24}readUint8(T){return this.bytes_[T]}readInt16(T){return this.readUint16(T)<<16>>16}readUint16(T){return this.bytes_[T]|this.bytes_[T+1]<<8}readInt32(T){return this.bytes_[T]|this.bytes_[T+1]<<8|this.bytes_[T+2]<<16|this.bytes_[T+3]<<24}readUint32(T){return this.readInt32(T)>>>0}readInt64(T){return BigInt.asIntN(64,BigInt(this.readUint32(T))+(BigInt(this.readUint32(T+4))<<BigInt(32)))}readUint64(T){return BigInt.asUintN(64,BigInt(this.readUint32(T))+(BigInt(this.readUint32(T+4))<<BigInt(32)))}readFloat32(T){return Ye[0]=this.readInt32(T),js[0]}readFloat64(T){return Ye[Rn?0:1]=this.readInt32(T),Ye[Rn?1:0]=this.readInt32(T+4),Ws[0]}writeInt8(T,td){this.bytes_[T]=td}writeUint8(T,td){this.bytes_[T]=td}writeInt16(T,td){this.bytes_[T]=td,this.bytes_[T+1]=td>>8}writeUint16(T,td){this.bytes_[T]=td,this.bytes_[T+1]=td>>8}writeInt32(T,td){this.bytes_[T]=td,this.bytes_[T+1]=td>>8,this.bytes_[T+2]=td>>16,this.bytes_[T+3]=td>>24}writeUint32(T,td){this.bytes_[T]=td,this.bytes_[T+1]=td>>8,this.bytes_[T+2]=td>>16,this.bytes_[T+3]=td>>24}writeInt64(T,td){this.writeInt32(T,Number(BigInt.asIntN(32,td))),this.writeInt32(T+4,Number(BigInt.asIntN(32,td>>BigInt(32))))}writeUint64(T,td){this.writeUint32(T,Number(BigInt.asUintN(32,td))),this.writeUint32(T+4,Number(BigInt.asUintN(32,td>>BigInt(32))))}writeFloat32(T,td){js[0]=td,this.writeInt32(T,Ye[0])}writeFloat64(T,td){Ws[0]=td,this.writeInt32(T,Ye[Rn?0:1]),this.writeInt32(T+4,Ye[Rn?1:0])}getBufferIdentifier(){if(this.bytes_.length<this.position_+4+4)throw Error("FlatBuffers: ByteBuffer is too short to contain an identifier.");let T="";for(let td=0;td<4;td++)T+=String.fromCharCode(this.readInt8(this.position_+4+td));return T}__offset(T,td){let tf=T-this.readInt32(T);return td<this.readInt16(tf)?this.readInt16(tf+td):0}__union(T,td){return T.bb_pos=td+this.readInt32(td),T.bb=this,T}__string(T,td){T+=this.readInt32(T);let tf=this.readInt32(T);T+=4;let tb=this.bytes_.subarray(T,T+tf);return td===oi.UTF8_BYTES?tb:this.text_decoder_.decode(tb)}__union_with_string(T,td){return"string"==typeof T?this.__string(td):this.__union(T,td)}__indirect(T){return T+this.readInt32(T)}__vector(T){return T+this.readInt32(T)+4}__vector_len(T){return this.readInt32(T+this.readInt32(T))}__has_identifier(T){if(4!=T.length)throw Error("FlatBuffers: file identifier must be length 4");for(let td=0;td<4;td++)if(T.charCodeAt(td)!=this.readInt8(this.position()+4+td))return!1;return!0}createScalarList(T,td){let tf=[];for(let tb=0;tb<td;++tb){let td=T(tb);null!==td&&tf.push(td)}return tf}createObjList(T,td){let tf=[];for(let tb=0;tb<td;++tb){let td=T(tb);null!==td&&tf.push(td.unpack())}return tf}},tn=class r{constructor(T){let td;this.minalign=1,this.vtable=null,this.vtable_in_use=0,this.isNested=!1,this.object_start=0,this.vtables=[],this.vector_num_elems=0,this.force_defaults=!1,this.string_maps=null,this.text_encoder=new TextEncoder,td=T||1024,this.bb=ae.allocate(td),this.space=td}clear(){this.bb.clear(),this.space=this.bb.capacity(),this.minalign=1,this.vtable=null,this.vtable_in_use=0,this.isNested=!1,this.object_start=0,this.vtables=[],this.vector_num_elems=0,this.force_defaults=!1,this.string_maps=null}forceDefaults(T){this.force_defaults=T}dataBuffer(){return this.bb}asUint8Array(){return this.bb.bytes().subarray(this.bb.position(),this.bb.position()+this.offset())}prep(T,td){T>this.minalign&&(this.minalign=T);let tf=~(this.bb.capacity()-this.space+td)+1&T-1;for(;this.space<tf+T+td;){let T=this.bb.capacity();this.bb=r.growByteBuffer(this.bb),this.space+=this.bb.capacity()-T}this.pad(tf)}pad(T){for(let td=0;td<T;td++)this.bb.writeInt8(--this.space,0)}writeInt8(T){this.bb.writeInt8(this.space-=1,T)}writeInt16(T){this.bb.writeInt16(this.space-=2,T)}writeInt32(T){this.bb.writeInt32(this.space-=4,T)}writeInt64(T){this.bb.writeInt64(this.space-=8,T)}writeFloat32(T){this.bb.writeFloat32(this.space-=4,T)}writeFloat64(T){this.bb.writeFloat64(this.space-=8,T)}addInt8(T){this.prep(1,0),this.writeInt8(T)}addInt16(T){this.prep(2,0),this.writeInt16(T)}addInt32(T){this.prep(4,0),this.writeInt32(T)}addInt64(T){this.prep(8,0),this.writeInt64(T)}addFloat32(T){this.prep(4,0),this.writeFloat32(T)}addFloat64(T){this.prep(8,0),this.writeFloat64(T)}addFieldInt8(T,td,tf){(this.force_defaults||td!=tf)&&(this.addInt8(td),this.slot(T))}addFieldInt16(T,td,tf){(this.force_defaults||td!=tf)&&(this.addInt16(td),this.slot(T))}addFieldInt32(T,td,tf){(this.force_defaults||td!=tf)&&(this.addInt32(td),this.slot(T))}addFieldInt64(T,td,tf){(this.force_defaults||td!==tf)&&(this.addInt64(td),this.slot(T))}addFieldFloat32(T,td,tf){(this.force_defaults||td!=tf)&&(this.addFloat32(td),this.slot(T))}addFieldFloat64(T,td,tf){(this.force_defaults||td!=tf)&&(this.addFloat64(td),this.slot(T))}addFieldOffset(T,td,tf){(this.force_defaults||td!=tf)&&(this.addOffset(td),this.slot(T))}addFieldStruct(T,td,tf){td!=tf&&(this.nested(td),this.slot(T))}nested(T){if(T!=this.offset())throw TypeError("FlatBuffers: struct must be serialized inline.")}notNested(){if(this.isNested)throw TypeError("FlatBuffers: object serialization must not be nested.")}slot(T){null!==this.vtable&&(this.vtable[T]=this.offset())}offset(){return this.bb.capacity()-this.space}static growByteBuffer(T){let td=T.capacity();if(3221225472&td)throw Error("FlatBuffers: cannot grow buffer beyond 2 gigabytes.");let tf=td<<1,tb=ae.allocate(tf);return tb.setPosition(tf-td),tb.bytes().set(T.bytes(),tf-td),tb}addOffset(T){this.prep(4,0),this.writeInt32(this.offset()-T+4)}startObject(T){this.notNested(),null==this.vtable&&(this.vtable=[]),this.vtable_in_use=T;for(let td=0;td<T;td++)this.vtable[td]=0;this.isNested=!0,this.object_start=this.offset()}endObject(){if(null==this.vtable||!this.isNested)throw Error("FlatBuffers: endObject called without startObject");this.addInt32(0);let T=this.offset(),td=this.vtable_in_use-1;for(;td>=0&&0==this.vtable[td];td--);let tf=td+1;for(;td>=0;td--)this.addInt16(0!=this.vtable[td]?T-this.vtable[td]:0);let tb=2;this.addInt16(T-this.object_start);let t_=(tf+tb)*2;this.addInt16(t_);let tg=0,tv=this.space;t:for(td=0;td<this.vtables.length;td++){let T=this.bb.capacity()-this.vtables[td];if(t_==this.bb.readInt16(T)){for(let td=2;td<t_;td+=2)if(this.bb.readInt16(tv+td)!=this.bb.readInt16(T+td))continue t;tg=this.vtables[td];break}}return tg?(this.space=this.bb.capacity()-T,this.bb.writeInt32(this.space,tg-T)):(this.vtables.push(this.offset()),this.bb.writeInt32(this.bb.capacity()-T,this.offset()-T)),this.isNested=!1,T}finish(T,td,tf){let tb=tf?4:0;if(td){let T=td;if(this.prep(this.minalign,8+tb),4!=T.length)throw TypeError("FlatBuffers: file identifier must be length 4");for(let td=3;td>=0;td--)this.writeInt8(T.charCodeAt(td))}this.prep(this.minalign,4+tb),this.addOffset(T),tb&&this.addInt32(this.bb.capacity()-this.space),this.bb.setPosition(this.space)}finishSizePrefixed(T,td){this.finish(T,td,!0)}requiredField(T,td){let tf=this.bb.capacity()-T,tb=tf-this.bb.readInt32(tf);if(!(td<this.bb.readInt16(tb)&&0!=this.bb.readInt16(tb+td)))throw TypeError("FlatBuffers: field "+td+" must be set")}startVector(T,td,tf){this.notNested(),this.vector_num_elems=td,this.prep(4,T*td),this.prep(tf,T*td)}endVector(){return this.writeInt32(this.vector_num_elems),this.offset()}createSharedString(T){if(!T)return 0;if(this.string_maps||(this.string_maps=new Map),this.string_maps.has(T))return this.string_maps.get(T);let td=this.createString(T);return this.string_maps.set(T,td),td}createString(T){let td;if(null==T)return 0;td=T instanceof Uint8Array?T:this.text_encoder.encode(T),this.addInt8(0),this.startVector(1,td.length,1),this.bb.setPosition(this.space-=td.length);for(let T=0,tf=this.space,tb=this.bb.bytes();T<td.length;T++)tb[tf++]=td[T];return this.endVector()}createObjectOffset(T){return null===T?0:"string"==typeof T?this.createString(T):T.pack(this)}createObjectOffsetList(T){let td=[];for(let tf=0;tf<T.length;++tf){let tb=T[tf];if(null!==tb)td.push(this.createObjectOffset(tb));else throw TypeError("FlatBuffers: Argument for createObjectOffsetList cannot contain null.")}return td}createStructOffsetList(T,td){return td(this,T.length),this.createObjectOffsetList(T.slice().reverse()),this.endVector()}},Et=class r{constructor(){this.bb=null,this.bb_pos=0}__init(T,td){return this.bb_pos=T,this.bb=td,this}static getRootAsKeyValue(T,td){return(td||new r).__init(T.readInt32(T.position())+T.position(),T)}static getSizePrefixedRootAsKeyValue(T,td){return T.setPosition(T.position()+4),(td||new r).__init(T.readInt32(T.position())+T.position(),T)}key(T){let td=this.bb.__offset(this.bb_pos,4);return td?this.bb.__string(this.bb_pos+td,T):null}value(T){let td=this.bb.__offset(this.bb_pos,6);return td?this.bb.__string(this.bb_pos+td,T):null}static startKeyValue(T){T.startObject(2)}static addKey(T,td){T.addFieldOffset(0,td,0)}static addValue(T,td){T.addFieldOffset(1,td,0)}static endKeyValue(T){return T.endObject()}static createKeyValue(T,td,tf){return r.startKeyValue(T),r.addKey(T,td),r.addValue(T,tf),r.endKeyValue(T)}};!function(T){T[T.V1=0]="V1",T[T.V2=1]="V2",T[T.V3=2]="V3",T[T.V4=3]="V4",T[T.V5=4]="V5"}(Or||(Or={})),function(T){T[T.Little=0]="Little",T[T.Big=1]="Big"}(Rr||(Rr={})),function(T){T[T.DenseArray=0]="DenseArray"}(ai||(ai={}));var Me=class r{constructor(){this.bb=null,this.bb_pos=0}__init(T,td){return this.bb_pos=T,this.bb=td,this}static getRootAsInt(T,td){return(td||new r).__init(T.readInt32(T.position())+T.position(),T)}static getSizePrefixedRootAsInt(T,td){return T.setPosition(T.position()+4),(td||new r).__init(T.readInt32(T.position())+T.position(),T)}bitWidth(){let T=this.bb.__offset(this.bb_pos,4);return T?this.bb.readInt32(this.bb_pos+T):0}isSigned(){let T=this.bb.__offset(this.bb_pos,6);return!!T&&!!this.bb.readInt8(this.bb_pos+T)}static startInt(T){T.startObject(2)}static addBitWidth(T,td){T.addFieldInt32(0,td,0)}static addIsSigned(T,td){T.addFieldInt8(1,+td,0)}static endInt(T){return T.endObject()}static createInt(T,td,tf){return r.startInt(T),r.addBitWidth(T,td),r.addIsSigned(T,tf),r.endInt(T)}},Xe=class r{constructor(){this.bb=null,this.bb_pos=0}__init(T,td){return this.bb_pos=T,this.bb=td,this}static getRootAsDictionaryEncoding(T,td){return(td||new r).__init(T.readInt32(T.position())+T.position(),T)}static getSizePrefixedRootAsDictionaryEncoding(T,td){return T.setPosition(T.position()+4),(td||new r).__init(T.readInt32(T.position())+T.position(),T)}id(){let T=this.bb.__offset(this.bb_pos,4);return T?this.bb.readInt64(this.bb_pos+T):BigInt("0")}indexType(T){let td=this.bb.__offset(this.bb_pos,6);return td?(T||new Me).__init(this.bb.__indirect(this.bb_pos+td),this.bb):null}isOrdered(){let T=this.bb.__offset(this.bb_pos,8);return!!T&&!!this.bb.readInt8(this.bb_pos+T)}dictionaryKind(){let T=this.bb.__offset(this.bb_pos,10);return T?this.bb.readInt16(this.bb_pos+T):ai.DenseArray}static startDictionaryEncoding(T){T.startObject(4)}static addId(T,td){T.addFieldInt64(0,td,BigInt("0"))}static addIndexType(T,td){T.addFieldOffset(1,td,0)}static addIsOrdered(T,td){T.addFieldInt8(2,+td,0)}static addDictionaryKind(T,td){T.addFieldInt16(3,td,ai.DenseArray)}static endDictionaryEncoding(T){return T.endObject()}},ci=class r{constructor(){this.bb=null,this.bb_pos=0}__init(T,td){return this.bb_pos=T,this.bb=td,this}static getRootAsBinary(T,td){return(td||new r).__init(T.readInt32(T.position())+T.position(),T)}static getSizePrefixedRootAsBinary(T,td){return T.setPosition(T.position()+4),(td||new r).__init(T.readInt32(T.position())+T.position(),T)}static startBinary(T){T.startObject(0)}static endBinary(T){return T.endObject()}static createBinary(T){return r.startBinary(T),r.endBinary(T)}},li=class r{constructor(){this.bb=null,this.bb_pos=0}__init(T,td){return this.bb_pos=T,this.bb=td,this}static getRootAsBool(T,td){return(td||new r).__init(T.readInt32(T.position())+T.position(),T)}static getSizePrefixedRootAsBool(T,td){return T.setPosition(T.position()+4),(td||new r).__init(T.readInt32(T.position())+T.position(),T)}static startBool(T){T.startObject(0)}static endBool(T){return T.endObject()}static createBool(T){return r.startBool(T),r.endBool(T)}};!function(T){T[T.DAY=0]="DAY",T[T.MILLISECOND=1]="MILLISECOND"}(ui||(ui={}));var Mr=class r{constructor(){this.bb=null,this.bb_pos=0}__init(T,td){return this.bb_pos=T,this.bb=td,this}static getRootAsDate(T,td){return(td||new r).__init(T.readInt32(T.position())+T.position(),T)}static getSizePrefixedRootAsDate(T,td){return T.setPosition(T.position()+4),(td||new r).__init(T.readInt32(T.position())+T.position(),T)}unit(){let T=this.bb.__offset(this.bb_pos,4);return T?this.bb.readInt16(this.bb_pos+T):ui.MILLISECOND}static startDate(T){T.startObject(1)}static addUnit(T,td){T.addFieldInt16(0,td,ui.MILLISECOND)}static endDate(T){return T.endObject()}static createDate(T,td){return r.startDate(T),r.addUnit(T,td),r.endDate(T)}},Ge=class r{constructor(){this.bb=null,this.bb_pos=0}__init(T,td){return this.bb_pos=T,this.bb=td,this}static getRootAsDecimal(T,td){return(td||new r).__init(T.readInt32(T.position())+T.position(),T)}static getSizePrefixedRootAsDecimal(T,td){return T.setPosition(T.position()+4),(td||new r).__init(T.readInt32(T.position())+T.position(),T)}precision(){let T=this.bb.__offset(this.bb_pos,4);return T?this.bb.readInt32(this.bb_pos+T):0}scale(){let T=this.bb.__offset(this.bb_pos,6);return T?this.bb.readInt32(this.bb_pos+T):0}bitWidth(){let T=this.bb.__offset(this.bb_pos,8);return T?this.bb.readInt32(this.bb_pos+T):128}static startDecimal(T){T.startObject(3)}static addPrecision(T,td){T.addFieldInt32(0,td,0)}static addScale(T,td){T.addFieldInt32(1,td,0)}static addBitWidth(T,td){T.addFieldInt32(2,td,128)}static endDecimal(T){return T.endObject()}static createDecimal(T,td,tf,tb){return r.startDecimal(T),r.addPrecision(T,td),r.addScale(T,tf),r.addBitWidth(T,tb),r.endDecimal(T)}};!function(T){T[T.SECOND=0]="SECOND",T[T.MILLISECOND=1]="MILLISECOND",T[T.MICROSECOND=2]="MICROSECOND",T[T.NANOSECOND=3]="NANOSECOND"}(Ur||(Ur={}));var Nr=class r{constructor(){this.bb=null,this.bb_pos=0}__init(T,td){return this.bb_pos=T,this.bb=td,this}static getRootAsFixedSizeBinary(T,td){return(td||new r).__init(T.readInt32(T.position())+T.position(),T)}static getSizePrefixedRootAsFixedSizeBinary(T,td){return T.setPosition(T.position()+4),(td||new r).__init(T.readInt32(T.position())+T.position(),T)}byteWidth(){let T=this.bb.__offset(this.bb_pos,4);return T?this.bb.readInt32(this.bb_pos+T):0}static startFixedSizeBinary(T){T.startObject(1)}static addByteWidth(T,td){T.addFieldInt32(0,td,0)}static endFixedSizeBinary(T){return T.endObject()}static createFixedSizeBinary(T,td){return r.startFixedSizeBinary(T),r.addByteWidth(T,td),r.endFixedSizeBinary(T)}},Lr=class r{constructor(){this.bb=null,this.bb_pos=0}__init(T,td){return this.bb_pos=T,this.bb=td,this}static getRootAsFixedSizeList(T,td){return(td||new r).__init(T.readInt32(T.position())+T.position(),T)}static getSizePrefixedRootAsFixedSizeList(T,td){return T.setPosition(T.position()+4),(td||new r).__init(T.readInt32(T.position())+T.position(),T)}listSize(){let T=this.bb.__offset(this.bb_pos,4);return T?this.bb.readInt32(this.bb_pos+T):0}static startFixedSizeList(T){T.startObject(1)}static addListSize(T,td){T.addFieldInt32(0,td,0)}static endFixedSizeList(T){return T.endObject()}static createFixedSizeList(T,td){return r.startFixedSizeList(T),r.addListSize(T,td),r.endFixedSizeList(T)}};!function(T){T[T.HALF=0]="HALF",T[T.SINGLE=1]="SINGLE",T[T.DOUBLE=2]="DOUBLE"}(di||(di={}));var kr=class r{constructor(){this.bb=null,this.bb_pos=0}__init(T,td){return this.bb_pos=T,this.bb=td,this}static getRootAsFloatingPoint(T,td){return(td||new r).__init(T.readInt32(T.position())+T.position(),T)}static getSizePrefixedRootAsFloatingPoint(T,td){return T.setPosition(T.position()+4),(td||new r).__init(T.readInt32(T.position())+T.position(),T)}precision(){let T=this.bb.__offset(this.bb_pos,4);return T?this.bb.readInt16(this.bb_pos+T):di.HALF}static startFloatingPoint(T){T.startObject(1)}static addPrecision(T,td){T.addFieldInt16(0,td,di.HALF)}static endFloatingPoint(T){return T.endObject()}static createFloatingPoint(T,td){return r.startFloatingPoint(T),r.addPrecision(T,td),r.endFloatingPoint(T)}};!function(T){T[T.YEAR_MONTH=0]="YEAR_MONTH",T[T.DAY_TIME=1]="DAY_TIME",T[T.MONTH_DAY_NANO=2]="MONTH_DAY_NANO"}(fi||(fi={}));var Cr=class r{constructor(){this.bb=null,this.bb_pos=0}__init(T,td){return this.bb_pos=T,this.bb=td,this}static getRootAsInterval(T,td){return(td||new r).__init(T.readInt32(T.position())+T.position(),T)}static getSizePrefixedRootAsInterval(T,td){return T.setPosition(T.position()+4),(td||new r).__init(T.readInt32(T.position())+T.position(),T)}unit(){let T=this.bb.__offset(this.bb_pos,4);return T?this.bb.readInt16(this.bb_pos+T):fi.YEAR_MONTH}static startInterval(T){T.startObject(1)}static addUnit(T,td){T.addFieldInt16(0,td,fi.YEAR_MONTH)}static endInterval(T){return T.endObject()}static createInterval(T,td){return r.startInterval(T),r.addUnit(T,td),r.endInterval(T)}},hi=class r{constructor(){this.bb=null,this.bb_pos=0}__init(T,td){return this.bb_pos=T,this.bb=td,this}static getRootAsList(T,td){return(td||new r).__init(T.readInt32(T.position())+T.position(),T)}static getSizePrefixedRootAsList(T,td){return T.setPosition(T.position()+4),(td||new r).__init(T.readInt32(T.position())+T.position(),T)}static startList(T){T.startObject(0)}static endList(T){return T.endObject()}static createList(T){return r.startList(T),r.endList(T)}},Pr=class r{constructor(){this.bb=null,this.bb_pos=0}__init(T,td){return this.bb_pos=T,this.bb=td,this}static getRootAsMap(T,td){return(td||new r).__init(T.readInt32(T.position())+T.position(),T)}static getSizePrefixedRootAsMap(T,td){return T.setPosition(T.position()+4),(td||new r).__init(T.readInt32(T.position())+T.position(),T)}keysSorted(){let T=this.bb.__offset(this.bb_pos,4);return!!T&&!!this.bb.readInt8(this.bb_pos+T)}static startMap(T){T.startObject(1)}static addKeysSorted(T,td){T.addFieldInt8(0,+td,0)}static endMap(T){return T.endObject()}static createMap(T,td){return r.startMap(T),r.addKeysSorted(T,td),r.endMap(T)}},pi=class r{constructor(){this.bb=null,this.bb_pos=0}__init(T,td){return this.bb_pos=T,this.bb=td,this}static getRootAsNull(T,td){return(td||new r).__init(T.readInt32(T.position())+T.position(),T)}static getSizePrefixedRootAsNull(T,td){return T.setPosition(T.position()+4),(td||new r).__init(T.readInt32(T.position())+T.position(),T)}static startNull(T){T.startObject(0)}static endNull(T){return T.endObject()}static createNull(T){return r.startNull(T),r.endNull(T)}},mi=class r{constructor(){this.bb=null,this.bb_pos=0}__init(T,td){return this.bb_pos=T,this.bb=td,this}static getRootAsStruct_(T,td){return(td||new r).__init(T.readInt32(T.position())+T.position(),T)}static getSizePrefixedRootAsStruct_(T,td){return T.setPosition(T.position()+4),(td||new r).__init(T.readInt32(T.position())+T.position(),T)}static startStruct_(T){T.startObject(0)}static endStruct_(T){return T.endObject()}static createStruct_(T){return r.startStruct_(T),r.endStruct_(T)}},hr=class r{constructor(){this.bb=null,this.bb_pos=0}__init(T,td){return this.bb_pos=T,this.bb=td,this}static getRootAsTime(T,td){return(td||new r).__init(T.readInt32(T.position())+T.position(),T)}static getSizePrefixedRootAsTime(T,td){return T.setPosition(T.position()+4),(td||new r).__init(T.readInt32(T.position())+T.position(),T)}unit(){let T=this.bb.__offset(this.bb_pos,4);return T?this.bb.readInt16(this.bb_pos+T):Ur.MILLISECOND}bitWidth(){let T=this.bb.__offset(this.bb_pos,6);return T?this.bb.readInt32(this.bb_pos+T):32}static startTime(T){T.startObject(2)}static addUnit(T,td){T.addFieldInt16(0,td,Ur.MILLISECOND)}static addBitWidth(T,td){T.addFieldInt32(1,td,32)}static endTime(T){return T.endObject()}static createTime(T,td,tf){return r.startTime(T),r.addUnit(T,td),r.addBitWidth(T,tf),r.endTime(T)}},pr=class r{constructor(){this.bb=null,this.bb_pos=0}__init(T,td){return this.bb_pos=T,this.bb=td,this}static getRootAsTimestamp(T,td){return(td||new r).__init(T.readInt32(T.position())+T.position(),T)}static getSizePrefixedRootAsTimestamp(T,td){return T.setPosition(T.position()+4),(td||new r).__init(T.readInt32(T.position())+T.position(),T)}unit(){let T=this.bb.__offset(this.bb_pos,4);return T?this.bb.readInt16(this.bb_pos+T):Ur.SECOND}timezone(T){let td=this.bb.__offset(this.bb_pos,6);return td?this.bb.__string(this.bb_pos+td,T):null}static startTimestamp(T){T.startObject(2)}static addUnit(T,td){T.addFieldInt16(0,td,Ur.SECOND)}static addTimezone(T,td){T.addFieldOffset(1,td,0)}static endTimestamp(T){return T.endObject()}static createTimestamp(T,td,tf){return r.startTimestamp(T),r.addUnit(T,td),r.addTimezone(T,tf),r.endTimestamp(T)}};!function(T){T[T.Sparse=0]="Sparse",T[T.Dense=1]="Dense"}(yi||(yi={}));var Ue=class r{constructor(){this.bb=null,this.bb_pos=0}__init(T,td){return this.bb_pos=T,this.bb=td,this}static getRootAsUnion(T,td){return(td||new r).__init(T.readInt32(T.position())+T.position(),T)}static getSizePrefixedRootAsUnion(T,td){return T.setPosition(T.position()+4),(td||new r).__init(T.readInt32(T.position())+T.position(),T)}mode(){let T=this.bb.__offset(this.bb_pos,4);return T?this.bb.readInt16(this.bb_pos+T):yi.Sparse}typeIds(T){let td=this.bb.__offset(this.bb_pos,6);return td?this.bb.readInt32(this.bb.__vector(this.bb_pos+td)+4*T):0}typeIdsLength(){let T=this.bb.__offset(this.bb_pos,6);return T?this.bb.__vector_len(this.bb_pos+T):0}typeIdsArray(){let T=this.bb.__offset(this.bb_pos,6);return T?new Int32Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+T),this.bb.__vector_len(this.bb_pos+T)):null}static startUnion(T){T.startObject(2)}static addMode(T,td){T.addFieldInt16(0,td,yi.Sparse)}static addTypeIds(T,td){T.addFieldOffset(1,td,0)}static createTypeIdsVector(T,td){T.startVector(4,td.length,4);for(let tf=td.length-1;tf>=0;tf--)T.addInt32(td[tf]);return T.endVector()}static startTypeIdsVector(T,td){T.startVector(4,td,4)}static endUnion(T){return T.endObject()}static createUnion(T,td,tf){return r.startUnion(T),r.addMode(T,td),r.addTypeIds(T,tf),r.endUnion(T)}},_i=class r{constructor(){this.bb=null,this.bb_pos=0}__init(T,td){return this.bb_pos=T,this.bb=td,this}static getRootAsUtf8(T,td){return(td||new r).__init(T.readInt32(T.position())+T.position(),T)}static getSizePrefixedRootAsUtf8(T,td){return T.setPosition(T.position()+4),(td||new r).__init(T.readInt32(T.position())+T.position(),T)}static startUtf8(T){T.startObject(0)}static endUtf8(T){return T.endObject()}static createUtf8(T){return r.startUtf8(T),r.endUtf8(T)}};!function(T){T[T.NONE=0]="NONE",T[T.Null=1]="Null",T[T.Int=2]="Int",T[T.FloatingPoint=3]="FloatingPoint",T[T.Binary=4]="Binary",T[T.Utf8=5]="Utf8",T[T.Bool=6]="Bool",T[T.Decimal=7]="Decimal",T[T.Date=8]="Date",T[T.Time=9]="Time",T[T.Timestamp=10]="Timestamp",T[T.Interval=11]="Interval",T[T.List=12]="List",T[T.Struct_=13]="Struct_",T[T.Union=14]="Union",T[T.FixedSizeBinary=15]="FixedSizeBinary",T[T.FixedSizeList=16]="FixedSizeList",T[T.Map=17]="Map",T[T.Duration=18]="Duration",T[T.LargeBinary=19]="LargeBinary",T[T.LargeUtf8=20]="LargeUtf8",T[T.LargeList=21]="LargeList",T[T.RunEndEncoded=22]="RunEndEncoded"}(mt||(mt={}));var Pt=class r{constructor(){this.bb=null,this.bb_pos=0}__init(T,td){return this.bb_pos=T,this.bb=td,this}static getRootAsField(T,td){return(td||new r).__init(T.readInt32(T.position())+T.position(),T)}static getSizePrefixedRootAsField(T,td){return T.setPosition(T.position()+4),(td||new r).__init(T.readInt32(T.position())+T.position(),T)}name(T){let td=this.bb.__offset(this.bb_pos,4);return td?this.bb.__string(this.bb_pos+td,T):null}nullable(){let T=this.bb.__offset(this.bb_pos,6);return!!T&&!!this.bb.readInt8(this.bb_pos+T)}typeType(){let T=this.bb.__offset(this.bb_pos,8);return T?this.bb.readUint8(this.bb_pos+T):mt.NONE}type(T){let td=this.bb.__offset(this.bb_pos,10);return td?this.bb.__union(T,this.bb_pos+td):null}dictionary(T){let td=this.bb.__offset(this.bb_pos,12);return td?(T||new Xe).__init(this.bb.__indirect(this.bb_pos+td),this.bb):null}children(T,td){let tf=this.bb.__offset(this.bb_pos,14);return tf?(td||new r).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+tf)+4*T),this.bb):null}childrenLength(){let T=this.bb.__offset(this.bb_pos,14);return T?this.bb.__vector_len(this.bb_pos+T):0}customMetadata(T,td){let tf=this.bb.__offset(this.bb_pos,16);return tf?(td||new Et).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+tf)+4*T),this.bb):null}customMetadataLength(){let T=this.bb.__offset(this.bb_pos,16);return T?this.bb.__vector_len(this.bb_pos+T):0}static startField(T){T.startObject(7)}static addName(T,td){T.addFieldOffset(0,td,0)}static addNullable(T,td){T.addFieldInt8(1,+td,0)}static addTypeType(T,td){T.addFieldInt8(2,td,mt.NONE)}static addType(T,td){T.addFieldOffset(3,td,0)}static addDictionary(T,td){T.addFieldOffset(4,td,0)}static addChildren(T,td){T.addFieldOffset(5,td,0)}static createChildrenVector(T,td){T.startVector(4,td.length,4);for(let tf=td.length-1;tf>=0;tf--)T.addOffset(td[tf]);return T.endVector()}static startChildrenVector(T,td){T.startVector(4,td,4)}static addCustomMetadata(T,td){T.addFieldOffset(6,td,0)}static createCustomMetadataVector(T,td){T.startVector(4,td.length,4);for(let tf=td.length-1;tf>=0;tf--)T.addOffset(td[tf]);return T.endVector()}static startCustomMetadataVector(T,td){T.startVector(4,td,4)}static endField(T){return T.endObject()}},Jt=class r{constructor(){this.bb=null,this.bb_pos=0}__init(T,td){return this.bb_pos=T,this.bb=td,this}static getRootAsSchema(T,td){return(td||new r).__init(T.readInt32(T.position())+T.position(),T)}static getSizePrefixedRootAsSchema(T,td){return T.setPosition(T.position()+4),(td||new r).__init(T.readInt32(T.position())+T.position(),T)}endianness(){let T=this.bb.__offset(this.bb_pos,4);return T?this.bb.readInt16(this.bb_pos+T):Rr.Little}fields(T,td){let tf=this.bb.__offset(this.bb_pos,6);return tf?(td||new Pt).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+tf)+4*T),this.bb):null}fieldsLength(){let T=this.bb.__offset(this.bb_pos,6);return T?this.bb.__vector_len(this.bb_pos+T):0}customMetadata(T,td){let tf=this.bb.__offset(this.bb_pos,8);return tf?(td||new Et).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+tf)+4*T),this.bb):null}customMetadataLength(){let T=this.bb.__offset(this.bb_pos,8);return T?this.bb.__vector_len(this.bb_pos+T):0}features(T){let td=this.bb.__offset(this.bb_pos,10);return td?this.bb.readInt64(this.bb.__vector(this.bb_pos+td)+8*T):BigInt(0)}featuresLength(){let T=this.bb.__offset(this.bb_pos,10);return T?this.bb.__vector_len(this.bb_pos+T):0}static startSchema(T){T.startObject(4)}static addEndianness(T,td){T.addFieldInt16(0,td,Rr.Little)}static addFields(T,td){T.addFieldOffset(1,td,0)}static createFieldsVector(T,td){T.startVector(4,td.length,4);for(let tf=td.length-1;tf>=0;tf--)T.addOffset(td[tf]);return T.endVector()}static startFieldsVector(T,td){T.startVector(4,td,4)}static addCustomMetadata(T,td){T.addFieldOffset(2,td,0)}static createCustomMetadataVector(T,td){T.startVector(4,td.length,4);for(let tf=td.length-1;tf>=0;tf--)T.addOffset(td[tf]);return T.endVector()}static startCustomMetadataVector(T,td){T.startVector(4,td,4)}static addFeatures(T,td){T.addFieldOffset(3,td,0)}static createFeaturesVector(T,td){T.startVector(8,td.length,8);for(let tf=td.length-1;tf>=0;tf--)T.addInt64(td[tf]);return T.endVector()}static startFeaturesVector(T,td){T.startVector(8,td,8)}static endSchema(T){return T.endObject()}static finishSchemaBuffer(T,td){T.finish(td)}static finishSizePrefixedSchemaBuffer(T,td){T.finish(td,void 0,!0)}static createSchema(T,td,tf,tb,t_){return r.startSchema(T),r.addEndianness(T,td),r.addFields(T,tf),r.addCustomMetadata(T,tb),r.addFeatures(T,t_),r.endSchema(T)}},ce=class r{constructor(){this.bb=null,this.bb_pos=0}__init(T,td){return this.bb_pos=T,this.bb=td,this}static getRootAsFooter(T,td){return(td||new r).__init(T.readInt32(T.position())+T.position(),T)}static getSizePrefixedRootAsFooter(T,td){return T.setPosition(T.position()+4),(td||new r).__init(T.readInt32(T.position())+T.position(),T)}version(){let T=this.bb.__offset(this.bb_pos,4);return T?this.bb.readInt16(this.bb_pos+T):Or.V1}schema(T){let td=this.bb.__offset(this.bb_pos,6);return td?(T||new Jt).__init(this.bb.__indirect(this.bb_pos+td),this.bb):null}dictionaries(T,td){let tf=this.bb.__offset(this.bb_pos,8);return tf?(td||new Qr).__init(this.bb.__vector(this.bb_pos+tf)+24*T,this.bb):null}dictionariesLength(){let T=this.bb.__offset(this.bb_pos,8);return T?this.bb.__vector_len(this.bb_pos+T):0}recordBatches(T,td){let tf=this.bb.__offset(this.bb_pos,10);return tf?(td||new Qr).__init(this.bb.__vector(this.bb_pos+tf)+24*T,this.bb):null}recordBatchesLength(){let T=this.bb.__offset(this.bb_pos,10);return T?this.bb.__vector_len(this.bb_pos+T):0}customMetadata(T,td){let tf=this.bb.__offset(this.bb_pos,12);return tf?(td||new Et).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+tf)+4*T),this.bb):null}customMetadataLength(){let T=this.bb.__offset(this.bb_pos,12);return T?this.bb.__vector_len(this.bb_pos+T):0}static startFooter(T){T.startObject(5)}static addVersion(T,td){T.addFieldInt16(0,td,Or.V1)}static addSchema(T,td){T.addFieldOffset(1,td,0)}static addDictionaries(T,td){T.addFieldOffset(2,td,0)}static startDictionariesVector(T,td){T.startVector(24,td,8)}static addRecordBatches(T,td){T.addFieldOffset(3,td,0)}static startRecordBatchesVector(T,td){T.startVector(24,td,8)}static addCustomMetadata(T,td){T.addFieldOffset(4,td,0)}static createCustomMetadataVector(T,td){T.startVector(4,td.length,4);for(let tf=td.length-1;tf>=0;tf--)T.addOffset(td[tf]);return T.endVector()}static startCustomMetadataVector(T,td){T.startVector(4,td,4)}static endFooter(T){return T.endObject()}static finishFooterBuffer(T,td){T.finish(td)}static finishSizePrefixedFooterBuffer(T,td){T.finish(td,void 0,!0)}},nt=class r{constructor(T=[],td,tf){this.fields=T||[],this.metadata=td||new Map,tf||(tf=Aa(T)),this.dictionaries=tf}get[Symbol.toStringTag](){return"Schema"}get names(){return this.fields.map(T=>T.name)}toString(){return"Schema<{ ".concat(this.fields.map((T,td)=>"".concat(td,": ").concat(T)).join(", ")," }>")}select(T){let td=new Set(T);return new r(this.fields.filter(T=>td.has(T.name)),this.metadata)}selectAt(T){return new r(T.map(T=>this.fields[T]).filter(Boolean),this.metadata)}assign(...T){let td=T[0]instanceof r?T[0]:Array.isArray(T[0])?new r(T[0]):new r(T),tf=[...this.fields],tb=Ys(Ys(new Map,this.metadata),td.metadata),t_=td.fields.filter(T=>{let td=tf.findIndex(td=>td.name===T.name);return!~td||(tf[td]=T.clone({metadata:Ys(Ys(new Map,tf[td].metadata),T.metadata)}))&&!1}),tg=Aa(t_,new Map);return new r([...tf,...t_],tb,new Map([...this.dictionaries,...tg]))}};nt.prototype.fields=null,nt.prototype.metadata=null,nt.prototype.dictionaries=null;var Y=class r{static new(...T){let[td,tf,tb,t_]=T;return T[0]&&"object"==typeof T[0]&&({name:td}=T[0],void 0===tf&&(tf=T[0].type),void 0===tb&&(tb=T[0].nullable),void 0===t_&&(t_=T[0].metadata)),new r("".concat(td),tf,tb,t_)}constructor(T,td,tf=!1,tb){this.name=T,this.type=td,this.nullable=tf,this.metadata=tb||new Map}get typeId(){return this.type.typeId}get[Symbol.toStringTag](){return"Field"}toString(){return"".concat(this.name,": ").concat(this.type)}clone(...T){let[td,tf,tb,t_]=T;return T[0]&&"object"==typeof T[0]?{name:td=this.name,type:tf=this.type,nullable:tb=this.nullable,metadata:t_=this.metadata}=T[0]:[td=this.name,tf=this.type,tb=this.nullable,t_=this.metadata]=T,r.new(td,tf,tb,t_)}};function Ys(T,td){return new Map([...T||new Map,...td||new Map])}function Aa(T,td=new Map){for(let tf=-1,tb=T.length;++tf<tb;){let tb=T[tf].type;if(D.isDictionary(tb)){if(td.has(tb.id)){if(td.get(tb.id)!==tb.dictionary)throw Error("Cannot create Schema containing two different dictionaries with the same Id")}else td.set(tb.id,tb.dictionary)}tb.children&&tb.children.length>0&&Aa(tb.children,td)}return td}Y.prototype.type=null,Y.prototype.name=null,Y.prototype.nullable=null,Y.prototype.metadata=null;var cm=tn,lm=ae,mr=class{static decode(T){T=new lm(L(T));let td=ce.getRootAsFooter(T);return new Ta(nt.decode(td.schema()),td)}static encode(T){let td=new cm,tf=nt.encode(td,T.schema);for(let tf of(ce.startRecordBatchesVector(td,T.numRecordBatches),[...T.recordBatches()].slice().reverse()))yr.encode(td,tf);let tb=td.endVector();for(let tf of(ce.startDictionariesVector(td,T.numDictionaries),[...T.dictionaryBatches()].slice().reverse()))yr.encode(td,tf);let t_=td.endVector();return ce.startFooter(td),ce.addSchema(td,tf),ce.addVersion(td,Ot.V4),ce.addRecordBatches(td,tb),ce.addDictionaries(td,t_),ce.finishFooterBuffer(td,ce.endFooter(td)),td.asUint8Array()}get numRecordBatches(){return this._recordBatches.length}get numDictionaries(){return this._dictionaryBatches.length}constructor(T,td=Ot.V4,tf,tb){this.schema=T,this.version=td,tf&&(this._recordBatches=tf),tb&&(this._dictionaryBatches=tb)}*recordBatches(){for(let T,td=-1,tf=this.numRecordBatches;++td<tf;)(T=this.getRecordBatch(td))&&(yield T)}*dictionaryBatches(){for(let T,td=-1,tf=this.numDictionaries;++td<tf;)(T=this.getDictionaryBatch(td))&&(yield T)}getRecordBatch(T){return T>=0&&T<this.numRecordBatches&&this._recordBatches[T]||null}getDictionaryBatch(T){return T>=0&&T<this.numDictionaries&&this._dictionaryBatches[T]||null}},Ta=class extends mr{get numRecordBatches(){return this._footer.recordBatchesLength()}get numDictionaries(){return this._footer.dictionariesLength()}constructor(T,td){super(T,td.version()),this._footer=td}getRecordBatch(T){if(T>=0&&T<this.numRecordBatches){let td=this._footer.recordBatches(T);if(td)return yr.decode(td)}return null}getDictionaryBatch(T){if(T>=0&&T<this.numDictionaries){let td=this._footer.dictionaries(T);if(td)return yr.decode(td)}return null}},yr=class r{static decode(T){return new r(T.metaDataLength(),T.bodyLength(),T.offset())}static encode(T,td){let{metaDataLength:tf}=td,tb=BigInt(td.offset),t_=BigInt(td.bodyLength);return Qr.createBlock(T,tb,tf,t_)}constructor(T,td,tf){this.metaDataLength=T,this.offset=Gt(tf),this.bodyLength=Gt(td)}},dt=Object.freeze({done:!0,value:void 0}),bi=class{constructor(T){this._json=T}get schema(){return this._json.schema}get batches(){return this._json.batches||[]}get dictionaries(){return this._json.dictionaries||[]}},en=class{tee(){return this._getDOMStream().tee()}pipe(T,td){return this._getNodeStream().pipe(T,td)}pipeTo(T,td){return this._getDOMStream().pipeTo(T,td)}pipeThrough(T,td){return this._getDOMStream().pipeThrough(T,td)}_getDOMStream(){return this._DOMStream||(this._DOMStream=this.toDOMStream())}_getNodeStream(){return this._nodeStream||(this._nodeStream=this.toNodeStream())}},Xs=class extends en{constructor(){super(),this._values=[],this.resolvers=[],this._closedPromise=new Promise(T=>this._closedPromiseResolve=T)}get closed(){return this._closedPromise}cancel(T){return F(this,void 0,void 0,function*(){yield this.return(T)})}write(T){this._ensureOpen()&&(this.resolvers.length<=0?this._values.push(T):this.resolvers.shift().resolve({done:!1,value:T}))}abort(T){this._closedPromiseResolve&&(this.resolvers.length<=0?this._error={error:T}:this.resolvers.shift().reject({done:!0,value:T}))}close(){if(this._closedPromiseResolve){let{resolvers:T}=this;for(;T.length>0;)T.shift().resolve(dt);this._closedPromiseResolve(),this._closedPromiseResolve=void 0}}[Symbol.asyncIterator](){return this}toDOMStream(T){return Ut.toDOMStream(this._closedPromiseResolve||this._error?this:this._values,T)}toNodeStream(T){return Ut.toNodeStream(this._closedPromiseResolve||this._error?this:this._values,T)}throw(T){return F(this,void 0,void 0,function*(){return yield this.abort(T),dt})}return(T){return F(this,void 0,void 0,function*(){return yield this.close(),dt})}read(T){return F(this,void 0,void 0,function*(){return(yield this.next(T,"read")).value})}peek(T){return F(this,void 0,void 0,function*(){return(yield this.next(T,"peek")).value})}next(...T){return this._values.length>0?Promise.resolve({done:!1,value:this._values.shift()}):this._error?Promise.reject({done:!0,value:this._error.error}):this._closedPromiseResolve?new Promise((T,td)=>{this.resolvers.push({resolve:T,reject:td})}):Promise.resolve(dt)}_ensureOpen(){if(this._closedPromiseResolve)return!0;throw Error("AsyncQueue is closed")}},Ke=class extends Xs{write(T){if((T=L(T)).byteLength>0)return super.write(T)}toString(T=!1){return T?Jn(this.toUint8Array(!0)):this.toUint8Array(!1).then(Jn)}toUint8Array(T=!1){return T?ne(this._values)[0]:F(this,void 0,void 0,function*(){var T,td,tf,tb;let t_=[],tg=0;try{for(var tv,tw=!0,tI=ve(this);!(T=(tv=yield tI.next()).done);tw=!0){tb=tv.value,tw=!1;let T=tb;t_.push(T),tg+=T.byteLength}}catch(T){td={error:T}}finally{try{!tw&&!T&&(tf=tI.return)&&(yield tf.call(tI))}finally{if(td)throw td.error}}return ne(t_,tg)[0]})}},Je=class{constructor(T){T&&(this.source=new xa(Ut.fromIterable(T)))}[Symbol.iterator](){return this}next(T){return this.source.next(T)}throw(T){return this.source.throw(T)}return(T){return this.source.return(T)}peek(T){return this.source.peek(T)}read(T){return this.source.read(T)}},_e=class r{constructor(T){T instanceof r?this.source=T.source:T instanceof Ke?this.source=new _r(Ut.fromAsyncIterable(T)):ls(T)?this.source=new _r(Ut.fromNodeStream(T)):qn(T)?this.source=new _r(Ut.fromDOMStream(T)):as(T)?this.source=new _r(Ut.fromDOMStream(T.body)):Ie(T)?this.source=new _r(Ut.fromIterable(T)):Se(T)?this.source=new _r(Ut.fromAsyncIterable(T)):he(T)&&(this.source=new _r(Ut.fromAsyncIterable(T)))}[Symbol.asyncIterator](){return this}next(T){return this.source.next(T)}throw(T){return this.source.throw(T)}return(T){return this.source.return(T)}get closed(){return this.source.closed}cancel(T){return this.source.cancel(T)}peek(T){return this.source.peek(T)}read(T){return this.source.read(T)}},xa=class{constructor(T){this.source=T}cancel(T){this.return(T)}peek(T){return this.next(T,"peek").value}read(T){return this.next(T,"read").value}next(T,td="read"){return this.source.next({cmd:td,size:T})}throw(T){return Object.create(this.source.throw&&this.source.throw(T)||dt)}return(T){return Object.create(this.source.return&&this.source.return(T)||dt)}},_r=class{constructor(T){this.source=T,this._closedPromise=new Promise(T=>this._closedPromiseResolve=T)}cancel(T){return F(this,void 0,void 0,function*(){yield this.return(T)})}get closed(){return this._closedPromise}read(T){return F(this,void 0,void 0,function*(){return(yield this.next(T,"read")).value})}peek(T){return F(this,void 0,void 0,function*(){return(yield this.next(T,"peek")).value})}next(T,td="read"){return F(this,void 0,void 0,function*(){return yield this.source.next({cmd:td,size:T})})}throw(T){return F(this,void 0,void 0,function*(){let td=this.source.throw&&(yield this.source.throw(T))||dt;return this._closedPromiseResolve&&this._closedPromiseResolve(),this._closedPromiseResolve=void 0,Object.create(td)})}return(T){return F(this,void 0,void 0,function*(){let td=this.source.return&&(yield this.source.return(T))||dt;return this._closedPromiseResolve&&this._closedPromiseResolve(),this._closedPromiseResolve=void 0,Object.create(td)})}},gi=class extends Je{constructor(T,td){super(),this.position=0,this.buffer=L(T),this.size=void 0===td?this.buffer.byteLength:td}readInt32(T){let{buffer:td,byteOffset:tf}=this.readAt(T,4);return new DataView(td,tf).getInt32(0,!0)}seek(T){return this.position=Math.min(T,this.size),T<this.size}read(T){let{buffer:td,size:tf,position:tb}=this;return td&&tb<tf?("number"!=typeof T&&(T=Number.POSITIVE_INFINITY),this.position=Math.min(tf,tb+Math.min(tf-tb,T)),td.subarray(tb,this.position)):null}readAt(T,td){let tf=this.buffer,tb=Math.min(this.size,T+td);return tf?tf.subarray(T,tb):new Uint8Array(td)}close(){this.buffer&&(this.buffer=null)}throw(T){return this.close(),{done:!0,value:T}}return(T){return this.close(),{done:!0,value:T}}},Vr=class extends _e{constructor(T,td){super(),this.position=0,this._handle=T,"number"==typeof td?this.size=td:this._pending=F(this,void 0,void 0,function*(){this.size=(yield T.stat()).size,delete this._pending})}readInt32(T){return F(this,void 0,void 0,function*(){let{buffer:td,byteOffset:tf}=yield this.readAt(T,4);return new DataView(td,tf).getInt32(0,!0)})}seek(T){return F(this,void 0,void 0,function*(){return this._pending&&(yield this._pending),this.position=Math.min(T,this.size),T<this.size})}read(T){return F(this,void 0,void 0,function*(){this._pending&&(yield this._pending);let{_handle:td,size:tf,position:tb}=this;if(td&&tb<tf){"number"!=typeof T&&(T=Number.POSITIVE_INFINITY);let t_=tb,tg=0,tv=0,tw=Math.min(tf,t_+Math.min(tf-t_,T)),tI=new Uint8Array(Math.max(0,(this.position=tw)-t_));for(;(t_+=tv)<tw&&(tg+=tv)<tI.byteLength;)({bytesRead:tv}=yield td.read(tI,tg,tI.byteLength-tg,t_));return tI}return null})}readAt(T,td){return F(this,void 0,void 0,function*(){this._pending&&(yield this._pending);let{_handle:tf,size:tb}=this;if(tf&&T+td<tb){let t_=Math.min(tb,T+td),tg=new Uint8Array(t_-T);return(yield tf.read(tg,0,td,T)).buffer}return new Uint8Array(td)})}close(){return F(this,void 0,void 0,function*(){let T=this._handle;this._handle=null,T&&(yield T.close())})}throw(T){return F(this,void 0,void 0,function*(){return yield this.close(),{done:!0,value:T}})}return(T){return F(this,void 0,void 0,function*(){return yield this.close(),{done:!0,value:T}})}},Ea={};function Mn(T){return T<0&&(T=4294967295+T+1),"0x".concat(T.toString(16))}Xr(Ea,{BaseInt64:()=>wi,Int128:()=>vi,Int64:()=>br,Uint64:()=>_t});var Un=8,Da=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8],wi=class{constructor(T){this.buffer=T}high(){return this.buffer[1]}low(){return this.buffer[0]}_times(T){let td=new Uint32Array([this.buffer[1]>>>16,65535&this.buffer[1],this.buffer[0]>>>16,65535&this.buffer[0]]),tf=new Uint32Array([T.buffer[1]>>>16,65535&T.buffer[1],T.buffer[0]>>>16,65535&T.buffer[0]]),tb=td[3]*tf[3];this.buffer[0]=65535&tb;let t_=tb>>>16;return t_+=(tb=td[2]*tf[3])+(tb=td[3]*tf[2]>>>0),this.buffer[0]+=t_<<16,this.buffer[1]=t_>>>0<tb?65536:0,this.buffer[1]+=t_>>>16,this.buffer[1]+=td[1]*tf[3]+td[2]*tf[2]+td[3]*tf[1],this.buffer[1]+=td[0]*tf[3]+td[1]*tf[2]+td[2]*tf[1]+td[3]*tf[0]<<16,this}_plus(T){let td=this.buffer[0]+T.buffer[0]>>>0;this.buffer[1]+=T.buffer[1],td<this.buffer[0]>>>0&&++this.buffer[1],this.buffer[0]=td}lessThan(T){return this.buffer[1]<T.buffer[1]||this.buffer[1]===T.buffer[1]&&this.buffer[0]<T.buffer[0]}equals(T){return this.buffer[1]===T.buffer[1]&&this.buffer[0]==T.buffer[0]}greaterThan(T){return T.lessThan(this)}hex(){return"".concat(Mn(this.buffer[1])," ").concat(Mn(this.buffer[0]))}},_t=class r extends wi{times(T){return this._times(T),this}plus(T){return this._plus(T),this}static from(T,td=new Uint32Array(2)){return r.fromString("string"==typeof T?T:T.toString(),td)}static fromNumber(T,td=new Uint32Array(2)){return r.fromString(T.toString(),td)}static fromString(T,td=new Uint32Array(2)){let tf=T.length,tb=new r(td);for(let td=0;td<tf;){let t_=Un<tf-td?Un:tf-td,tg=new r(new Uint32Array([Number.parseInt(T.slice(td,td+t_),10),0])),tv=new r(new Uint32Array([Da[t_],0]));tb.times(tv),tb.plus(tg),td+=t_}return tb}static convertArray(T){let td=new Uint32Array(2*T.length);for(let tf=-1,tb=T.length;++tf<tb;)r.from(T[tf],new Uint32Array(td.buffer,td.byteOffset+2*tf*4,2));return td}static multiply(T,td){return new r(new Uint32Array(T.buffer)).times(td)}static add(T,td){return new r(new Uint32Array(T.buffer)).plus(td)}},br=class r extends wi{negate(){return this.buffer[0]=~this.buffer[0]+1,this.buffer[1]=~this.buffer[1],0==this.buffer[0]&&++this.buffer[1],this}times(T){return this._times(T),this}plus(T){return this._plus(T),this}lessThan(T){let td=this.buffer[1]<<0,tf=T.buffer[1]<<0;return td<tf||td===tf&&this.buffer[0]<T.buffer[0]}static from(T,td=new Uint32Array(2)){return r.fromString("string"==typeof T?T:T.toString(),td)}static fromNumber(T,td=new Uint32Array(2)){return r.fromString(T.toString(),td)}static fromString(T,td=new Uint32Array(2)){let tf=T.startsWith("-"),tb=T.length,t_=new r(td);for(let td=tf?1:0;td<tb;){let tf=Un<tb-td?Un:tb-td,tg=new r(new Uint32Array([Number.parseInt(T.slice(td,td+tf),10),0])),tv=new r(new Uint32Array([Da[tf],0]));t_.times(tv),t_.plus(tg),td+=tf}return tf?t_.negate():t_}static convertArray(T){let td=new Uint32Array(2*T.length);for(let tf=-1,tb=T.length;++tf<tb;)r.from(T[tf],new Uint32Array(td.buffer,td.byteOffset+2*tf*4,2));return td}static multiply(T,td){return new r(new Uint32Array(T.buffer)).times(td)}static add(T,td){return new r(new Uint32Array(T.buffer)).plus(td)}},vi=class r{constructor(T){this.buffer=T}high(){return new br(new Uint32Array(this.buffer.buffer,this.buffer.byteOffset+8,2))}low(){return new br(new Uint32Array(this.buffer.buffer,this.buffer.byteOffset,2))}negate(){return this.buffer[0]=~this.buffer[0]+1,this.buffer[1]=~this.buffer[1],this.buffer[2]=~this.buffer[2],this.buffer[3]=~this.buffer[3],0==this.buffer[0]&&++this.buffer[1],0==this.buffer[1]&&++this.buffer[2],0==this.buffer[2]&&++this.buffer[3],this}times(T){let td=new _t(new Uint32Array([this.buffer[3],0])),tf=new _t(new Uint32Array([this.buffer[2],0])),tb=new _t(new Uint32Array([this.buffer[1],0])),t_=new _t(new Uint32Array([this.buffer[0],0])),tg=new _t(new Uint32Array([T.buffer[3],0])),tv=new _t(new Uint32Array([T.buffer[2],0])),tw=new _t(new Uint32Array([T.buffer[1],0])),tI=new _t(new Uint32Array([T.buffer[0],0])),tS=_t.multiply(t_,tI);this.buffer[0]=tS.low();let tA=new _t(new Uint32Array([tS.high(),0]));return tS=_t.multiply(tb,tI),tA.plus(tS),tS=_t.multiply(t_,tw),tA.plus(tS),this.buffer[1]=tA.low(),this.buffer[3]=tA.lessThan(tS)?1:0,this.buffer[2]=tA.high(),new _t(new Uint32Array(this.buffer.buffer,this.buffer.byteOffset+8,2)).plus(_t.multiply(tf,tI)).plus(_t.multiply(tb,tw)).plus(_t.multiply(t_,tv)),this.buffer[3]+=_t.multiply(td,tI).plus(_t.multiply(tf,tw)).plus(_t.multiply(tb,tv)).plus(_t.multiply(t_,tg)).low(),this}plus(T){let td=new Uint32Array(4);return td[3]=this.buffer[3]+T.buffer[3]>>>0,td[2]=this.buffer[2]+T.buffer[2]>>>0,td[1]=this.buffer[1]+T.buffer[1]>>>0,td[0]=this.buffer[0]+T.buffer[0]>>>0,td[0]<this.buffer[0]>>>0&&++td[1],td[1]<this.buffer[1]>>>0&&++td[2],td[2]<this.buffer[2]>>>0&&++td[3],this.buffer[3]=td[3],this.buffer[2]=td[2],this.buffer[1]=td[1],this.buffer[0]=td[0],this}hex(){return"".concat(Mn(this.buffer[3])," ").concat(Mn(this.buffer[2])," ").concat(Mn(this.buffer[1])," ").concat(Mn(this.buffer[0]))}static multiply(T,td){return new r(new Uint32Array(T.buffer)).times(td)}static add(T,td){return new r(new Uint32Array(T.buffer)).plus(td)}static from(T,td=new Uint32Array(4)){return r.fromString("string"==typeof T?T:T.toString(),td)}static fromNumber(T,td=new Uint32Array(4)){return r.fromString(T.toString(),td)}static fromString(T,td=new Uint32Array(4)){let tf=T.startsWith("-"),tb=T.length,t_=new r(td);for(let td=tf?1:0;td<tb;){let tf=Un<tb-td?Un:tb-td,tg=new r(new Uint32Array([Number.parseInt(T.slice(td,td+tf),10),0,0,0])),tv=new r(new Uint32Array([Da[tf],0,0,0]));t_.times(tv),t_.plus(tg),td+=tf}return tf?t_.negate():t_}static convertArray(T){let td=new Uint32Array(4*T.length);for(let tf=-1,tb=T.length;++tf<tb;)r.from(T[tf],new Uint32Array(td.buffer,td.byteOffset+16*tf,4));return td}},Si=class extends E{constructor(T,td,tf,tb){super(),this.nodesIndex=-1,this.buffersIndex=-1,this.bytes=T,this.nodes=td,this.buffers=tf,this.dictionaries=tb}visit(T){return super.visit(T instanceof Y?T.type:T)}visitNull(T,{length:td}=this.nextFieldNode()){return P({type:T,length:td})}visitBool(T,{length:td,nullCount:tf}=this.nextFieldNode()){return P({type:T,length:td,nullCount:tf,nullBitmap:this.readNullBitmap(T,tf),data:this.readData(T)})}visitInt(T,{length:td,nullCount:tf}=this.nextFieldNode()){return P({type:T,length:td,nullCount:tf,nullBitmap:this.readNullBitmap(T,tf),data:this.readData(T)})}visitFloat(T,{length:td,nullCount:tf}=this.nextFieldNode()){return P({type:T,length:td,nullCount:tf,nullBitmap:this.readNullBitmap(T,tf),data:this.readData(T)})}visitUtf8(T,{length:td,nullCount:tf}=this.nextFieldNode()){return P({type:T,length:td,nullCount:tf,nullBitmap:this.readNullBitmap(T,tf),valueOffsets:this.readOffsets(T),data:this.readData(T)})}visitBinary(T,{length:td,nullCount:tf}=this.nextFieldNode()){return P({type:T,length:td,nullCount:tf,nullBitmap:this.readNullBitmap(T,tf),valueOffsets:this.readOffsets(T),data:this.readData(T)})}visitFixedSizeBinary(T,{length:td,nullCount:tf}=this.nextFieldNode()){return P({type:T,length:td,nullCount:tf,nullBitmap:this.readNullBitmap(T,tf),data:this.readData(T)})}visitDate(T,{length:td,nullCount:tf}=this.nextFieldNode()){return P({type:T,length:td,nullCount:tf,nullBitmap:this.readNullBitmap(T,tf),data:this.readData(T)})}visitTimestamp(T,{length:td,nullCount:tf}=this.nextFieldNode()){return P({type:T,length:td,nullCount:tf,nullBitmap:this.readNullBitmap(T,tf),data:this.readData(T)})}visitTime(T,{length:td,nullCount:tf}=this.nextFieldNode()){return P({type:T,length:td,nullCount:tf,nullBitmap:this.readNullBitmap(T,tf),data:this.readData(T)})}visitDecimal(T,{length:td,nullCount:tf}=this.nextFieldNode()){return P({type:T,length:td,nullCount:tf,nullBitmap:this.readNullBitmap(T,tf),data:this.readData(T)})}visitList(T,{length:td,nullCount:tf}=this.nextFieldNode()){return P({type:T,length:td,nullCount:tf,nullBitmap:this.readNullBitmap(T,tf),valueOffsets:this.readOffsets(T),child:this.visit(T.children[0])})}visitStruct(T,{length:td,nullCount:tf}=this.nextFieldNode()){return P({type:T,length:td,nullCount:tf,nullBitmap:this.readNullBitmap(T,tf),children:this.visitMany(T.children)})}visitUnion(T){return T.mode===yt.Sparse?this.visitSparseUnion(T):this.visitDenseUnion(T)}visitDenseUnion(T,{length:td,nullCount:tf}=this.nextFieldNode()){return P({type:T,length:td,nullCount:tf,nullBitmap:this.readNullBitmap(T,tf),typeIds:this.readTypeIds(T),valueOffsets:this.readOffsets(T),children:this.visitMany(T.children)})}visitSparseUnion(T,{length:td,nullCount:tf}=this.nextFieldNode()){return P({type:T,length:td,nullCount:tf,nullBitmap:this.readNullBitmap(T,tf),typeIds:this.readTypeIds(T),children:this.visitMany(T.children)})}visitDictionary(T,{length:td,nullCount:tf}=this.nextFieldNode()){return P({type:T,length:td,nullCount:tf,nullBitmap:this.readNullBitmap(T,tf),data:this.readData(T.indices),dictionary:this.readDictionary(T)})}visitInterval(T,{length:td,nullCount:tf}=this.nextFieldNode()){return P({type:T,length:td,nullCount:tf,nullBitmap:this.readNullBitmap(T,tf),data:this.readData(T)})}visitFixedSizeList(T,{length:td,nullCount:tf}=this.nextFieldNode()){return P({type:T,length:td,nullCount:tf,nullBitmap:this.readNullBitmap(T,tf),child:this.visit(T.children[0])})}visitMap(T,{length:td,nullCount:tf}=this.nextFieldNode()){return P({type:T,length:td,nullCount:tf,nullBitmap:this.readNullBitmap(T,tf),valueOffsets:this.readOffsets(T),child:this.visit(T.children[0])})}nextFieldNode(){return this.nodes[++this.nodesIndex]}nextBufferRange(){return this.buffers[++this.buffersIndex]}readNullBitmap(T,td,tf=this.nextBufferRange()){return td>0&&this.readData(T,tf)||new Uint8Array(0)}readOffsets(T,td){return this.readData(T,td)}readTypeIds(T,td){return this.readData(T,td)}readData(T,{length:td,offset:tf}=this.nextBufferRange()){return this.bytes.subarray(tf,tf+td)}readDictionary(T){return this.dictionaries.get(T.id)}},Gs=class extends Si{constructor(T,td,tf,tb){super(new Uint8Array(0),td,tf,tb),this.sources=T}readNullBitmap(T,td,{offset:tf}=this.nextBufferRange()){return td<=0?new Uint8Array(0):qr(this.sources[tf])}readOffsets(T,{offset:td}=this.nextBufferRange()){return W(Uint8Array,W(Int32Array,this.sources[td]))}readTypeIds(T,{offset:td}=this.nextBufferRange()){return W(Uint8Array,W(T.ArrayType,this.sources[td]))}readData(T,{offset:td}=this.nextBufferRange()){let{sources:tf}=this;return D.isTimestamp(T)?W(Uint8Array,br.convertArray(tf[td])):(D.isInt(T)||D.isTime(T))&&64===T.bitWidth?W(Uint8Array,br.convertArray(tf[td])):D.isDate(T)&&T.unit===Nt.MILLISECOND?W(Uint8Array,br.convertArray(tf[td])):D.isDecimal(T)?W(Uint8Array,vi.convertArray(tf[td])):D.isBinary(T)||D.isFixedSizeBinary(T)?um(tf[td]):D.isBool(T)?qr(tf[td]):D.isUtf8(T)?Br(tf[td].join("")):W(Uint8Array,W(T.ArrayType,tf[td].map(T=>+T)))}};function um(T){let td=T.join(""),tf=new Uint8Array(td.length/2);for(let T=0;T<td.length;T+=2)tf[T>>1]=Number.parseInt(td.slice(T,T+2),16);return tf}var Nn=class extends $e{constructor(T){super(T),this._values=new Er(new Uint8Array(0))}get byteLength(){let T=this._pendingLength+4*this.length;return this._offsets&&(T+=this._offsets.byteLength),this._values&&(T+=this._values.byteLength),this._nulls&&(T+=this._nulls.byteLength),T}setValue(T,td){return super.setValue(T,L(td))}_flushPending(T,td){let tf=this._offsets,tb=this._values.reserve(td).buffer,t_=0;for(let[td,tg]of T)if(void 0===tg)tf.set(td,0);else{let T=tg.length;tb.set(tg,t_),tf.set(td,T),t_+=T}}},Ks=class extends pt{constructor(T){super(T),this._values=new En}setValue(T,td){this._values.set(T,+td)}},rn=class extends Rt{};rn.prototype._setValue=ua;var Ii=class extends rn{};Ii.prototype._setValue=Ss;var Fi=class extends rn{};Fi.prototype._setValue=Is;var Bi=class extends Rt{};Bi.prototype._setValue=ha;var Js=class extends pt{constructor({type:T,nullValues:td,dictionaryHashFunction:tf}){super({type:new ie(T.dictionary,T.indices,T.id,T.isOrdered)}),this._nulls=null,this._dictionaryOffset=0,this._keysToIndices=Object.create(null),this.indices=nn({type:this.type.indices,nullValues:td}),this.dictionary=nn({type:this.type.dictionary,nullValues:null}),"function"==typeof tf&&(this.valueToKey=tf)}get values(){return this.indices.values}get nullCount(){return this.indices.nullCount}get nullBitmap(){return this.indices.nullBitmap}get byteLength(){return this.indices.byteLength+this.dictionary.byteLength}get reservedLength(){return this.indices.reservedLength+this.dictionary.reservedLength}get reservedByteLength(){return this.indices.reservedByteLength+this.dictionary.reservedByteLength}isValid(T){return this.indices.isValid(T)}setValid(T,td){let tf=this.indices;return td=tf.setValid(T,td),this.length=tf.length,td}setValue(T,td){let tf=this._keysToIndices,tb=this.valueToKey(td),t_=tf[tb];return void 0===t_&&(tf[tb]=t_=this._dictionaryOffset+this.dictionary.append(td).length-1),this.indices.setValue(T,t_)}flush(){let T=this.type,td=this._dictionary,tf=this.dictionary.toVector(),tb=this.indices.flush().clone(T);return tb.dictionary=td?td.concat(tf):tf,this.finished||(this._dictionaryOffset+=tf.length),this._dictionary=tb.dictionary,this.clear(),tb}finish(){return this.indices.finish(),this.dictionary.finish(),this._dictionaryOffset=0,this._keysToIndices=Object.create(null),super.finish()}clear(){return this.indices.clear(),this.dictionary.clear(),super.clear()}valueToKey(T){return"string"==typeof T?T:"".concat(T)}},Ai=class extends Rt{};Ai.prototype._setValue=la;var qs=class extends pt{setValue(T,td){let[tf]=this.children,tb=T*this.stride;for(let T=-1,t_=td.length;++T<t_;)tf.set(tb+T,td[T])}addChild(T,td="0"){if(this.numChildren>0)throw Error("FixedSizeListBuilder can only have one child.");let tf=this.children.push(T);return this.type=new De(this.type.listSize,new Y(td,T.type,!0)),tf}},sn=class extends Rt{setValue(T,td){this._values.set(T,td)}},Zs=class extends sn{setValue(T,td){super.setValue(T,ei(td))}},Qs=class extends sn{},to=class extends sn{},on=class extends Rt{};on.prototype._setValue=pa;var Ti=class extends on{};Ti.prototype._setValue=Rs;var xi=class extends on{};xi.prototype._setValue=Ms;var be=class extends Rt{setValue(T,td){this._values.set(T,td)}},eo=class extends be{},ro=class extends be{},no=class extends be{},io=class extends be{},so=class extends be{},oo=class extends be{},ao=class extends be{},co=class extends be{},lo=class extends $e{constructor(T){super(T),this._offsets=new On}addChild(T,td="0"){if(this.numChildren>0)throw Error("ListBuilder can only have one child.");return this.children[this.numChildren]=T,this.type=new Te(new Y(td,T.type,!0)),this.numChildren-1}_flushPending(T){let td=this._offsets,[tf]=this.children;for(let[tb,t_]of T)if(typeof t_>"u")td.set(tb,0);else{let T=t_,tg=T.length,tv=td.set(tb,tg).buffer[tb];for(let td=-1;++td<tg;)tf.set(tv+td,T[td])}}},uo=class extends $e{set(T,td){return super.set(T,td)}setValue(T,td){let tf=td instanceof Map?td:new Map(Object.entries(td)),tb=this._pending||(this._pending=new Map),t_=tb.get(T);t_&&(this._pendingLength-=t_.size),this._pendingLength+=tf.size,tb.set(T,tf)}addChild(T,td="".concat(this.numChildren)){if(this.numChildren>0)throw Error("ListBuilder can only have one child.");return this.children[this.numChildren]=T,this.type=new Ee(new Y(td,T.type,!0),this.type.keysSorted),this.numChildren-1}_flushPending(T){let td=this._offsets,[tf]=this.children;for(let[tb,t_]of T)if(void 0===t_)td.set(tb,0);else{let{[tb]:T,[tb+1]:tg}=td.set(tb,t_.size).buffer;for(let td of t_.entries())if(tf.set(T,td),++T>=tg)break}}},fo=class extends pt{setValue(T,td){}setValid(T,td){return this.length=Math.max(T+1,this.length),td}},ho=class extends pt{setValue(T,td){let{children:tf,type:tb}=this;switch(Array.isArray(td)||td.constructor){case!0:return tb.children.forEach((tb,t_)=>tf[t_].set(T,td[t_]));case Map:return tb.children.forEach((tb,t_)=>tf[t_].set(T,td.get(tb.name)));default:return tb.children.forEach((tb,t_)=>tf[t_].set(T,td[tb.name]))}}setValid(T,td){return super.setValid(T,td)||this.children.forEach(tf=>tf.setValid(T,td)),td}addChild(T,td="".concat(this.numChildren)){let tf=this.children.push(T);return this.type=new ut([...this.type.children,new Y(td,T.type,!0)]),tf}},gr=class extends Rt{};gr.prototype._setValue=da;var Di=class extends gr{};Di.prototype._setValue=Fs;var Ei=class extends gr{};Ei.prototype._setValue=Bs;var Oi=class extends gr{};Oi.prototype._setValue=As;var Ri=class extends gr{};Ri.prototype._setValue=Ts;var wr=class extends Rt{};wr.prototype._setValue=fa;var Mi=class extends wr{};Mi.prototype._setValue=xs;var Ui=class extends wr{};Ui.prototype._setValue=Ds;var Ni=class extends wr{};Ni.prototype._setValue=Es;var Li=class extends wr{};Li.prototype._setValue=Os;var Ln=class extends pt{constructor(T){super(T),this._typeIds=new fr(new Int8Array(0),1),"function"==typeof T.valueToChildTypeId&&(this._valueToChildTypeId=T.valueToChildTypeId)}get typeIdToChildIndex(){return this.type.typeIdToChildIndex}append(T,td){return this.set(this.length,T,td)}set(T,td,tf){return void 0===tf&&(tf=this._valueToChildTypeId(this,td,T)),this.setValid(T,this.isValid(td))&&this.setValue(T,td,tf),this}setValue(T,td,tf){this._typeIds.set(T,tf);let tb=this.type.typeIdToChildIndex[tf],t_=this.children[tb];null==t_||t_.set(T,td)}addChild(T,td="".concat(this.children.length)){let tf=this.children.push(T),{type:{children:tb,mode:t_,typeIds:tg}}=this,tv=[...tb,new Y(td,T.type)];return this.type=new xe(t_,[...tg,tf],tv),tf}_valueToChildTypeId(T,td,tf){throw Error("Cannot map UnionBuilder value to child typeId. Pass the `childTypeId` as the second argument to unionBuilder.append(), or supply a `valueToChildTypeId` function as part of the UnionBuilder constructor options.")}},po=class extends Ln{},mo=class extends Ln{constructor(T){super(T),this._offsets=new fr(new Int32Array(0))}setValue(T,td,tf){let tb=this._typeIds.set(T,tf).buffer[T],t_=this.getChildAt(this.type.typeIdToChildIndex[tb]),tg=this._offsets.set(T,t_.length).buffer[T];null==t_||t_.set(tg,td)}},ki=class extends $e{constructor(T){super(T),this._values=new Er(new Uint8Array(0))}get byteLength(){let T=this._pendingLength+4*this.length;return this._offsets&&(T+=this._offsets.byteLength),this._values&&(T+=this._values.byteLength),this._nulls&&(T+=this._nulls.byteLength),T}setValue(T,td){return super.setValue(T,Br(td))}_flushPending(T,td){}};ki.prototype._flushPending=Nn.prototype._flushPending;var Oa=class extends E{visitNull(){return fo}visitBool(){return Ks}visitInt(){return be}visitInt8(){return eo}visitInt16(){return ro}visitInt32(){return no}visitInt64(){return io}visitUint8(){return so}visitUint16(){return oo}visitUint32(){return ao}visitUint64(){return co}visitFloat(){return sn}visitFloat16(){return Zs}visitFloat32(){return Qs}visitFloat64(){return to}visitUtf8(){return ki}visitBinary(){return Nn}visitFixedSizeBinary(){return Ai}visitDate(){return rn}visitDateDay(){return Ii}visitDateMillisecond(){return Fi}visitTimestamp(){return gr}visitTimestampSecond(){return Di}visitTimestampMillisecond(){return Ei}visitTimestampMicrosecond(){return Oi}visitTimestampNanosecond(){return Ri}visitTime(){return wr}visitTimeSecond(){return Mi}visitTimeMillisecond(){return Ui}visitTimeMicrosecond(){return Ni}visitTimeNanosecond(){return Li}visitDecimal(){return Bi}visitList(){return lo}visitStruct(){return ho}visitUnion(){return Ln}visitDenseUnion(){return mo}visitSparseUnion(){return po}visitDictionary(){return Js}visitInterval(){return on}visitIntervalDayTime(){return Ti}visitIntervalYearMonth(){return xi}visitFixedSizeList(){return qs}visitMap(){return uo}},zl=new Oa,N=class extends E{compareSchemas(T,td){return T===td||td instanceof T.constructor&&this.compareManyFields(T.fields,td.fields)}compareManyFields(T,td){return T===td||Array.isArray(T)&&Array.isArray(td)&&T.length===td.length&&T.every((T,tf)=>this.compareFields(T,td[tf]))}compareFields(T,td){return T===td||td instanceof T.constructor&&T.name===td.name&&T.nullable===td.nullable&&this.visit(T.type,td.type)}};function qt(T,td){return td instanceof T.constructor}function Ci(T,td){return T===td||qt(T,td)}function vr(T,td){return T===td||qt(T,td)&&T.bitWidth===td.bitWidth&&T.isSigned===td.isSigned}function yo(T,td){return T===td||qt(T,td)&&T.precision===td.precision}function dm(T,td){return T===td||qt(T,td)&&T.byteWidth===td.byteWidth}function Ra(T,td){return T===td||qt(T,td)&&T.unit===td.unit}function Pi(T,td){return T===td||qt(T,td)&&T.unit===td.unit&&T.timezone===td.timezone}function Vi(T,td){return T===td||qt(T,td)&&T.unit===td.unit&&T.bitWidth===td.bitWidth}function fm(T,td){return T===td||qt(T,td)&&T.children.length===td.children.length&&qe.compareManyFields(T.children,td.children)}function hm(T,td){return T===td||qt(T,td)&&T.children.length===td.children.length&&qe.compareManyFields(T.children,td.children)}function Ma(T,td){return T===td||qt(T,td)&&T.mode===td.mode&&T.typeIds.every((T,tf)=>T===td.typeIds[tf])&&qe.compareManyFields(T.children,td.children)}function pm(T,td){return T===td||qt(T,td)&&T.id===td.id&&T.isOrdered===td.isOrdered&&qe.visit(T.indices,td.indices)&&qe.visit(T.dictionary,td.dictionary)}function Ua(T,td){return T===td||qt(T,td)&&T.unit===td.unit}function mm(T,td){return T===td||qt(T,td)&&T.listSize===td.listSize&&T.children.length===td.children.length&&qe.compareManyFields(T.children,td.children)}function ym(T,td){return T===td||qt(T,td)&&T.keysSorted===td.keysSorted&&T.children.length===td.children.length&&qe.compareManyFields(T.children,td.children)}N.prototype.visitNull=Ci,N.prototype.visitBool=Ci,N.prototype.visitInt=vr,N.prototype.visitInt8=vr,N.prototype.visitInt16=vr,N.prototype.visitInt32=vr,N.prototype.visitInt64=vr,N.prototype.visitUint8=vr,N.prototype.visitUint16=vr,N.prototype.visitUint32=vr,N.prototype.visitUint64=vr,N.prototype.visitFloat=yo,N.prototype.visitFloat16=yo,N.prototype.visitFloat32=yo,N.prototype.visitFloat64=yo,N.prototype.visitUtf8=Ci,N.prototype.visitBinary=Ci,N.prototype.visitFixedSizeBinary=dm,N.prototype.visitDate=Ra,N.prototype.visitDateDay=Ra,N.prototype.visitDateMillisecond=Ra,N.prototype.visitTimestamp=Pi,N.prototype.visitTimestampSecond=Pi,N.prototype.visitTimestampMillisecond=Pi,N.prototype.visitTimestampMicrosecond=Pi,N.prototype.visitTimestampNanosecond=Pi,N.prototype.visitTime=Vi,N.prototype.visitTimeSecond=Vi,N.prototype.visitTimeMillisecond=Vi,N.prototype.visitTimeMicrosecond=Vi,N.prototype.visitTimeNanosecond=Vi,N.prototype.visitDecimal=Ci,N.prototype.visitList=fm,N.prototype.visitStruct=hm,N.prototype.visitUnion=Ma,N.prototype.visitDenseUnion=Ma,N.prototype.visitSparseUnion=Ma,N.prototype.visitDictionary=pm,N.prototype.visitInterval=Ua,N.prototype.visitIntervalDayTime=Ua,N.prototype.visitIntervalYearMonth=Ua,N.prototype.visitFixedSizeList=mm,N.prototype.visitMap=ym;var qe=new N;function an(T,td){return qe.compareSchemas(T,td)}function jl(T,td){return qe.compareFields(T,td)}function Wl(T,td){return qe.visit(T,td)}function nn(T){let td=T.type,tf=new(zl.getVisitFn(td)())(T);if(td.children&&td.children.length>0){let tb=T.children||[],t_={nullValues:T.nullValues},tg=Array.isArray(tb)?(T,td)=>tb[td]||t_:({name:T})=>tb[T]||t_;for(let[T,tb]of td.children.entries()){let{type:td}=tb,t_=tg(tb,T);tf.children.push(nn(Object.assign(Object.assign({},t_),{type:td})))}}return tf}function _o(T,td){return _m(T,td.map(T=>T.data.concat()))}function _m(T,td){let tf=[...T.fields],tb=[],t_={numBatches:td.reduce((T,td)=>Math.max(T,td.length),0)},tg=0,tv=0,tw=-1,tI=td.length,tS,tA=[];for(;t_.numBatches-- >0;){for(tv=Number.POSITIVE_INFINITY,tw=-1;++tw<tI;)tA[tw]=tS=td[tw].shift(),tv=Math.min(tv,tS?tS.length:tv);Number.isFinite(tv)&&(tA=bm(tf,tv,tA,td,t_),tv>0&&(tb[tg++]=P({type:new ut(tf),length:tv,nullCount:0,children:tA.slice()})))}return[T=T.assign(tf),tb.map(td=>new gt(T,td))]}function bm(T,td,tf,tb,t_){var tg;let tv=(td+63&-64)>>3;for(let tw=-1,tI=tb.length;++tw<tI;){let tI=tf[tw],tS=null==tI?void 0:tI.length;if(tS>=td)tS===td?tf[tw]=tI:(tf[tw]=tI.slice(0,td),t_.numBatches=Math.max(t_.numBatches,tb[tw].unshift(tI.slice(td,tS-td))));else{let tb=T[tw];T[tw]=tb.clone({nullable:!0}),tf[tw]=null!==(tg=null==tI?void 0:tI._changeLengthAndBackfillNullBitmap(td))&&void 0!==tg?tg:P({type:tb.type,length:td,nullCount:td,nullBitmap:new Uint8Array(tv)})}}return tf}var oi,Or,Rr,ai,ui,Ur,di,fi,yi,mt,$l,$t=class r{constructor(...T){var td,tf;let tb,t_;if(0===T.length)return this.batches=[],this.schema=new nt([]),this._offsets=[0],this;T[0]instanceof nt&&(tb=T.shift()),T.at(-1) instanceof Uint32Array&&(t_=T.pop());let tg=T=>{if(T){if(T instanceof gt)return[T];if(T instanceof r)return T.batches;if(T instanceof at){if(T.type instanceof ut)return[new gt(new nt(T.type.children),T)]}else{if(Array.isArray(T))return T.flatMap(T=>tg(T));if("function"==typeof T[Symbol.iterator])return[...T].flatMap(T=>tg(T));if("object"==typeof T){let td=Object.keys(T),tf=td.map(td=>new J([T[td]])),[,tb]=_o(new nt(td.map((T,td)=>new Y(String(T),tf[td].type))),tf);return 0===tb.length?[new gt(T)]:tb}}}return[]},tv=T.flatMap(T=>tg(T));if(!((tb=null!==(tf=null!=tb?tb:null===(td=tv[0])||void 0===td?void 0:td.schema)&&void 0!==tf?tf:new nt([]))instanceof nt))throw TypeError("Table constructor expects a [Schema, RecordBatch[]] pair.");for(let T of tv){if(!(T instanceof gt))throw TypeError("Table constructor expects a [Schema, RecordBatch[]] pair.");if(!an(tb,T.schema))throw TypeError("Table and inner RecordBatch schemas must be equivalent.")}this.schema=tb,this.batches=tv,this._offsets=null!=t_?t_:Cs(this.data)}get data(){return this.batches.map(({data:T})=>T)}get numCols(){return this.schema.fields.length}get numRows(){return this.data.reduce((T,td)=>T+td.length,0)}get nullCount(){return -1===this._nullCount&&(this._nullCount=ks(this.data)),this._nullCount}isValid(T){return!1}get(T){return null}set(T,td){}indexOf(T,td){return -1}getByteLength(T){return 0}[Symbol.iterator](){return this.batches.length>0?Dn.visit(new J(this.data)):[][Symbol.iterator]()}toArray(){return[...this]}toString(){return"[\n  ".concat(this.toArray().join(",\n  "),"\n]")}concat(...T){let td=this.schema;return new r(td,this.data.concat(T.flatMap(({data:T})=>T)).map(T=>new gt(td,T)))}slice(T,td){let tf=this.schema;return[T,td]=ri({length:this.numRows},T,td),new r(tf,Ps(this.data,this._offsets,T,td).map(T=>new gt(tf,T)))}getChild(T){return this.getChildAt(this.schema.fields.findIndex(td=>td.name===T))}getChildAt(T){if(T>-1&&T<this.schema.fields.length){let td=this.data.map(td=>td.children[T]);if(0===td.length){let{type:tf}=this.schema.fields[T],tb=P({type:tf,length:0,nullCount:0});td.push(tb._changeLengthAndBackfillNullBitmap(this.numRows))}return new J(td)}return null}setChild(T,td){var tf;return this.setChildAt(null===(tf=this.schema.fields)||void 0===tf?void 0:tf.findIndex(td=>td.name===T),td)}setChildAt(T,td){let tf=this.schema,tb=[...this.batches];if(T>-1&&T<this.numCols){td||(td=new J([P({type:new Wt,length:this.numRows})]));let t_=tf.fields.slice(),tg=t_[T].clone({type:td.type}),tv=this.schema.fields.map((T,td)=>this.getChildAt(td));[t_[T],tv[T]]=[tg,td],[tf,tb]=_o(tf,tv)}return new r(tf,tb)}select(T){let td=this.schema.fields.reduce((T,td,tf)=>T.set(td.name,tf),new Map);return this.selectAt(T.map(T=>td.get(T)).filter(T=>T>-1))}selectAt(T){return new r(this.schema.selectAt(T),this.batches.map(td=>td.selectAt(T)))}assign(T){let td=this.schema.fields,[tf,tb]=T.schema.fields.reduce((T,tf,tb)=>{let[t_,tg]=T,tv=td.findIndex(T=>T.name===tf.name);return~tv?tg[tv]=tb:t_.push(tb),T},[[],[]]);return new r(..._o(this.schema.assign(T.schema),[...td.map((T,td)=>[td,tb[td]]).map(([td,tf])=>void 0===tf?this.getChildAt(td):T.getChildAt(tf)),...tf.map(td=>T.getChildAt(td))].filter(Boolean)))}};$l=Symbol.toStringTag,$t[$l]=(r=$t.prototype,r.schema=null,r.batches=[],r._offsets=new Uint32Array([0]),r._nullCount=-1,r[Symbol.isConcatSpreadable]=!0,r.isValid=Dr(si),r.get=Dr(Bt.getVisitFn(h.Struct)),r.set=Vs(Lt.getVisitFn(h.Struct)),r.indexOf=Hs(Zr.getVisitFn(h.Struct)),r.getByteLength=Dr(oe.getVisitFn(h.Struct)),"Table");var r,Xl,gt=class r{constructor(...T){switch(T.length){case 2:if([this.schema]=T,!(this.schema instanceof nt)||([,this.data=P({nullCount:0,type:new ut(this.schema.fields),children:this.schema.fields.map(T=>P({type:T.type,nullCount:0}))})]=T,!(this.data instanceof at)))throw TypeError("RecordBatch constructor expects a [Schema, Data] pair.");[this.schema,this.data]=Yl(this.schema,this.data.children);break;case 1:{let[td]=T,{fields:tf,children:tb,length:t_}=Object.keys(td).reduce((T,tf,tb)=>(T.children[tb]=td[tf],T.length=Math.max(T.length,td[tf].length),T.fields[tb]=Y.new({name:tf,type:td[tf].type,nullable:!0}),T),{length:0,fields:[],children:[]}),tg=new nt(tf),tv=P({type:new ut(tf),length:t_,children:tb,nullCount:0});[this.schema,this.data]=Yl(tg,tv.children,t_);break}default:throw TypeError("RecordBatch constructor expects an Object mapping names to child Data, or a [Schema, Data] pair.")}}get dictionaries(){return this._dictionaries||(this._dictionaries=Gl(this.schema.fields,this.data.children))}get numCols(){return this.schema.fields.length}get numRows(){return this.data.length}get nullCount(){return this.data.nullCount}isValid(T){return this.data.getValid(T)}get(T){return Bt.visit(this.data,T)}set(T,td){return Lt.visit(this.data,T,td)}indexOf(T,td){return Zr.visit(this.data,T,td)}getByteLength(T){return oe.visit(this.data,T)}[Symbol.iterator](){return Dn.visit(new J([this.data]))}toArray(){return[...this]}concat(...T){return new $t(this.schema,[this,...T])}slice(T,td){let[tf]=new J([this.data]).slice(T,td).data;return new r(this.schema,tf)}getChild(T){var td;return this.getChildAt(null===(td=this.schema.fields)||void 0===td?void 0:td.findIndex(td=>td.name===T))}getChildAt(T){return T>-1&&T<this.schema.fields.length?new J([this.data.children[T]]):null}setChild(T,td){var tf;return this.setChildAt(null===(tf=this.schema.fields)||void 0===tf?void 0:tf.findIndex(td=>td.name===T),td)}setChildAt(T,td){let tf=this.schema,tb=this.data;if(T>-1&&T<this.numCols){td||(td=new J([P({type:new Wt,length:this.numRows})]));let t_=tf.fields.slice(),tg=tb.children.slice(),tv=t_[T].clone({type:td.type});[t_[T],tg[T]]=[tv,td.data[0]],tf=new nt(t_,new Map(this.schema.metadata)),tb=P({type:new ut(t_),children:tg})}return new r(tf,tb)}select(T){let td=this.schema.select(T),tf=new ut(td.fields),tb=[];for(let td of T){let T=this.schema.fields.findIndex(T=>T.name===td);~T&&(tb[T]=this.data.children[T])}return new r(td,P({type:tf,length:this.numRows,children:tb}))}selectAt(T){let td=this.schema.selectAt(T),tf=T.map(T=>this.data.children[T]).filter(Boolean),tb=P({type:new ut(td.fields),length:this.numRows,children:tf});return new r(td,tb)}};function Yl(T,td,tf=td.reduce((T,td)=>Math.max(T,td.length),0)){var tb;let t_=[...T.fields],tg=[...td],tv=(tf+63&-64)>>3;for(let[tw,tI]of T.fields.entries()){let T=td[tw];T&&T.length===tf||(t_[tw]=tI.clone({nullable:!0}),tg[tw]=null!==(tb=null==T?void 0:T._changeLengthAndBackfillNullBitmap(tf))&&void 0!==tb?tb:P({type:tI.type,length:tf,nullCount:tf,nullBitmap:new Uint8Array(tv)}))}return[T.assign(t_),P({type:new ut(t_),length:tf,children:tg})]}function Gl(T,td,tf=new Map){for(let tb=-1,t_=T.length;++tb<t_;){let t_=T[tb].type,tg=td[tb];if(D.isDictionary(t_)){if(tf.has(t_.id)){if(tf.get(t_.id)!==tg.dictionary)throw Error("Cannot create Schema containing two different dictionaries with the same Id")}else tg.dictionary&&tf.set(t_.id,tg.dictionary)}t_.children&&t_.children.length>0&&Gl(t_.children,tg.children,tf)}return tf}Xl=Symbol.toStringTag,gt[Xl]=(r=gt.prototype,r._nullCount=-1,r[Symbol.isConcatSpreadable]=!0,"RecordBatch");var cn=class extends gt{constructor(T){super(T,P({type:new ut(T.fields),nullCount:0,children:T.fields.map(T=>P({type:T.type}))}))}};!function(T){T[T.BUFFER=0]="BUFFER"}(Hi||(Hi={})),function(T){T[T.LZ4_FRAME=0]="LZ4_FRAME",T[T.ZSTD=1]="ZSTD"}(zi||(zi={}));var bo=class r{constructor(){this.bb=null,this.bb_pos=0}__init(T,td){return this.bb_pos=T,this.bb=td,this}static getRootAsBodyCompression(T,td){return(td||new r).__init(T.readInt32(T.position())+T.position(),T)}static getSizePrefixedRootAsBodyCompression(T,td){return T.setPosition(T.position()+4),(td||new r).__init(T.readInt32(T.position())+T.position(),T)}codec(){let T=this.bb.__offset(this.bb_pos,4);return T?this.bb.readInt8(this.bb_pos+T):zi.LZ4_FRAME}method(){let T=this.bb.__offset(this.bb_pos,6);return T?this.bb.readInt8(this.bb_pos+T):Hi.BUFFER}static startBodyCompression(T){T.startObject(2)}static addCodec(T,td){T.addFieldInt8(0,td,zi.LZ4_FRAME)}static addMethod(T,td){T.addFieldInt8(1,td,Hi.BUFFER)}static endBodyCompression(T){return T.endObject()}static createBodyCompression(T,td,tf){return r.startBodyCompression(T),r.addCodec(T,td),r.addMethod(T,tf),r.endBodyCompression(T)}},kn=class{constructor(){this.bb=null,this.bb_pos=0}__init(T,td){return this.bb_pos=T,this.bb=td,this}offset(){return this.bb.readInt64(this.bb_pos)}length(){return this.bb.readInt64(this.bb_pos+8)}static sizeOf(){return 16}static createBuffer(T,td,tf){return T.prep(8,16),T.writeInt64(BigInt(null!=tf?tf:0)),T.writeInt64(BigInt(null!=td?td:0)),T.offset()}},Cn=class{constructor(){this.bb=null,this.bb_pos=0}__init(T,td){return this.bb_pos=T,this.bb=td,this}length(){return this.bb.readInt64(this.bb_pos)}nullCount(){return this.bb.readInt64(this.bb_pos+8)}static sizeOf(){return 16}static createFieldNode(T,td,tf){return T.prep(8,16),T.writeInt64(BigInt(null!=tf?tf:0)),T.writeInt64(BigInt(null!=td?td:0)),T.offset()}},le=class r{constructor(){this.bb=null,this.bb_pos=0}__init(T,td){return this.bb_pos=T,this.bb=td,this}static getRootAsRecordBatch(T,td){return(td||new r).__init(T.readInt32(T.position())+T.position(),T)}static getSizePrefixedRootAsRecordBatch(T,td){return T.setPosition(T.position()+4),(td||new r).__init(T.readInt32(T.position())+T.position(),T)}length(){let T=this.bb.__offset(this.bb_pos,4);return T?this.bb.readInt64(this.bb_pos+T):BigInt("0")}nodes(T,td){let tf=this.bb.__offset(this.bb_pos,6);return tf?(td||new Cn).__init(this.bb.__vector(this.bb_pos+tf)+16*T,this.bb):null}nodesLength(){let T=this.bb.__offset(this.bb_pos,6);return T?this.bb.__vector_len(this.bb_pos+T):0}buffers(T,td){let tf=this.bb.__offset(this.bb_pos,8);return tf?(td||new kn).__init(this.bb.__vector(this.bb_pos+tf)+16*T,this.bb):null}buffersLength(){let T=this.bb.__offset(this.bb_pos,8);return T?this.bb.__vector_len(this.bb_pos+T):0}compression(T){let td=this.bb.__offset(this.bb_pos,10);return td?(T||new bo).__init(this.bb.__indirect(this.bb_pos+td),this.bb):null}static startRecordBatch(T){T.startObject(4)}static addLength(T,td){T.addFieldInt64(0,td,BigInt("0"))}static addNodes(T,td){T.addFieldOffset(1,td,0)}static startNodesVector(T,td){T.startVector(16,td,8)}static addBuffers(T,td){T.addFieldOffset(2,td,0)}static startBuffersVector(T,td){T.startVector(16,td,8)}static addCompression(T,td){T.addFieldOffset(3,td,0)}static endRecordBatch(T){return T.endObject()}},Sr=class r{constructor(){this.bb=null,this.bb_pos=0}__init(T,td){return this.bb_pos=T,this.bb=td,this}static getRootAsDictionaryBatch(T,td){return(td||new r).__init(T.readInt32(T.position())+T.position(),T)}static getSizePrefixedRootAsDictionaryBatch(T,td){return T.setPosition(T.position()+4),(td||new r).__init(T.readInt32(T.position())+T.position(),T)}id(){let T=this.bb.__offset(this.bb_pos,4);return T?this.bb.readInt64(this.bb_pos+T):BigInt("0")}data(T){let td=this.bb.__offset(this.bb_pos,6);return td?(T||new le).__init(this.bb.__indirect(this.bb_pos+td),this.bb):null}isDelta(){let T=this.bb.__offset(this.bb_pos,8);return!!T&&!!this.bb.readInt8(this.bb_pos+T)}static startDictionaryBatch(T){T.startObject(3)}static addId(T,td){T.addFieldInt64(0,td,BigInt("0"))}static addData(T,td){T.addFieldOffset(1,td,0)}static addIsDelta(T,td){T.addFieldInt8(2,+td,0)}static endDictionaryBatch(T){return T.endObject()}};!function(T){T[T.NONE=0]="NONE",T[T.Schema=1]="Schema",T[T.DictionaryBatch=2]="DictionaryBatch",T[T.RecordBatch=3]="RecordBatch",T[T.Tensor=4]="Tensor",T[T.SparseTensor=5]="SparseTensor"}(Pn||(Pn={}));var Ne=class r{constructor(){this.bb=null,this.bb_pos=0}__init(T,td){return this.bb_pos=T,this.bb=td,this}static getRootAsMessage(T,td){return(td||new r).__init(T.readInt32(T.position())+T.position(),T)}static getSizePrefixedRootAsMessage(T,td){return T.setPosition(T.position()+4),(td||new r).__init(T.readInt32(T.position())+T.position(),T)}version(){let T=this.bb.__offset(this.bb_pos,4);return T?this.bb.readInt16(this.bb_pos+T):Or.V1}headerType(){let T=this.bb.__offset(this.bb_pos,6);return T?this.bb.readUint8(this.bb_pos+T):Pn.NONE}header(T){let td=this.bb.__offset(this.bb_pos,8);return td?this.bb.__union(T,this.bb_pos+td):null}bodyLength(){let T=this.bb.__offset(this.bb_pos,10);return T?this.bb.readInt64(this.bb_pos+T):BigInt("0")}customMetadata(T,td){let tf=this.bb.__offset(this.bb_pos,12);return tf?(td||new Et).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+tf)+4*T),this.bb):null}customMetadataLength(){let T=this.bb.__offset(this.bb_pos,12);return T?this.bb.__vector_len(this.bb_pos+T):0}static startMessage(T){T.startObject(5)}static addVersion(T,td){T.addFieldInt16(0,td,Or.V1)}static addHeaderType(T,td){T.addFieldInt8(1,td,Pn.NONE)}static addHeader(T,td){T.addFieldOffset(2,td,0)}static addBodyLength(T,td){T.addFieldInt64(3,td,BigInt("0"))}static addCustomMetadata(T,td){T.addFieldOffset(4,td,0)}static createCustomMetadataVector(T,td){T.startVector(4,td.length,4);for(let tf=td.length-1;tf>=0;tf--)T.addOffset(td[tf]);return T.endVector()}static startCustomMetadataVector(T,td){T.startVector(4,td,4)}static endMessage(T){return T.endObject()}static finishMessageBuffer(T,td){T.finish(td)}static finishSizePrefixedMessageBuffer(T,td){T.finish(td,void 0,!0)}static createMessage(T,td,tf,tb,t_,tg){return r.startMessage(T),r.addVersion(T,td),r.addHeaderType(T,tf),r.addHeader(T,tb),r.addBodyLength(T,t_),r.addCustomMetadata(T,tg),r.endMessage(T)}},Na=class extends E{visit(T,td){return null==T||null==td?void 0:super.visit(T,td)}visitNull(T,td){return pi.startNull(td),pi.endNull(td)}visitInt(T,td){return Me.startInt(td),Me.addBitWidth(td,T.bitWidth),Me.addIsSigned(td,T.isSigned),Me.endInt(td)}visitFloat(T,td){return kr.startFloatingPoint(td),kr.addPrecision(td,T.precision),kr.endFloatingPoint(td)}visitBinary(T,td){return ci.startBinary(td),ci.endBinary(td)}visitBool(T,td){return li.startBool(td),li.endBool(td)}visitUtf8(T,td){return _i.startUtf8(td),_i.endUtf8(td)}visitDecimal(T,td){return Ge.startDecimal(td),Ge.addScale(td,T.scale),Ge.addPrecision(td,T.precision),Ge.addBitWidth(td,T.bitWidth),Ge.endDecimal(td)}visitDate(T,td){return Mr.startDate(td),Mr.addUnit(td,T.unit),Mr.endDate(td)}visitTime(T,td){return hr.startTime(td),hr.addUnit(td,T.unit),hr.addBitWidth(td,T.bitWidth),hr.endTime(td)}visitTimestamp(T,td){let tf=T.timezone&&td.createString(T.timezone)||void 0;return pr.startTimestamp(td),pr.addUnit(td,T.unit),void 0!==tf&&pr.addTimezone(td,tf),pr.endTimestamp(td)}visitInterval(T,td){return Cr.startInterval(td),Cr.addUnit(td,T.unit),Cr.endInterval(td)}visitList(T,td){return hi.startList(td),hi.endList(td)}visitStruct(T,td){return mi.startStruct_(td),mi.endStruct_(td)}visitUnion(T,td){Ue.startTypeIdsVector(td,T.typeIds.length);let tf=Ue.createTypeIdsVector(td,T.typeIds);return Ue.startUnion(td),Ue.addMode(td,T.mode),Ue.addTypeIds(td,tf),Ue.endUnion(td)}visitDictionary(T,td){let tf=this.visit(T.indices,td);return Xe.startDictionaryEncoding(td),Xe.addId(td,BigInt(T.id)),Xe.addIsOrdered(td,T.isOrdered),void 0!==tf&&Xe.addIndexType(td,tf),Xe.endDictionaryEncoding(td)}visitFixedSizeBinary(T,td){return Nr.startFixedSizeBinary(td),Nr.addByteWidth(td,T.byteWidth),Nr.endFixedSizeBinary(td)}visitFixedSizeList(T,td){return Lr.startFixedSizeList(td),Lr.addListSize(td,T.listSize),Lr.endFixedSizeList(td)}visitMap(T,td){return Pr.startMap(td),Pr.addKeysSorted(td,T.keysSorted),Pr.endMap(td)}},go=new Na;function Zl(T,td=new Map){return new nt(wm(T,td),wo(T.customMetadata),td)}function La(T){return new kt(T.count,tu(T.columns),eu(T.columns))}function Ql(T){return new Qt(La(T.data),T.id,T.isDelta)}function wm(T,td){return(T.fields||[]).filter(Boolean).map(T=>Y.fromJSON(T,td))}function Kl(T,td){return(T.children||[]).filter(Boolean).map(T=>Y.fromJSON(T,td))}function tu(T){return(T||[]).reduce((T,td)=>[...T,new Le(td.count,vm(td.VALIDITY)),...tu(td.children)],[])}function eu(T,td=[]){for(let tf=-1,tb=(T||[]).length;++tf<tb;){let tb=T[tf];tb.VALIDITY&&td.push(new Zt(td.length,tb.VALIDITY.length)),tb.TYPE&&td.push(new Zt(td.length,tb.TYPE.length)),tb.OFFSET&&td.push(new Zt(td.length,tb.OFFSET.length)),tb.DATA&&td.push(new Zt(td.length,tb.DATA.length)),td=eu(tb.children,td)}return td}function vm(T){return(T||[]).reduce((T,td)=>T+ +(0===td),0)}function ru(T,td){let tf,tb,t_,tg,tv,tw;return td&&(tg=T.dictionary)?(td.has(tf=tg.id)?(tb=(tb=tg.indexType)?Jl(tb):new ze,tw=new ie(td.get(tf),tb,tf,tg.isOrdered)):(tb=(tb=tg.indexType)?Jl(tb):new ze,td.set(tf,tv=ql(T,Kl(T,td))),tw=new ie(tv,tb,tf,tg.isOrdered)),t_=new Y(T.name,tw,T.nullable,wo(T.customMetadata))):(tv=ql(T,Kl(T,td)),t_=new Y(T.name,tv,T.nullable,wo(T.customMetadata))),t_||null}function wo(T){return new Map(Object.entries(T||{}))}function Jl(T){return new St(T.isSigned,T.bitWidth)}function ql(T,td){let tf=T.type.name;switch(tf){case"NONE":case"null":return new Wt;case"binary":return new nr;case"utf8":return new ir;case"bool":return new sr;case"list":return new Te((td||[])[0]);case"struct":case"struct_":return new ut(td||[])}switch(tf){case"int":{let td=T.type;return new St(td.isSigned,td.bitWidth)}case"floatingpoint":return new Kt(ht[T.type.precision]);case"decimal":{let td=T.type;return new or(td.scale,td.precision,td.bitWidth)}case"date":return new ar(Nt[T.type.unit]);case"time":{let td=T.type;return new Ae(G[td.unit],td.bitWidth)}case"timestamp":{let td=T.type;return new cr(G[td.unit],td.timezone)}case"interval":return new lr(jt[T.type.unit]);case"union":{let tf=T.type;return new xe(yt[tf.mode],tf.typeIds||[],td||[])}case"fixedsizebinary":return new ur(T.type.byteWidth);case"fixedsizelist":return new De(T.type.listSize,(td||[])[0]);case"map":{let tf=T.type;return new Ee((td||[])[0],tf.keysSorted)}}throw Error('Unrecognized type: "'.concat(tf,'"'))}var Sm=tn,Im=ae,te=class r{static fromJSON(T,td){let tf=new r(0,Ot.V4,td);return tf._createHeader=Fm(T,td),tf}static decode(T){T=new Im(L(T));let td=Ne.getRootAsMessage(T),tf=td.bodyLength(),tb=td.version(),t_=td.headerType(),tg=new r(tf,tb,t_);return tg._createHeader=Bm(td,t_),tg}static encode(T){let td=new Sm,tf=-1;return T.isSchema()?tf=nt.encode(td,T.header()):T.isRecordBatch()?tf=kt.encode(td,T.header()):T.isDictionaryBatch()&&(tf=Qt.encode(td,T.header())),Ne.startMessage(td),Ne.addVersion(td,Ot.V4),Ne.addHeader(td,tf),Ne.addHeaderType(td,T.headerType),Ne.addBodyLength(td,BigInt(T.bodyLength)),Ne.finishMessageBuffer(td,Ne.endMessage(td)),td.asUint8Array()}static from(T,td=0){if(T instanceof nt)return new r(0,Ot.V4,tt.Schema,T);if(T instanceof kt)return new r(td,Ot.V4,tt.RecordBatch,T);if(T instanceof Qt)return new r(td,Ot.V4,tt.DictionaryBatch,T);throw Error("Unrecognized Message header: ".concat(T))}get type(){return this.headerType}get version(){return this._version}get headerType(){return this._headerType}get bodyLength(){return this._bodyLength}header(){return this._createHeader()}isSchema(){return this.headerType===tt.Schema}isRecordBatch(){return this.headerType===tt.RecordBatch}isDictionaryBatch(){return this.headerType===tt.DictionaryBatch}constructor(T,td,tf,tb){this._version=td,this._headerType=tf,this.body=new Uint8Array(0),tb&&(this._createHeader=()=>tb),this._bodyLength=Gt(T)}},kt=class{get nodes(){return this._nodes}get length(){return this._length}get buffers(){return this._buffers}constructor(T,td,tf){this._nodes=td,this._buffers=tf,this._length=Gt(T)}},Qt=class{get id(){return this._id}get data(){return this._data}get isDelta(){return this._isDelta}get length(){return this.data.length}get nodes(){return this.data.nodes}get buffers(){return this.data.buffers}constructor(T,td,tf=!1){this._data=T,this._isDelta=tf,this._id=Gt(td)}},Zt=class{constructor(T,td){this.offset=Gt(T),this.length=Gt(td)}},Le=class{constructor(T,td){this.length=Gt(T),this.nullCount=Gt(td)}};function Fm(T,td){return()=>{switch(td){case tt.Schema:return nt.fromJSON(T);case tt.RecordBatch:return kt.fromJSON(T);case tt.DictionaryBatch:return Qt.fromJSON(T)}throw Error("Unrecognized Message type: { name: ".concat(tt[td],", type: ").concat(td," }"))}}function Bm(T,td){return()=>{switch(td){case tt.Schema:return nt.decode(T.header(new Jt));case tt.RecordBatch:return kt.decode(T.header(new le),T.version());case tt.DictionaryBatch:return Qt.decode(T.header(new Sr),T.version())}throw Error("Unrecognized Message type: { name: ".concat(tt[td],", type: ").concat(td," }"))}}function Am(T,td=new Map){return new nt(Mm(T,td),vo(T),td)}function Tm(T,td=Ot.V4){if(null!==T.compression())throw Error("Record batch compression not implemented");return new kt(T.length(),Om(T),Rm(T,td))}function xm(T,td=Ot.V4){return new Qt(kt.decode(T.data(),td),T.id(),T.isDelta())}function Dm(T){return new Zt(T.offset(),T.length())}function Em(T){return new Le(T.length(),T.nullCount())}function Om(T){let td=[];for(let tf,tb=-1,t_=-1,tg=T.nodesLength();++tb<tg;)(tf=T.nodes(tb))&&(td[++t_]=Le.decode(tf));return td}function Rm(T,td){let tf=[];for(let tb,t_=-1,tg=-1,tv=T.buffersLength();++t_<tv;)(tb=T.buffers(t_))&&(td<Ot.V4&&(tb.bb_pos+=8*(t_+1)),tf[++tg]=Zt.decode(tb));return tf}function Mm(T,td){let tf=[];for(let tb,t_=-1,tg=-1,tv=T.fieldsLength();++t_<tv;)(tb=T.fields(t_))&&(tf[++tg]=Y.decode(tb,td));return tf}function nu(T,td){let tf=[];for(let tb,t_=-1,tg=-1,tv=T.childrenLength();++t_<tv;)(tb=T.children(t_))&&(tf[++tg]=Y.decode(tb,td));return tf}function Um(T,td){let tf,tb,t_,tg,tv,tw;return td&&(tw=T.dictionary())?(td.has(tf=Gt(tw.id()))?(tg=(tg=tw.indexType())?iu(tg):new ze,tv=new ie(td.get(tf),tg,tf,tw.isOrdered())):(tg=(tg=tw.indexType())?iu(tg):new ze,td.set(tf,t_=su(T,nu(T,td))),tv=new ie(t_,tg,tf,tw.isOrdered())),tb=new Y(T.name(),tv,T.nullable(),vo(T))):(t_=su(T,nu(T,td)),tb=new Y(T.name(),t_,T.nullable(),vo(T))),tb||null}function vo(T){let td=new Map;if(T)for(let tf,tb,t_=-1,tg=Math.trunc(T.customMetadataLength());++t_<tg;)(tf=T.customMetadata(t_))&&null!=(tb=tf.key())&&td.set(tb,tf.value());return td}function iu(T){return new St(T.isSigned(),T.bitWidth())}function su(T,td){let tf=T.typeType();switch(tf){case mt.NONE:case mt.Null:return new Wt;case mt.Binary:return new nr;case mt.Utf8:return new ir;case mt.Bool:return new sr;case mt.List:return new Te((td||[])[0]);case mt.Struct_:return new ut(td||[])}switch(tf){case mt.Int:{let td=T.type(new Me);return new St(td.isSigned(),td.bitWidth())}case mt.FloatingPoint:return new Kt(T.type(new kr).precision());case mt.Decimal:{let td=T.type(new Ge);return new or(td.scale(),td.precision(),td.bitWidth())}case mt.Date:return new ar(T.type(new Mr).unit());case mt.Time:{let td=T.type(new hr);return new Ae(td.unit(),td.bitWidth())}case mt.Timestamp:{let td=T.type(new pr);return new cr(td.unit(),td.timezone())}case mt.Interval:return new lr(T.type(new Cr).unit());case mt.Union:{let tf=T.type(new Ue);return new xe(tf.mode(),tf.typeIdsArray()||[],td||[])}case mt.FixedSizeBinary:return new ur(T.type(new Nr).byteWidth());case mt.FixedSizeList:return new De(T.type(new Lr).listSize(),(td||[])[0]);case mt.Map:{let tf=T.type(new Pr);return new Ee((td||[])[0],tf.keysSorted())}}throw Error('Unrecognized type: "'.concat(mt[tf],'" (').concat(tf,")"))}function Nm(T,td){let tf=td.fields.map(td=>Y.encode(T,td));Jt.startFieldsVector(T,tf.length);let tb=Jt.createFieldsVector(T,tf),t_=td.metadata&&td.metadata.size>0?Jt.createCustomMetadataVector(T,[...td.metadata].map(([td,tf])=>{let tb=T.createString("".concat(td)),t_=T.createString("".concat(tf));return Et.startKeyValue(T),Et.addKey(T,tb),Et.addValue(T,t_),Et.endKeyValue(T)})):-1;return Jt.startSchema(T),Jt.addFields(T,tb),Jt.addEndianness(T,Hm?Rr.Little:Rr.Big),-1!==t_&&Jt.addCustomMetadata(T,t_),Jt.endSchema(T)}function Lm(T,td){let tf=-1,tb=-1,t_=-1,tg=td.type,tv=td.typeId;D.isDictionary(tg)?(tv=tg.dictionary.typeId,t_=go.visit(tg,T),tb=go.visit(tg.dictionary,T)):tb=go.visit(tg,T);let tw=(tg.children||[]).map(td=>Y.encode(T,td)),tI=Pt.createChildrenVector(T,tw),tS=td.metadata&&td.metadata.size>0?Pt.createCustomMetadataVector(T,[...td.metadata].map(([td,tf])=>{let tb=T.createString("".concat(td)),t_=T.createString("".concat(tf));return Et.startKeyValue(T),Et.addKey(T,tb),Et.addValue(T,t_),Et.endKeyValue(T)})):-1;return td.name&&(tf=T.createString(td.name)),Pt.startField(T),Pt.addType(T,tb),Pt.addTypeType(T,tv),Pt.addChildren(T,tI),Pt.addNullable(T,!!td.nullable),-1!==tf&&Pt.addName(T,tf),-1!==t_&&Pt.addDictionary(T,t_),-1!==tS&&Pt.addCustomMetadata(T,tS),Pt.endField(T)}function km(T,td){let tf=td.nodes||[],tb=td.buffers||[];for(let td of(le.startNodesVector(T,tf.length),tf.slice().reverse()))Le.encode(T,td);let t_=T.endVector();for(let td of(le.startBuffersVector(T,tb.length),tb.slice().reverse()))Zt.encode(T,td);let tg=T.endVector();return le.startRecordBatch(T),le.addLength(T,BigInt(td.length)),le.addNodes(T,t_),le.addBuffers(T,tg),le.endRecordBatch(T)}function Cm(T,td){let tf=kt.encode(T,td.data);return Sr.startDictionaryBatch(T),Sr.addId(T,BigInt(td.id)),Sr.addIsDelta(T,td.isDelta),Sr.addData(T,tf),Sr.endDictionaryBatch(T)}function Pm(T,td){return Cn.createFieldNode(T,BigInt(td.length),BigInt(td.nullCount))}function Vm(T,td){return kn.createBuffer(T,BigInt(td.offset),BigInt(td.length))}Y.encode=Lm,Y.decode=Um,Y.fromJSON=ru,nt.encode=Nm,nt.decode=Am,nt.fromJSON=Zl,kt.encode=km,kt.decode=Tm,kt.fromJSON=La,Qt.encode=Cm,Qt.decode=xm,Qt.fromJSON=Ql,Le.encode=Pm,Le.decode=Em,Zt.encode=Vm,Zt.decode=Dm;var Hm=(()=>{let T=new ArrayBuffer(2);return new DataView(T).setInt16(0,256,!0),256===new Int16Array(T)[0]})(),Ca=T=>"Expected ".concat(tt[T]," Message in stream, but was null or length 0."),Pa=T=>"Header pointer of flatbuffer-encoded ".concat(tt[T]," Message is null or length 0."),ou=(T,td)=>"Expected to read ".concat(T," metadata bytes, but only read ").concat(td,"."),au=(T,td)=>"Expected to read ".concat(T," bytes for message body, but only read ").concat(td,"."),Vn=class{constructor(T){this.source=T instanceof Je?T:new Je(T)}[Symbol.iterator](){return this}next(){let T;return(T=this.readMetadataLength()).done?dt:-1===T.value&&(T=this.readMetadataLength()).done?dt:(T=this.readMetadata(T.value)).done?dt:T}throw(T){return this.source.throw(T)}return(T){return this.source.return(T)}readMessage(T){let td;if((td=this.next()).done)return null;if(null!=T&&td.value.headerType!==T)throw Error(Ca(T));return td.value}readMessageBody(T){if(T<=0)return new Uint8Array(0);let td=L(this.source.read(T));if(td.byteLength<T)throw Error(au(T,td.byteLength));return td.byteOffset%8==0&&td.byteOffset+td.byteLength<=td.buffer.byteLength?td:td.slice()}readSchema(T=!1){let td=tt.Schema,tf=this.readMessage(td),tb=null==tf?void 0:tf.header();if(T&&!tb)throw Error(Pa(td));return tb}readMetadataLength(){let T=this.source.read(So),td=T&&new ae(T),tf=(null==td?void 0:td.readInt32(0))||0;return{done:0===tf,value:tf}}readMetadata(T){let td=this.source.read(T);if(!td)return dt;if(td.byteLength<T)throw Error(ou(T,td.byteLength));return{done:!1,value:te.decode(td)}}},ji=class{constructor(T,td){this.source=T instanceof _e?T:os(T)?new Vr(T,td):new _e(T)}[Symbol.asyncIterator](){return this}next(){return F(this,void 0,void 0,function*(){let T;return(T=yield this.readMetadataLength()).done?dt:-1===T.value&&(T=yield this.readMetadataLength()).done?dt:(T=yield this.readMetadata(T.value)).done?dt:T})}throw(T){return F(this,void 0,void 0,function*(){return yield this.source.throw(T)})}return(T){return F(this,void 0,void 0,function*(){return yield this.source.return(T)})}readMessage(T){return F(this,void 0,void 0,function*(){let td;if((td=yield this.next()).done)return null;if(null!=T&&td.value.headerType!==T)throw Error(Ca(T));return td.value})}readMessageBody(T){return F(this,void 0,void 0,function*(){if(T<=0)return new Uint8Array(0);let td=L((yield this.source.read(T)));if(td.byteLength<T)throw Error(au(T,td.byteLength));return td.byteOffset%8==0&&td.byteOffset+td.byteLength<=td.buffer.byteLength?td:td.slice()})}readSchema(T=!1){return F(this,void 0,void 0,function*(){let td=tt.Schema,tf=yield this.readMessage(td),tb=null==tf?void 0:tf.header();if(T&&!tb)throw Error(Pa(td));return tb})}readMetadataLength(){return F(this,void 0,void 0,function*(){let T=yield this.source.read(So),td=T&&new ae(T),tf=(null==td?void 0:td.readInt32(0))||0;return{done:0===tf,value:tf}})}readMetadata(T){return F(this,void 0,void 0,function*(){let td=yield this.source.read(T);if(!td)return dt;if(td.byteLength<T)throw Error(ou(T,td.byteLength));return{done:!1,value:te.decode(td)}})}},Wi=class extends Vn{constructor(T){super(new Uint8Array(0)),this._schema=!1,this._body=[],this._batchIndex=0,this._dictionaryIndex=0,this._json=T instanceof bi?T:new bi(T)}next(){let{_json:T}=this;if(!this._schema)return this._schema=!0,{done:!1,value:te.fromJSON(T.schema,tt.Schema)};if(this._dictionaryIndex<T.dictionaries.length){let td=T.dictionaries[this._dictionaryIndex++];return this._body=td.data.columns,{done:!1,value:te.fromJSON(td,tt.DictionaryBatch)}}if(this._batchIndex<T.batches.length){let td=T.batches[this._batchIndex++];return this._body=td.columns,{done:!1,value:te.fromJSON(td,tt.RecordBatch)}}return this._body=[],dt}readMessageBody(T){return td(this._body);function td(T){return(T||[]).reduce((T,tf)=>[...T,...tf.VALIDITY&&[tf.VALIDITY]||[],...tf.TYPE&&[tf.TYPE]||[],...tf.OFFSET&&[tf.OFFSET]||[],...tf.DATA&&[tf.DATA]||[],...td(tf.children)],[])}}readMessage(T){let td;if((td=this.next()).done)return null;if(null!=T&&td.value.headerType!==T)throw Error(Ca(T));return td.value}readSchema(){let T=tt.Schema,td=this.readMessage(T),tf=null==td?void 0:td.header();if(!td||!tf)throw Error(Pa(T));return tf}},So=4,ka="ARROW1",Hn=new Uint8Array(ka.length);for(let r=0;r<ka.length;r+=1)Hn[r]=ka.codePointAt(r);function Io(T,td=0){for(let tf=-1,tb=Hn.length;++tf<tb;)if(Hn[tf]!==T[td+tf])return!1;return!0}var zn=Hn.length,Va=zn+So,cu=2*zn+So,Ct=class r extends en{constructor(T){super(),this._impl=T}get closed(){return this._impl.closed}get schema(){return this._impl.schema}get autoDestroy(){return this._impl.autoDestroy}get dictionaries(){return this._impl.dictionaries}get numDictionaries(){return this._impl.numDictionaries}get numRecordBatches(){return this._impl.numRecordBatches}get footer(){return this._impl.isFile()?this._impl.footer:null}isSync(){return this._impl.isSync()}isAsync(){return this._impl.isAsync()}isFile(){return this._impl.isFile()}isStream(){return this._impl.isStream()}next(){return this._impl.next()}throw(T){return this._impl.throw(T)}return(T){return this._impl.return(T)}cancel(){return this._impl.cancel()}reset(T){return this._impl.reset(T),this._DOMStream=void 0,this._nodeStream=void 0,this}open(T){let td=this._impl.open(T);return Se(td)?td.then(()=>this):this}readRecordBatch(T){return this._impl.isFile()?this._impl.readRecordBatch(T):null}[Symbol.iterator](){return this._impl[Symbol.iterator]()}[Symbol.asyncIterator](){return this._impl[Symbol.asyncIterator]()}toDOMStream(){return Ut.toDOMStream(this.isSync()?{[Symbol.iterator]:()=>this}:{[Symbol.asyncIterator]:()=>this})}toNodeStream(){return Ut.toNodeStream(this.isSync()?{[Symbol.iterator]:()=>this}:{[Symbol.asyncIterator]:()=>this},{objectMode:!0})}static throughNode(T){throw Error('"throughNode" not available in this environment')}static throughDOM(T,td){throw Error('"throughDOM" not available in this environment')}static from(T){return T instanceof r?T:is(T)?jm(T):os(T)?Ym(T):Se(T)?F(this,void 0,void 0,function*(){return yield r.from((yield T))}):as(T)||qn(T)||ls(T)||he(T)?$m(new _e(T)):Wm(new Je(T))}static readAll(T){return T instanceof r?T.isSync()?lu(T):uu(T):is(T)||ArrayBuffer.isView(T)||Ie(T)||ss(T)?lu(T):uu(T)}},Ze=class extends Ct{constructor(T){super(T),this._impl=T}readAll(){return[...this]}[Symbol.iterator](){return this._impl[Symbol.iterator]()}[Symbol.asyncIterator](){return re(this,arguments,function*(){yield C((yield*Gr(gn(ve(this[Symbol.iterator]())))))})}},Hr=class extends Ct{constructor(T){super(T),this._impl=T}readAll(){var T,td,tf,tb;return F(this,void 0,void 0,function*(){let t_=[];try{for(var tg,tv=!0,tw=ve(this);!(T=(tg=yield tw.next()).done);tv=!0){tb=tg.value,tv=!1;let T=tb;t_.push(T)}}catch(T){td={error:T}}finally{try{!tv&&!T&&(tf=tw.return)&&(yield tf.call(tw))}finally{if(td)throw td.error}}return t_})}[Symbol.iterator](){throw Error("AsyncRecordBatchStreamReader is not Iterable")}[Symbol.asyncIterator](){return this._impl[Symbol.asyncIterator]()}},zr=class extends Ze{constructor(T){super(T),this._impl=T}},$i=class extends Hr{constructor(T){super(T),this._impl=T}},Fo=class{get numDictionaries(){return this._dictionaryIndex}get numRecordBatches(){return this._recordBatchIndex}constructor(T=new Map){this.closed=!1,this.autoDestroy=!0,this._dictionaryIndex=0,this._recordBatchIndex=0,this.dictionaries=T}isSync(){return!1}isAsync(){return!1}isFile(){return!1}isStream(){return!1}reset(T){return this._dictionaryIndex=0,this._recordBatchIndex=0,this.schema=T,this.dictionaries=new Map,this}_loadRecordBatch(T,td){let tf=this._loadVectors(T,td,this.schema.fields),tb=P({type:new ut(this.schema.fields),length:T.length,children:tf});return new gt(this.schema,tb)}_loadDictionaryBatch(T,td){let{id:tf,isDelta:tb}=T,{dictionaries:t_,schema:tg}=this,tv=t_.get(tf);if(tb||!tv){let t_=tg.dictionaries.get(tf),tw=this._loadVectors(T.data,td,[t_]);return(tv&&tb?tv.concat(new J(tw)):new J(tw)).memoize()}return tv.memoize()}_loadVectors(T,td,tf){return new Si(td,T.nodes,T.buffers,this.dictionaries).visitMany(tf)}},jn=class extends Fo{constructor(T,td){super(td),this._reader=is(T)?new Wi(this._handle=T):new Vn(this._handle=T)}isSync(){return!0}isStream(){return!0}[Symbol.iterator](){return this}cancel(){!this.closed&&(this.closed=!0)&&(this.reset()._reader.return(),this._reader=null,this.dictionaries=null)}open(T){return this.closed||(this.autoDestroy=du(this,T),this.schema||(this.schema=this._reader.readSchema())||this.cancel()),this}throw(T){return!this.closed&&this.autoDestroy&&(this.closed=!0)?this.reset()._reader.throw(T):dt}return(T){return!this.closed&&this.autoDestroy&&(this.closed=!0)?this.reset()._reader.return(T):dt}next(){if(this.closed)return dt;let T,{_reader:td}=this;for(;T=this._readNextMessageAndValidate();)if(T.isSchema())this.reset(T.header());else if(T.isRecordBatch()){this._recordBatchIndex++;let tf=T.header(),tb=td.readMessageBody(T.bodyLength);return{done:!1,value:this._loadRecordBatch(tf,tb)}}else if(T.isDictionaryBatch()){this._dictionaryIndex++;let tf=T.header(),tb=td.readMessageBody(T.bodyLength),t_=this._loadDictionaryBatch(tf,tb);this.dictionaries.set(tf.id,t_)}return this.schema&&0===this._recordBatchIndex?(this._recordBatchIndex++,{done:!1,value:new cn(this.schema)}):this.return()}_readNextMessageAndValidate(T){return this._reader.readMessage(T)}},Wn=class extends Fo{constructor(T,td){super(td),this._reader=new ji(this._handle=T)}isAsync(){return!0}isStream(){return!0}[Symbol.asyncIterator](){return this}cancel(){return F(this,void 0,void 0,function*(){!this.closed&&(this.closed=!0)&&(yield this.reset()._reader.return(),this._reader=null,this.dictionaries=null)})}open(T){return F(this,void 0,void 0,function*(){return this.closed||(this.autoDestroy=du(this,T),this.schema||(this.schema=yield this._reader.readSchema())||(yield this.cancel())),this})}throw(T){return F(this,void 0,void 0,function*(){return!this.closed&&this.autoDestroy&&(this.closed=!0)?yield this.reset()._reader.throw(T):dt})}return(T){return F(this,void 0,void 0,function*(){return!this.closed&&this.autoDestroy&&(this.closed=!0)?yield this.reset()._reader.return(T):dt})}next(){return F(this,void 0,void 0,function*(){if(this.closed)return dt;let T,{_reader:td}=this;for(;T=yield this._readNextMessageAndValidate();)if(T.isSchema())yield this.reset(T.header());else if(T.isRecordBatch()){this._recordBatchIndex++;let tf=T.header(),tb=yield td.readMessageBody(T.bodyLength);return{done:!1,value:this._loadRecordBatch(tf,tb)}}else if(T.isDictionaryBatch()){this._dictionaryIndex++;let tf=T.header(),tb=yield td.readMessageBody(T.bodyLength),t_=this._loadDictionaryBatch(tf,tb);this.dictionaries.set(tf.id,t_)}return this.schema&&0===this._recordBatchIndex?(this._recordBatchIndex++,{done:!1,value:new cn(this.schema)}):yield this.return()})}_readNextMessageAndValidate(T){return F(this,void 0,void 0,function*(){return yield this._reader.readMessage(T)})}},Bo=class extends jn{get footer(){return this._footer}get numDictionaries(){return this._footer?this._footer.numDictionaries:0}get numRecordBatches(){return this._footer?this._footer.numRecordBatches:0}constructor(T,td){super(T instanceof gi?T:new gi(T),td)}isSync(){return!0}isFile(){return!0}open(T){if(!this.closed&&!this._footer)for(let T of(this.schema=(this._footer=this._readFooter()).schema,this._footer.dictionaryBatches()))T&&this._readDictionaryBatch(this._dictionaryIndex++);return super.open(T)}readRecordBatch(T){var td;if(this.closed)return null;this._footer||this.open();let tf=null===(td=this._footer)||void 0===td?void 0:td.getRecordBatch(T);if(tf&&this._handle.seek(tf.offset)){let T=this._reader.readMessage(tt.RecordBatch);if(null!=T&&T.isRecordBatch()){let td=T.header(),tf=this._reader.readMessageBody(T.bodyLength);return this._loadRecordBatch(td,tf)}}return null}_readDictionaryBatch(T){var td;let tf=null===(td=this._footer)||void 0===td?void 0:td.getDictionaryBatch(T);if(tf&&this._handle.seek(tf.offset)){let T=this._reader.readMessage(tt.DictionaryBatch);if(null!=T&&T.isDictionaryBatch()){let td=T.header(),tf=this._reader.readMessageBody(T.bodyLength),tb=this._loadDictionaryBatch(td,tf);this.dictionaries.set(td.id,tb)}}}_readFooter(){let{_handle:T}=this,td=T.size-Va,tf=T.readInt32(td),tb=T.readAt(td-tf,tf);return mr.decode(tb)}_readNextMessageAndValidate(T){var td;if(this._footer||this.open(),this._footer&&this._recordBatchIndex<this.numRecordBatches){let tf=null===(td=this._footer)||void 0===td?void 0:td.getRecordBatch(this._recordBatchIndex);if(tf&&this._handle.seek(tf.offset))return this._reader.readMessage(T)}return null}},Ha=class extends Wn{get footer(){return this._footer}get numDictionaries(){return this._footer?this._footer.numDictionaries:0}get numRecordBatches(){return this._footer?this._footer.numRecordBatches:0}constructor(T,...td){super(T instanceof Vr?T:new Vr(T,"number"!=typeof td[0]?td.shift():void 0),td[0]instanceof Map?td.shift():void 0)}isFile(){return!0}isAsync(){return!0}open(T){let td=Object.create(null,{open:{get:()=>super.open}});return F(this,void 0,void 0,function*(){if(!this.closed&&!this._footer)for(let T of(this.schema=(this._footer=yield this._readFooter()).schema,this._footer.dictionaryBatches()))T&&(yield this._readDictionaryBatch(this._dictionaryIndex++));return yield td.open.call(this,T)})}readRecordBatch(T){var td;return F(this,void 0,void 0,function*(){if(this.closed)return null;this._footer||(yield this.open());let tf=null===(td=this._footer)||void 0===td?void 0:td.getRecordBatch(T);if(tf&&(yield this._handle.seek(tf.offset))){let T=yield this._reader.readMessage(tt.RecordBatch);if(null!=T&&T.isRecordBatch()){let td=T.header(),tf=yield this._reader.readMessageBody(T.bodyLength);return this._loadRecordBatch(td,tf)}}return null})}_readDictionaryBatch(T){var td;return F(this,void 0,void 0,function*(){let tf=null===(td=this._footer)||void 0===td?void 0:td.getDictionaryBatch(T);if(tf&&(yield this._handle.seek(tf.offset))){let T=yield this._reader.readMessage(tt.DictionaryBatch);if(null!=T&&T.isDictionaryBatch()){let td=T.header(),tf=yield this._reader.readMessageBody(T.bodyLength),tb=this._loadDictionaryBatch(td,tf);this.dictionaries.set(td.id,tb)}}})}_readFooter(){return F(this,void 0,void 0,function*(){let{_handle:T}=this;T._pending&&(yield T._pending);let td=T.size-Va,tf=yield T.readInt32(td),tb=yield T.readAt(td-tf,tf);return mr.decode(tb)})}_readNextMessageAndValidate(T){return F(this,void 0,void 0,function*(){if(this._footer||(yield this.open()),this._footer&&this._recordBatchIndex<this.numRecordBatches){let td=this._footer.getRecordBatch(this._recordBatchIndex);if(td&&(yield this._handle.seek(td.offset)))return yield this._reader.readMessage(T)}return null})}},za=class extends jn{constructor(T,td){super(T,td)}_loadVectors(T,td,tf){return new Gs(td,T.nodes,T.buffers,this.dictionaries).visitMany(tf)}};function du(T,td){return td&&"boolean"==typeof td.autoDestroy?td.autoDestroy:T.autoDestroy}function*lu(T){let td=Ct.from(T);try{if(!td.open({autoDestroy:!1}).closed)do yield td;while(!td.reset().open().closed)}finally{td.cancel()}}function uu(T){return re(this,arguments,function*(){let td=yield C(Ct.from(T));try{if(!(yield C(td.open({autoDestroy:!1}))).closed)do yield yield C(td);while(!(yield C(td.reset().open())).closed)}finally{yield C(td.cancel())}})}function jm(T){return new Ze(new za(T))}function Wm(T){let td=T.peek(zn+7&-8);return td&&td.byteLength>=4?Io(td)?new zr(new Bo(T.read())):new Ze(new jn(T)):new Ze(new jn(function*(){}()))}function $m(T){return F(this,void 0,void 0,function*(){let td=yield T.peek(zn+7&-8);return td&&td.byteLength>=4?Io(td)?new zr(new Bo((yield T.read()))):new Hr(new Wn(T)):new Hr(new Wn(function(){return re(this,arguments,function*(){})}()))})}function Ym(T){return F(this,void 0,void 0,function*(){let{size:td}=yield T.stat(),tf=new Vr(T,td);return td>=cu&&Io((yield tf.readAt(0,zn+7&-8)))?new $i(new Ha(tf)):new Hr(new Wn(tf))})}var It=class r extends E{static assemble(...T){let td=T=>T.flatMap(T=>Array.isArray(T)?td(T):T instanceof gt?T.data.children:T.data),tf=new r;return tf.visitMany(td(T)),tf}constructor(){super(),this._byteLength=0,this._nodes=[],this._buffers=[],this._bufferRegions=[]}visit(T){if(T instanceof J)return this.visitMany(T.data),this;let{type:td}=T;if(!D.isDictionary(td)){let{length:tf,nullCount:tb}=T;if(tf>2147483647)throw RangeError("Cannot write arrays larger than 2^31 - 1 in length");D.isNull(td)||ke.call(this,tb<=0?new Uint8Array(0):xn(T.offset,tf,T.nullBitmap)),this.nodes.push(new Le(tf,tb))}return super.visit(T)}visitNull(T){return this}visitDictionary(T){return this.visit(T.clone(T.type.indices))}get nodes(){return this._nodes}get buffers(){return this._buffers}get byteLength(){return this._byteLength}get bufferRegions(){return this._bufferRegions}};function ke(T){let td=T.byteLength+7&-8;return this.buffers.push(T),this.bufferRegions.push(new Zt(this._byteLength,td)),this._byteLength+=td,this}function Xm(T){let{type:td,length:tf,typeIds:tb,valueOffsets:t_}=T;if(ke.call(this,tb),td.mode===yt.Sparse)return ja.call(this,T);if(td.mode===yt.Dense){if(T.offset<=0)return ke.call(this,t_),ja.call(this,T);{let tg=tb.reduce((T,td)=>Math.max(T,td),tb[0]),tv=new Int32Array(tg+1),tw=new Int32Array(tg+1).fill(-1),tI=new Int32Array(tf),tS=Zn(-t_[0],tf,t_);for(let T,td,t_=-1;++t_<tf;)-1===(td=tw[T=tb[t_]])&&(td=tw[T]=tS[T]),tI[t_]=tS[t_]-td,++tv[T];ke.call(this,tI);for(let tb,t_=-1,tg=td.children.length;++t_<tg;)if(tb=T.children[t_]){let T=td.typeIds[t_],tg=Math.min(tf,tv[T]);this.visit(tb.slice(tw[T],tg))}}}return this}function Gm(T){let td;return T.nullCount>=T.length?ke.call(this,new Uint8Array(0)):(td=T.values)instanceof Uint8Array?ke.call(this,xn(T.offset,T.length,td)):ke.call(this,qr(T.values))}function jr(T){return ke.call(this,T.values.subarray(0,T.length*T.stride))}function fu(T){let{length:td,values:tf,valueOffsets:tb}=T,t_=tb[0],tg=Math.min(tb[td]-t_,tf.byteLength-t_);return ke.call(this,Zn(-tb[0],td,tb)),ke.call(this,tf.subarray(t_,t_+tg)),this}function Wa(T){let{length:td,valueOffsets:tf}=T;return tf&&ke.call(this,Zn(tf[0],td,tf)),this.visit(T.children[0])}function ja(T){return this.visitMany(T.type.children.map((td,tf)=>T.children[tf]).filter(Boolean))[0]}It.prototype.visitBool=Gm,It.prototype.visitInt=jr,It.prototype.visitFloat=jr,It.prototype.visitUtf8=fu,It.prototype.visitBinary=fu,It.prototype.visitFixedSizeBinary=jr,It.prototype.visitDate=jr,It.prototype.visitTimestamp=jr,It.prototype.visitTime=jr,It.prototype.visitDecimal=jr,It.prototype.visitList=Wa,It.prototype.visitStruct=ja,It.prototype.visitUnion=Xm,It.prototype.visitInterval=jr,It.prototype.visitFixedSizeList=Wa,It.prototype.visitMap=Wa;var ln=class extends en{static throughNode(T){throw Error('"throughNode" not available in this environment')}static throughDOM(T,td){throw Error('"throughDOM" not available in this environment')}constructor(T){super(),this._position=0,this._started=!1,this._sink=new Ke,this._schema=null,this._dictionaryBlocks=[],this._recordBatchBlocks=[],this._dictionaryDeltaOffsets=new Map,zt(T)||(T={autoDestroy:!0,writeLegacyIpcFormat:!1}),this._autoDestroy="boolean"!=typeof T.autoDestroy||T.autoDestroy,this._writeLegacyIpcFormat="boolean"==typeof T.writeLegacyIpcFormat&&T.writeLegacyIpcFormat}toString(T=!1){return this._sink.toString(T)}toUint8Array(T=!1){return this._sink.toUint8Array(T)}writeAll(T){return Se(T)?T.then(T=>this.writeAll(T)):he(T)?Ya(this,T):$a(this,T)}get closed(){return this._sink.closed}[Symbol.asyncIterator](){return this._sink[Symbol.asyncIterator]()}toDOMStream(T){return this._sink.toDOMStream(T)}toNodeStream(T){return this._sink.toNodeStream(T)}close(){return this.reset()._sink.close()}abort(T){return this.reset()._sink.abort(T)}finish(){return this._autoDestroy?this.close():this.reset(this._sink,this._schema),this}reset(T=this._sink,td=null){return T===this._sink||T instanceof Ke?this._sink=T:(this._sink=new Ke,T&&Lc(T)?this.toDOMStream({type:"bytes"}).pipeTo(T):T&&kc(T)&&this.toNodeStream({objectMode:!1}).pipe(T)),this._started&&this._schema&&this._writeFooter(this._schema),this._started=!1,this._dictionaryBlocks=[],this._recordBatchBlocks=[],this._dictionaryDeltaOffsets=new Map,td&&an(td,this._schema)||(null==td?(this._position=0,this._schema=null):(this._started=!0,this._schema=td,this._writeSchema(td))),this}write(T){let td=null;if(this._sink){if(null==T||T instanceof $t&&!(td=T.schema)||T instanceof gt&&!(td=T.schema))return this.finish()&&void 0}else throw Error("RecordBatchWriter is closed");if(td&&!an(td,this._schema)){if(this._started&&this._autoDestroy)return this.close();this.reset(this._sink,td)}T instanceof gt?T instanceof cn||this._writeRecordBatch(T):T instanceof $t?this.writeAll(T.batches):Ie(T)&&this.writeAll(T)}_writeMessage(T,td=8){let tf=td-1,tb=te.encode(T),t_=tb.byteLength,tg=this._writeLegacyIpcFormat?4:8,tv=t_+tg+tf&~tf,tw=tv-t_-tg;return T.headerType===tt.RecordBatch?this._recordBatchBlocks.push(new yr(tv,T.bodyLength,this._position)):T.headerType===tt.DictionaryBatch&&this._dictionaryBlocks.push(new yr(tv,T.bodyLength,this._position)),this._writeLegacyIpcFormat||this._write(Int32Array.of(-1)),this._write(Int32Array.of(tv-tg)),t_>0&&this._write(tb),this._writePadding(tw)}_write(T){if(this._started){let td=L(T);td&&td.byteLength>0&&(this._sink.write(td),this._position+=td.byteLength)}return this}_writeSchema(T){return this._writeMessage(te.from(T))}_writeFooter(T){return this._writeLegacyIpcFormat?this._write(Int32Array.of(0)):this._write(Int32Array.of(-1,0))}_writeMagic(){return this._write(Hn)}_writePadding(T){return T>0?this._write(new Uint8Array(T)):this}_writeRecordBatch(T){let{byteLength:td,nodes:tf,bufferRegions:tb,buffers:t_}=It.assemble(T),tg=new kt(T.numRows,tf,tb),tv=te.from(tg,td);return this._writeDictionaries(T)._writeMessage(tv)._writeBodyBuffers(t_)}_writeDictionaryBatch(T,td,tf=!1){this._dictionaryDeltaOffsets.set(td,T.length+(this._dictionaryDeltaOffsets.get(td)||0));let{byteLength:tb,nodes:t_,bufferRegions:tg,buffers:tv}=It.assemble(new J([T])),tw=new Qt(new kt(T.length,t_,tg),td,tf),tI=te.from(tw,tb);return this._writeMessage(tI)._writeBodyBuffers(tv)}_writeBodyBuffers(T){let td,tf,tb;for(let t_=-1,tg=T.length;++t_<tg;)(td=T[t_])&&(tf=td.byteLength)>0&&(this._write(td),(tb=(tf+7&-8)-tf)>0&&this._writePadding(tb));return this}_writeDictionaries(T){for(let[td,tf]of T.dictionaries){let T=this._dictionaryDeltaOffsets.get(td)||0;if(0===T||(tf=null==tf?void 0:tf.slice(T)).length>0)for(let tb of tf.data)this._writeDictionaryBatch(tb,td,T>0),T+=tb.length}return this}},un=class r extends ln{static writeAll(T,td){let tf=new r(td);return Se(T)?T.then(T=>tf.writeAll(T)):he(T)?Ya(tf,T):$a(tf,T)}},dn=class r extends ln{static writeAll(T){let td=new r;return Se(T)?T.then(T=>td.writeAll(T)):he(T)?Ya(td,T):$a(td,T)}constructor(){super(),this._autoDestroy=!0}_writeSchema(T){return this._writeMagic()._writePadding(2)}_writeFooter(T){let td=mr.encode(new mr(T,Ot.V4,this._recordBatchBlocks,this._dictionaryBlocks));return super._writeFooter(T)._write(td)._write(Int32Array.of(td.byteLength))._writeMagic()}};function $a(T,td){let tf=td;for(let tb of(td instanceof $t&&(tf=td.batches,T.reset(void 0,td.schema)),tf))T.write(tb);return T.finish()}function Ya(T,td){var tf,tb,t_,tg,tv,tw,tI;return F(this,void 0,void 0,function*(){try{for(tf=!0,tb=ve(td);!(tg=(t_=yield tb.next()).done);tf=!0){tI=t_.value,tf=!1;let td=tI;T.write(td)}}catch(T){tv={error:T}}finally{try{!tf&&!tg&&(tw=tb.return)&&(yield tw.call(tb))}finally{if(tv)throw tv.error}}return T.finish()})}function hu(T,td){if(he(T))return Jm(T,td);if(Ie(T))return Km(T,td);throw Error("toDOMStream() must be called with an Iterable or AsyncIterable")}function Km(T,td){let tf=null,tb=(null==td?void 0:td.type)==="bytes",t_=(null==td?void 0:td.highWaterMark)||16777216;return new ReadableStream(Object.assign(Object.assign({},td),{start(td){tg(td,tf||(tf=T[Symbol.iterator]()))},pull(T){tf?tg(T,tf):T.close()},cancel(){null!=tf&&tf.return&&tf.return(),tf=null}}),Object.assign({highWaterMark:tb?t_:void 0},td));function tg(T,td){let tf,t_=null,tg=T.desiredSize||null;for(;!(t_=td.next(tb?tg:null)).done;)if(ArrayBuffer.isView(t_.value)&&(tf=L(t_.value))&&(null!=tg&&tb&&(tg=tg-tf.byteLength+1),t_.value=tf),T.enqueue(t_.value),null!=tg&&--tg<=0)return;T.close()}}function Jm(T,td){let tf=null,tb=(null==td?void 0:td.type)==="bytes",t_=(null==td?void 0:td.highWaterMark)||16777216;return new ReadableStream(Object.assign(Object.assign({},td),{start(td){return F(this,void 0,void 0,function*(){yield tg(td,tf||(tf=T[Symbol.asyncIterator]()))})},pull(T){return F(this,void 0,void 0,function*(){tf?yield tg(T,tf):T.close()})},cancel(){return F(this,void 0,void 0,function*(){null!=tf&&tf.return&&(yield tf.return()),tf=null})}}),Object.assign({highWaterMark:tb?t_:void 0},td));function tg(T,td){return F(this,void 0,void 0,function*(){let tf,t_=null,tg=T.desiredSize||null;for(;!(t_=yield td.next(tb?tg:null)).done;)if(ArrayBuffer.isView(t_.value)&&(tf=L(t_.value))&&(null!=tg&&tb&&(tg=tg-tf.byteLength+1),t_.value=tf),T.enqueue(t_.value),null!=tg&&--tg<=0)return;T.close()})}}function yu(T){return new Xa(T)}var Xa=class{constructor(T){this._numChunks=0,this._finished=!1,this._bufferedSize=0;let{readableStrategy:td,writableStrategy:tf,queueingStrategy:tb="count"}=T,t_=Uc(T,["readableStrategy","writableStrategy","queueingStrategy"]);this._controller=null,this._builder=nn(t_),this._getSize="bytes"!==tb?pu:mu;let{highWaterMark:tg="bytes"===tb?16384:1e3}=Object.assign({},td),{highWaterMark:tv="bytes"===tb?16384:1e3}=Object.assign({},tf);this.readable=new ReadableStream({cancel:()=>{this._builder.clear()},pull:T=>{this._maybeFlush(this._builder,this._controller=T)},start:T=>{this._maybeFlush(this._builder,this._controller=T)}},{highWaterMark:tg,size:"bytes"!==tb?pu:mu}),this.writable=new WritableStream({abort:()=>{this._builder.clear()},write:()=>{this._maybeFlush(this._builder,this._controller)},close:()=>{this._maybeFlush(this._builder.finish(),this._controller)}},{highWaterMark:tv,size:T=>this._writeValueAndReturnChunkSize(T)})}_writeValueAndReturnChunkSize(T){let td=this._bufferedSize;return this._bufferedSize=this._getSize(this._builder.append(T)),this._bufferedSize-td}_maybeFlush(T,td){null!=td&&(this._bufferedSize>=td.desiredSize&&++this._numChunks&&this._enqueue(td,T.toVector()),T.finished&&((T.length>0||0===this._numChunks)&&++this._numChunks&&this._enqueue(td,T.toVector()),!this._finished&&(this._finished=!0)&&this._enqueue(td,null)))}_enqueue(T,td){this._bufferedSize=0,this._controller=null,null==td?T.close():T.enqueue(td)}},pu=T=>{var td;return null!==(td=null==T?void 0:T.length)&&void 0!==td?td:0},mu=T=>{var td;return null!==(td=null==T?void 0:T.byteLength)&&void 0!==td?td:0};function Ao(T,td){let tf=new Ke,tb=null,t_=new ReadableStream({cancel(){return F(this,void 0,void 0,function*(){yield tf.close()})},start(T){return F(this,void 0,void 0,function*(){yield tv(T,tb||(tb=yield tg()))})},pull(T){return F(this,void 0,void 0,function*(){tb?yield tv(T,tb):T.close()})}});return{writable:new WritableStream(tf,Object.assign({highWaterMark:16384},T)),readable:t_};function tg(){return F(this,void 0,void 0,function*(){return yield(yield Ct.from(tf)).open(td)})}function tv(T,td){return F(this,void 0,void 0,function*(){let tf=T.desiredSize,tb=null;for(;!(tb=yield td.next()).done;)if(T.enqueue(tb.value),null!=tf&&--tf<=0)return;T.close()})}}function To(T,td){let tf=new this(T),tb=new _e(tf),t_=new ReadableStream({cancel(){return F(this,void 0,void 0,function*(){yield tb.cancel()})},pull(T){return F(this,void 0,void 0,function*(){yield tg(T)})},start(T){return F(this,void 0,void 0,function*(){yield tg(T)})}},Object.assign({highWaterMark:16384},td));return{writable:new WritableStream(tf,T),readable:t_};function tg(T){return F(this,void 0,void 0,function*(){let td=null,tf=T.desiredSize;for(;td=yield tb.read(tf||null);)if(T.enqueue(td),null!=tf&&(tf-=td.byteLength)<=0)return;T.close()})}}function xo(T,td="stream"){return("stream"===td?un:dn).writeAll(T).toUint8Array(!0)}var ty=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},sa),Ea),va),oa),ea),wa),{compareSchemas:an,compareFields:jl,compareTypes:Wl});function $n(T){switch(T.typeId){case h.Binary:return{sqlType:"binary"};case h.Bool:return{sqlType:"bool"};case h.Date:return{sqlType:"date"};case h.DateDay:return{sqlType:"date32[d]"};case h.DateMillisecond:return{sqlType:"date64[ms]"};case h.Decimal:{let td=T;return{sqlType:"decimal",precision:td.precision,scale:td.scale}}case h.Float:return{sqlType:"float"};case h.Float16:return{sqlType:"float16"};case h.Float32:return{sqlType:"float32"};case h.Float64:return{sqlType:"float64"};case h.Int:return{sqlType:"int32"};case h.Int16:return{sqlType:"int16"};case h.Int32:return{sqlType:"int32"};case h.Int64:return{sqlType:"int64"};case h.Uint16:return{sqlType:"uint16"};case h.Uint32:return{sqlType:"uint32"};case h.Uint64:return{sqlType:"uint64"};case h.Uint8:return{sqlType:"uint8"};case h.IntervalDayTime:return{sqlType:"interval[dt]"};case h.IntervalYearMonth:return{sqlType:"interval[m]"};case h.List:return{sqlType:"list",valueType:$n(T.valueType)};case h.FixedSizeBinary:return{sqlType:"fixedsizebinary",byteWidth:T.byteWidth};case h.Null:return{sqlType:"null"};case h.Utf8:return{sqlType:"utf8"};case h.Struct:return{sqlType:"struct",fields:T.children.map(T=>Do(T.name,T.type))};case h.Map:{let td=T;return{sqlType:"map",keyType:$n(td.keyType),valueType:$n(td.valueType)}}case h.Time:return{sqlType:"time[s]"};case h.TimeMicrosecond:return{sqlType:"time[us]"};case h.TimeMillisecond:return{sqlType:"time[ms]"};case h.TimeNanosecond:return{sqlType:"time[ns]"};case h.TimeSecond:return{sqlType:"time[s]"};case h.Timestamp:return{sqlType:"timestamp",timezone:T.timezone||void 0};case h.TimestampSecond:return{sqlType:"timestamp[s]",timezone:T.timezone||void 0};case h.TimestampMicrosecond:return{sqlType:"timestamp[us]",timezone:T.timezone||void 0};case h.TimestampNanosecond:return{sqlType:"timestamp[ns]",timezone:T.timezone||void 0};case h.TimestampMillisecond:return{sqlType:"timestamp[ms]",timezone:T.timezone||void 0}}throw Error("unsupported arrow type: ".concat(T.toString()))}function Do(T,td){let tf=$n(td);return tf.name=T,tf}Ut.toDOMStream=hu,pt.throughDOM=yu,Ct.throughDOM=Ao,zr.throughDOM=Ao,Ze.throughDOM=Ao,ln.throughDOM=To,dn.throughDOM=To,un.throughDOM=To;var Eo=class{constructor(){this._bindings=null,this._nextMessageId=0}log(T){this.postMessage({messageId:this._nextMessageId++,requestId:0,type:"LOG",data:T},[])}sendOK(T){this.postMessage({messageId:this._nextMessageId++,requestId:T.messageId,type:"OK",data:null},[])}failWith(T,td){let tf={name:td.name,message:td.message,stack:td.stack||void 0};this.postMessage({messageId:this._nextMessageId++,requestId:T.messageId,type:"ERROR",data:tf},[])}async onMessage(T){switch(T.type){case"PING":this.sendOK(T);return;case"INSTANTIATE":null!=this._bindings&&this.failWith(T,Error("duckdb already initialized"));try{this._bindings=await this.instantiate(T.data[0],T.data[1],td=>{this.postMessage({messageId:this._nextMessageId++,requestId:T.messageId,type:"INSTANTIATE_PROGRESS",data:td},[])}),this.sendOK(T)}catch(td){console.log(td),this._bindings=null,this.failWith(T,td)}return}if(!this._bindings)return this.failWith(T,Error("duckdb is not initialized"));try{switch(T.type){case"GET_VERSION":this.postMessage({messageId:this._nextMessageId++,requestId:T.messageId,type:"VERSION_STRING",data:this._bindings.getVersion()},[]);break;case"GET_FEATURE_FLAGS":this.postMessage({messageId:this._nextMessageId++,requestId:T.messageId,type:"FEATURE_FLAGS",data:this._bindings.getFeatureFlags()},[]);break;case"RESET":this._bindings.reset(),this.sendOK(T);break;case"OPEN":this._bindings.open(T.data),this.sendOK(T);break;case"DROP_FILE":this._bindings.dropFile(T.data),this.sendOK(T);break;case"DROP_FILES":this._bindings.dropFiles(),this.sendOK(T);break;case"FLUSH_FILES":this._bindings.flushFiles(),this.sendOK(T);break;case"CONNECT":{let td=this._bindings.connect();this.postMessage({messageId:this._nextMessageId++,requestId:T.messageId,type:"CONNECTION_INFO",data:td.useUnsafe((T,td)=>td)},[]);break}case"DISCONNECT":this._bindings.disconnect(T.data),this.sendOK(T);break;case"CREATE_PREPARED":{let td=this._bindings.createPrepared(T.data[0],T.data[1]);this.postMessage({messageId:this._nextMessageId++,requestId:T.messageId,type:"PREPARED_STATEMENT_ID",data:td},[]);break}case"CLOSE_PREPARED":this._bindings.closePrepared(T.data[0],T.data[1]),this.sendOK(T);break;case"RUN_PREPARED":{let td=this._bindings.runPrepared(T.data[0],T.data[1],T.data[2]);this.postMessage({messageId:this._nextMessageId++,requestId:T.messageId,type:"QUERY_RESULT",data:td},[td.buffer]);break}case"RUN_QUERY":{let td=this._bindings.runQuery(T.data[0],T.data[1]);this.postMessage({messageId:this._nextMessageId++,requestId:T.messageId,type:"QUERY_RESULT",data:td},[td.buffer]);break}case"SEND_PREPARED":{let td=this._bindings.sendPrepared(T.data[0],T.data[1],T.data[2]);this.postMessage({messageId:this._nextMessageId++,requestId:T.messageId,type:"QUERY_RESULT_HEADER",data:td},[td.buffer]);break}case"START_PENDING_QUERY":{let td=this._bindings.startPendingQuery(T.data[0],T.data[1]),tf=[];td&&tf.push(td.buffer),this.postMessage({messageId:this._nextMessageId++,requestId:T.messageId,type:"QUERY_RESULT_HEADER_OR_NULL",data:td},tf);break}case"POLL_PENDING_QUERY":{let td=this._bindings.pollPendingQuery(T.data),tf=[];td&&tf.push(td.buffer),this.postMessage({messageId:this._nextMessageId++,requestId:T.messageId,type:"QUERY_RESULT_HEADER_OR_NULL",data:td},tf);break}case"CANCEL_PENDING_QUERY":{let td=this._bindings.cancelPendingQuery(T.data);this.postMessage({messageId:this._nextMessageId++,requestId:T.messageId,type:"SUCCESS",data:td},[]);break}case"FETCH_QUERY_RESULTS":{let td=this._bindings.fetchQueryResults(T.data);this.postMessage({messageId:this._nextMessageId++,requestId:T.messageId,type:"QUERY_RESULT_CHUNK",data:td},[td.buffer]);break}case"GET_TABLE_NAMES":{let td=this._bindings.getTableNames(T.data[0],T.data[1]);this.postMessage({messageId:this._nextMessageId++,requestId:T.messageId,type:"TABLE_NAMES",data:td},[]);break}case"GLOB_FILE_INFOS":{let td=this._bindings.globFiles(T.data);this.postMessage({messageId:this._nextMessageId++,requestId:T.messageId,type:"FILE_INFOS",data:td},[]);break}case"REGISTER_FILE_URL":this._bindings.registerFileURL(T.data[0],T.data[1],T.data[2],T.data[3]),this.sendOK(T);break;case"REGISTER_FILE_BUFFER":this._bindings.registerFileBuffer(T.data[0],T.data[1]),this.sendOK(T);break;case"REGISTER_FILE_HANDLE":this._bindings.registerFileHandle(T.data[0],T.data[1],T.data[2],T.data[3]),this.sendOK(T);break;case"COPY_FILE_TO_PATH":this._bindings.copyFileToPath(T.data[0],T.data[1]),this.sendOK(T);break;case"COPY_FILE_TO_BUFFER":{let td=this._bindings.copyFileToBuffer(T.data);this.postMessage({messageId:this._nextMessageId++,requestId:T.messageId,type:"FILE_BUFFER",data:td},[]);break}case"COLLECT_FILE_STATISTICS":this._bindings.collectFileStatistics(T.data[0],T.data[1]),this.sendOK(T);break;case"EXPORT_FILE_STATISTICS":this.postMessage({messageId:this._nextMessageId++,requestId:T.messageId,type:"FILE_STATISTICS",data:this._bindings.exportFileStatistics(T.data)},[]);break;case"INSERT_ARROW_FROM_IPC_STREAM":this._bindings.insertArrowFromIPCStream(T.data[0],T.data[1],T.data[2]),this.sendOK(T);break;case"IMPORT_CSV_FROM_PATH":this._bindings.insertCSVFromPath(T.data[0],T.data[1],T.data[2]),this.sendOK(T);break;case"IMPORT_JSON_FROM_PATH":this._bindings.insertJSONFromPath(T.data[0],T.data[1],T.data[2]),this.sendOK(T);break;case"TOKENIZE":{let td=this._bindings.tokenize(T.data);this.postMessage({messageId:this._nextMessageId++,requestId:T.messageId,type:"SCRIPT_TOKENS",data:td},[])}}}catch(td){return console.log(td),this.failWith(T,td)}}},Tu=Rc(Su()),Oo=class{constructor(T,td){this._bindings=T,this._conn=td}close(){this._bindings.disconnect(this._conn)}useUnsafe(T){return T(this._bindings,this._conn)}query(T){let td=this._bindings.runQuery(this._conn,T),tf=Ct.from(td);return console.assert(tf.isSync()),console.assert(tf.isFile()),new $t(tf)}async send(T){let td=this._bindings.startPendingQuery(this._conn,T);for(;null==td;)td=await new Promise((T,td)=>{try{T(this._bindings.pollPendingQuery(this._conn))}catch(T){console.log(T),td(T)}});let tf=new Ro(this._bindings,this._conn,td),tb=Ct.from(tf);return console.assert(tb.isSync()),console.assert(tb.isStream()),tb}cancelSent(){return this._bindings.cancelPendingQuery(this._conn)}getTableNames(T){return this._bindings.getTableNames(this._conn,T)}prepare(T){let td=this._bindings.createPrepared(this._conn,T);return new Ka(this._bindings,this._conn,td)}createScalarFunction(T,td,tf){this._bindings.createScalarFunction(this._conn,T,td,tf)}insertArrowTable(T,td){let tf=xo(T,"stream");this.insertArrowFromIPCStream(tf,td)}insertArrowFromIPCStream(T,td){this._bindings.insertArrowFromIPCStream(this._conn,T,td)}insertCSVFromPath(T,td){this._bindings.insertCSVFromPath(this._conn,T,td)}insertJSONFromPath(T,td){this._bindings.insertJSONFromPath(this._conn,T,td)}},Ro=class{constructor(T,td,tf){this.bindings=T,this.conn=td,this.header=tf,this._first=!0,this._depleted=!1}next(){if(this._first)return this._first=!1,{done:!1,value:this.header};if(this._depleted)return{done:!0,value:null};let T=this.bindings.fetchQueryResults(this.conn);return this._depleted=0==T.length,{done:this._depleted,value:T}}[Symbol.iterator](){return this}},Ka=class{constructor(T,td,tf){this.bindings=T,this.connectionId=td,this.statementId=tf}close(){this.bindings.closePrepared(this.connectionId,this.statementId)}query(...T){let td=this.bindings.runPrepared(this.connectionId,this.statementId,T),tf=Ct.from(td);return console.assert(tf.isSync()),console.assert(tf.isFile()),new $t(tf)}send(...T){let td=this.bindings.sendPrepared(this.connectionId,this.statementId,T),tf=new Ro(this.bindings,this.connectionId,td),tb=Ct.from(tf);return console.assert(tb.isSync()),console.assert(tb.isStream()),tb}},Bu=new TextEncoder,Iu=new TextDecoder("utf-8");function Ja(T,td,tf){let tb=Bu.encode(tf),t_=T._malloc(tb.byteLength),tg=T.HEAPU8.subarray(t_,t_+tb.byteLength);tg.set(tb),T.HEAPF64[(td>>3)+0]=1,T.HEAPF64[(td>>3)+1]=t_,T.HEAPF64[(td>>3)+2]=tg.byteLength}function Za(T){switch(T){case"UINT8":case"INT8":return 1;case"INT32":case"FLOAT":return 4;case"INT64":case"UINT64":case"DOUBLE":case"VARCHAR":return 8;default:return 0}}function qa(T,td,tf,tb){let t_=T.HEAPU8.subarray(td,td+tb*Za(tf));switch(tf){case"UINT8":return new Uint8Array(t_.buffer,t_.byteOffset,tb);case"INT8":return new Int8Array(t_.buffer,t_.byteOffset,tb);case"INT32":return new Int32Array(t_.buffer,t_.byteOffset,tb);case"FLOAT":return new Float32Array(t_.buffer,t_.byteOffset,tb);case"DOUBLE":case"VARCHAR":return new Float64Array(t_.buffer,t_.byteOffset,tb);default:return[]}}function Fu(T,td,tf){let tb=T.HEAPU8.subarray(td,td+tf);return new Uint8Array(tb.buffer,tb.byteOffset,tf)}function Mo(T,td,tf){let tb=T.HEAPU8.subarray(td,td+8*tf);return new Float64Array(tb.buffer,tb.byteOffset,tf)}function Au(T,td,tf,tb,t_,tg,tv,tw){try{let tI=T._udfFunctions.get(tb);if(!tI){Ja(td,tf,"Unknown UDF with id: "+tb);return}let tS=Iu.decode(td.HEAPU8.subarray(t_,t_+tg)),tA=JSON.parse(tS),tT=Mo(td,tv,tw/8),tB=T=>{var tf;let tb=null;switch(void 0!==T.validityBuffer&&(tb=Fu(td,tT[T.validityBuffer],tA.rows)),T.physicalType){case"VARCHAR":{if(null===T.dataBuffer||void 0===T.dataBuffer)throw Error("malformed data view, expected data buffer for VARCHAR argument");if(null===T.lengthBuffer||void 0===T.lengthBuffer)throw Error("malformed data view, expected data length buffer for VARCHAR argument");let tf=qa(td,tT[T.dataBuffer],T.physicalType,tA.rows),t_=[],tg=Mo(td,tT[T.lengthBuffer],tA.rows);for(let T=0;T<tA.rows;++T){if(null!=tb&&!tb[T]){t_.push(null);continue}let tv=td.HEAPU8.subarray(tf[T],tf[T]+tg[T]),tw=Iu.decode(tv);t_.push(tw)}return T=>t_[T]}case"STRUCT":{let td={},t_=[];for(let tb=0;tb<((null==(tf=T.children)?void 0:tf.length)||0);++tb){let tf=T.children[tb],tg=tB(tf);t_.push(T=>{td[tf.name]=tg(T)})}return null!=tb?T=>{if(!tb[T])return null;for(let td of t_)td(T);return td}:T=>{for(let td of t_)td(T);return td}}default:{if(void 0===T.dataBuffer)throw Error("malformed data view, expected data buffer for argument of type: "+T.physicalType);let tf=qa(td,tT[T.dataBuffer],T.physicalType,tA.rows);return null!=tb?T=>tb[T]?tf[T]:null:T=>tf[T]}}},tF=[];for(let T=0;T<tA.args.length;++T)tF.push(tB(tA.args[T]));let tO=tA.rows*Za(tA.ret.physicalType),tD=td._malloc(tO),tM=qa(td,tD,tA.ret.physicalType,tA.rows),tE=td._malloc(tA.rows),tU=Fu(td,tE,tA.rows);if(0==tM.length||0==tU.length){Ja(td,tf,"Can't create physical arrays for result");return}let tx=tM;"VARCHAR"==tA.ret.physicalType&&(tx=Array(tA.rows));let tN=[];for(let T=0;T<tA.args.length;++T)tN.push(null);for(let T=0;T<tA.rows;++T){for(let td=0;td<tA.args.length;++td)tN[td]=tF[td](T);let td=tI.func(...tN);tx[T]=td,tU[T]=null==td?0:1}let tL=0;if("VARCHAR"===tA.ret.physicalType){let T=[];tL=td._malloc(tA.rows*Za("DOUBLE"));let tf=Mo(td,tL,tA.rows),tb=0;for(let td=0;td<tA.rows;++td){let t_=Bu.encode(tx[td]||"");T.push(t_),tf[td]=t_.length,tb+=t_.length}let t_=td._malloc(tb),tg=td.HEAPU8.subarray(t_,t_+tb),tv=0;for(let td=0;td<tA.rows;++td){tM[td]=tv;let tf=T[td];tg.subarray(tv,tv+tf.length).set(tf),tv+=tf.length}}let tR=24,tk=td._malloc(tR),tC=Mo(td,tk,3);tC[0]=tD,tC[1]=tE,tC[2]=tL,td.HEAPF64[(tf>>3)+0]=0,td.HEAPF64[(tf>>3)+1]=tk,td.HEAPF64[(tf>>3)+2]=0}catch(T){Ja(td,tf,T.toString())}}function ry(){let T=new TextDecoder;return td=>("u">typeof SharedArrayBuffer&&td.buffer instanceof SharedArrayBuffer&&(td=new Uint8Array(td)),T.decode(td))}var ny=ry();function ge(T,td){console.error("FAIL WITH: ".concat(td)),T.ccall("duckdb_web_fail_with",null,["string"],[td])}function fn(T,td,tf){let tb=T.HEAPU8.subarray(td,td+tf),t_=new Uint8Array(new ArrayBuffer(tb.byteLength));return t_.set(tb),t_}function z(T,td,tf){return ny(T.HEAPU8.subarray(td,td+tf))}function it(T,td,tf,tb){let t_=T.stackSave(),tg=T.stackAlloc(24);tf.unshift("number"),tb.unshift(tg),T.ccall(td,null,tf,tb);let tv=T.HEAPF64[(tg>>3)+0],tw=T.HEAPF64[(tg>>3)+1],tI=T.HEAPF64[(tg>>3)+2];return T.stackRestore(t_),[tv,tw,tI]}function ft(T){T.ccall("duckdb_web_clear_response",null,[],[])}var Uo=class{constructor(T){let td=new Float64Array(T.buffer,T.byteOffset,T.byteLength/8),tf=new Uint8Array(new ArrayBuffer(T.byteLength));tf.set(T.subarray(56)),this.totalFileReadsCold=td[0],this.totalFileReadsAhead=td[1],this.totalFileReadsCached=td[2],this.totalFileWrites=td[3],this.totalPageAccesses=td[4],this.totalPageLoads=td[5],this.blockSize=td[6],this.blockStats=tf}getBlockStats(T,td){return(td=td||{file_reads_cold:0,file_reads_ahead:0,file_reads_cached:0,file_writes:0,page_accesses:0,page_loads:0}).file_writes=15&this.blockStats[3*T+0],td.file_reads_cold=this.blockStats[3*T+0]>>4,td.file_reads_ahead=15&this.blockStats[3*T+1],td.file_reads_cached=this.blockStats[3*T+1]>>4,td.page_accesses=15&this.blockStats[3*T+1],td.page_loads=this.blockStats[3*T+1]>>4,td}},iy=new TextEncoder,No=class{constructor(T,td){this._instance=null,this._initPromise=null,this._initPromiseResolver=()=>{},this.onInstantiationProgress=[],this._logger=T,this._runtime=td,this._nextUDFId=1}get logger(){return this._logger}get mod(){return this._instance}get pthread(){return this.mod.PThread||null}async instantiate(T=T=>{}){return null!=this._instance||(null!=this._initPromise&&(this.onInstantiationProgress.push(T),await this._initPromise),this._initPromise=new Promise(T=>{this._initPromiseResolver=T}),this.onInstantiationProgress=[T],this._instance=await this.instantiateImpl({print:console.log.bind(console),printErr:console.log.bind(console),onRuntimeInitialized:this._initPromiseResolver}),await this._initPromise,this._initPromise=null,this.onInstantiationProgress=this.onInstantiationProgress.filter(td=>td!=T)),this}open(T){let[td,tf,tb]=it(this.mod,"duckdb_web_open",["string"],[JSON.stringify(T)]);if(0!==td)throw Error(z(this.mod,tf,tb));ft(this.mod)}reset(){let[T,td,tf]=it(this.mod,"duckdb_web_reset",[],[]);if(0!==T)throw Error(z(this.mod,td,tf));ft(this.mod)}getVersion(){let[T,td,tf]=it(this.mod,"duckdb_web_get_version",[],[]);if(0!==T)throw Error(z(this.mod,td,tf));let tb=z(this.mod,td,tf);return ft(this.mod),tb}getFeatureFlags(){return this.mod.ccall("duckdb_web_get_feature_flags","number",[],[])}tokenize(T){let[td,tf,tb]=it(this.mod,"duckdb_web_tokenize",["string"],[T]);if(0!==td)throw Error(z(this.mod,tf,tb));let t_=z(this.mod,tf,tb);return ft(this.mod),JSON.parse(t_)}connect(){return new Oo(this,this.mod.ccall("duckdb_web_connect","number",[],[]))}disconnect(T){if(this.mod.ccall("duckdb_web_disconnect",null,["number"],[T]),this.pthread)for(let td of[...this.pthread.runningWorkers,...this.pthread.unusedWorkers])td.postMessage({cmd:"dropUDFFunctions",connectionId:T})}runQuery(T,td){let[tf,tb,t_]=it(this.mod,"duckdb_web_query_run",["number","string"],[T,td]);if(0!==tf)throw Error(z(this.mod,tb,t_));let tg=fn(this.mod,tb,t_);return ft(this.mod),tg}startPendingQuery(T,td){let[tf,tb,t_]=it(this.mod,"duckdb_web_pending_query_start",["number","string"],[T,td]);if(0!==tf)throw Error(z(this.mod,tb,t_));if(0==tb)return null;let tg=fn(this.mod,tb,t_);return ft(this.mod),tg}pollPendingQuery(T){let[td,tf,tb]=it(this.mod,"duckdb_web_pending_query_poll",["number"],[T]);if(0!==td)throw Error(z(this.mod,tf,tb));if(0==tf)return null;let t_=fn(this.mod,tf,tb);return ft(this.mod),t_}cancelPendingQuery(T){return this.mod.ccall("duckdb_web_pending_query_cancel","boolean",["number"],[T])}fetchQueryResults(T){let[td,tf,tb]=it(this.mod,"duckdb_web_query_fetch_results",["number"],[T]);if(0!==td)throw Error(z(this.mod,tf,tb));let t_=fn(this.mod,tf,tb);return ft(this.mod),t_}getTableNames(T,td){let[tf,tb,t_]=it(this.mod,"duckdb_web_get_tablenames",["number","string"],[T,td]);if(0!==tf)throw Error(z(this.mod,tb,t_));let tg=z(this.mod,tb,t_);return ft(this.mod),JSON.parse(tg)}createScalarFunction(T,td,tf,tb){let t_={functionId:this._nextUDFId,name:td,returnType:$n(tf)},tg={functionId:t_.functionId,connectionId:T,name:td,returnType:tf,func:tb};this._nextUDFId+=1;let[tv,tw,tI]=it(this.mod,"duckdb_web_udf_scalar_create",["number","string"],[T,JSON.stringify(t_)]);if(0!==tv)throw Error(z(this.mod,tw,tI));if(ft(this.mod),globalThis.DUCKDB_RUNTIME._udfFunctions=(globalThis.DUCKDB_RUNTIME._udfFunctions||new Map).set(tg.functionId,tg),this.pthread)for(let T of[...this.pthread.runningWorkers,...this.pthread.unusedWorkers])T.postMessage({cmd:"registerUDFFunction",udf:tg})}createPrepared(T,td){let[tf,tb,t_]=it(this.mod,"duckdb_web_prepared_create",["number","string"],[T,td]);if(0!==tf)throw Error(z(this.mod,tb,t_));return ft(this.mod),tb}closePrepared(T,td){let[tf,tb,t_]=it(this.mod,"duckdb_web_prepared_close",["number","number"],[T,td]);if(0!==tf)throw Error(z(this.mod,tb,t_));ft(this.mod)}runPrepared(T,td,tf){let[tb,t_,tg]=it(this.mod,"duckdb_web_prepared_run",["number","number","string"],[T,td,JSON.stringify(tf)]);if(0!==tb)throw Error(z(this.mod,t_,tg));let tv=fn(this.mod,t_,tg);return ft(this.mod),tv}sendPrepared(T,td,tf){let[tb,t_,tg]=it(this.mod,"duckdb_web_prepared_send",["number","number","string"],[T,td,JSON.stringify(tf)]);if(0!==tb)throw Error(z(this.mod,t_,tg));let tv=fn(this.mod,t_,tg);return ft(this.mod),tv}insertArrowFromIPCStream(T,td,tf){if(0==td.length)return;let tb=this.mod._malloc(td.length);this.mod.HEAPU8.subarray(tb,tb+td.length).set(td);let t_=tf?JSON.stringify(tf):"",[tg,tv,tw]=it(this.mod,"duckdb_web_insert_arrow_from_ipc_stream",["number","number","number","string"],[T,tb,td.length,t_]);if(0!==tg)throw Error(z(this.mod,tv,tw))}insertCSVFromPath(T,td,tf){if(void 0!==tf.columns)for(let T in tf.columnsFlat=[],tf.columns)tf.columnsFlat.push(Do(T,tf.columns[T]));let tb={...tf};tb.columns=tb.columnsFlat,delete tb.columnsFlat;let t_=JSON.stringify(tb),[tg,tv,tw]=it(this.mod,"duckdb_web_insert_csv_from_path",["number","string","string"],[T,td,t_]);if(0!==tg)throw Error(z(this.mod,tv,tw))}insertJSONFromPath(T,td,tf){if(void 0!==tf.columns)for(let T in tf.columnsFlat=[],tf.columns)tf.columnsFlat.push(Do(T,tf.columns[T]));let tb={...tf};tb.columns=tb.columnsFlat,delete tb.columnsFlat;let t_=JSON.stringify(tb),[tg,tv,tw]=it(this.mod,"duckdb_web_insert_json_from_path",["number","string","string"],[T,td,t_]);if(0!==tg)throw Error(z(this.mod,tv,tw))}globFiles(T){let[td,tf,tb]=it(this.mod,"duckdb_web_fs_glob_file_infos",["string"],[T]);if(0!==td)throw Error(z(this.mod,tf,tb));let t_=z(this.mod,tf,tb);ft(this.mod);let tg=JSON.parse(t_);return null==tg?[]:tg}registerFileURL(T,td,tf,tb=!1){void 0===td&&(td=T);let[t_,tg,tv]=it(this.mod,"duckdb_web_fs_register_file_url",["string","string"],[T,td,tf,tb]);if(0!==t_)throw Error(z(this.mod,tg,tv));ft(this.mod)}registerFileText(T,td){let tf=iy.encode(td);this.registerFileBuffer(T,tf)}registerFileBuffer(T,td){let tf=this.mod._malloc(td.length);this.mod.HEAPU8.subarray(tf,tf+td.length).set(td);let[tb,t_,tg]=it(this.mod,"duckdb_web_fs_register_file_buffer",["string","number","number"],[T,tf,td.length]);if(0!==tb)throw Error(z(this.mod,t_,tg));ft(this.mod)}registerFileHandle(T,td,tf,tb){let[t_,tg,tv]=it(this.mod,"duckdb_web_fs_register_file_url",["string","string","number","boolean"],[T,T,tf,tb]);if(0!==t_)throw Error(z(this.mod,tg,tv));if(ft(this.mod),globalThis.DUCKDB_RUNTIME._files=(globalThis.DUCKDB_RUNTIME._files||new Map).set(T,td),this.pthread){for(let tf of this.pthread.runningWorkers)tf.postMessage({cmd:"registerFileHandle",fileName:T,fileHandle:td});for(let td of this.pthread.unusedWorkers)td.postMessage({cmd:"dropFileHandle",fileName:T})}}dropFile(T){let[td,tf,tb]=it(this.mod,"duckdb_web_fs_drop_file",["string"],[T]);if(0!==td)throw Error(z(this.mod,tf,tb));ft(this.mod)}dropFiles(){let[T,td,tf]=it(this.mod,"duckdb_web_fs_drop_files",[],[]);if(0!==T)throw Error(z(this.mod,td,tf));ft(this.mod)}flushFiles(){this.mod.ccall("duckdb_web_flush_files",null,[],[])}copyFileToPath(T,td){let[tf,tb,t_]=it(this.mod,"duckdb_web_copy_file_to_path",["string","string"],[T,td]);if(0!==tf)throw Error(z(this.mod,tb,t_));ft(this.mod)}copyFileToBuffer(T){let[td,tf,tb]=it(this.mod,"duckdb_web_copy_file_to_buffer",["string"],[T]);if(0!==td)throw Error(z(this.mod,tf,tb));let t_=this.mod.HEAPU8.subarray(tf,tf+tb),tg=new Uint8Array(t_.length);return tg.set(t_),ft(this.mod),tg}collectFileStatistics(T,td){let[tf,tb,t_]=it(this.mod,"duckdb_web_collect_file_stats",["string","boolean"],[T,td]);if(0!==tf)throw Error(z(this.mod,tb,t_))}exportFileStatistics(T){let[td,tf,tb]=it(this.mod,"duckdb_web_export_file_stats",["string"],[T]);if(0!==td)throw Error(z(this.mod,tf,tb));return new Uo(this.mod.HEAPU8.subarray(tf,tf+tb))}},Lo=class extends No{constructor(T,td,tf,tb){super(T,td),this.mainModuleURL=tf,this.pthreadWorkerURL=tb}locateFile(T,td){if(T.endsWith(".wasm"))return this.mainModuleURL;if(T.endsWith(".worker.js")){if(!this.pthreadWorkerURL)throw Error("Missing DuckDB worker URL!");return this.pthreadWorkerURL}throw Error("WASM instantiation requested unexpected file: prefix=".concat(td," path=").concat(T))}instantiateWasm(T,td){globalThis.DUCKDB_RUNTIME=this._runtime;let tf=this.onInstantiationProgress;if(WebAssembly.instantiateStreaming){if("function"==typeof TransformStream){let tb=(async()=>{var T;let td=new Request(this.mainModuleURL),tb=await fetch(td),t_=tb.headers.get("content-length"),tg=t_&&parseInt(t_,10)||0,tv=new Date,tw={startedAt:tv,updatedAt:tv,bytesTotal:tg||0,bytesLoaded:0},tI={transform(T,td){tw.bytesLoaded+=T.byteLength;let tb=new Date;if(tb.getTime()-tw.updatedAt.getTime()<20){tw.updatedAt=tb,td.enqueue(T);return}for(let T of tf)T(tw);td.enqueue(T)}},tS=new TransformStream(tI);return new Response(null==(T=tb.body)?void 0:T.pipeThrough(tS),tb)})();WebAssembly.instantiateStreaming(tb,T).then(T=>{td(T.instance,T.module)})}else{console.warn("instantiating without progress handler since transform streams are unavailable");let tf=new Request(this.mainModuleURL);WebAssembly.instantiateStreaming(fetch(tf),T).then(T=>{td(T.instance,T.module)})}}else if("function"==typeof XMLHttpRequest){let tb=new XMLHttpRequest,t_=this.mainModuleURL,tg=new Date,tv={startedAt:tg,updatedAt:tg,bytesTotal:0,bytesLoaded:0};tb.open("GET",t_),tb.responseType="arraybuffer",tb.onerror=T=>{throw this.logger.log({timestamp:new Date,level:4,origin:3,topic:5,event:2,value:"Failed to load WASM: "+T}),Error(T.toString())},tb.onprogress=T=>{tv.bytesTotal=T.total,tv.bytesLoaded=T.loaded;let td=new Date;if(td.getTime()-tv.updatedAt.getTime()<20){tv.updatedAt=td;return}for(let T of tf)T(tv)},tb.onload=()=>{WebAssembly.instantiate(tb.response,T).then(T=>{td(T.instance,T.module)}).catch(T=>{throw this.logger.log({timestamp:new Date,level:4,origin:3,topic:5,event:2,value:"Failed to instantiate WASM: "+T}),Error(T)})},tb.send()}else console.warn("instantiating with manual fetch since streaming instantiation and xhrs are unavailable"),(async()=>{let tf=new Request(this.mainModuleURL),tb=await (await fetch(tf)).arrayBuffer();WebAssembly.instantiate(tb,T).then(T=>{td(T.instance,T.module)})})();return[]}},ko=class extends Lo{constructor(T,td,tf,tb=null){super(T,td,tf,tb)}instantiateImpl(T){return(0,Tu.default)({...T,instantiateWasm:this.instantiateWasm.bind(this),locateFile:this.locateFile.bind(this)})}},Wr=Rc(xu()),Du=function(T,td,tf){var tb;if(!(null!=(tb=null==T?void 0:T.endpoint)&&tb.startsWith("http")))return null!=T&&T.endpoint?"".concat(tf,".").concat(null==T?void 0:T.endpoint):"".concat(tf,".s3.amazonaws.com");{let td="".concat(null==T?void 0:T.endpoint),tf=td.indexOf("://")+3;return td.substring(tf)}};function sy(T,td,tf){var tb,t_,tg,tv;let tw=Eu(td),tI=tw.path;return Ou(T)&&(tI="/".concat(tw.bucket).concat(tI)),{url:tI,query:"",host:Du(T,td,tw.bucket),region:null!=(tb=null==T?void 0:T.region)?tb:"",service:"s3",method:tf,accessKeyId:null!=(t_=null==T?void 0:T.accessKeyId)?t_:"",secretAccessKey:null!=(tg=null==T?void 0:T.secretAccessKey)?tg:"",sessionToken:null!=(tv=null==T?void 0:T.sessionToken)?tv:"",dateNow:new Date().toISOString().replace(/-/g,"").split("T")[0],datetimeNow:new Date().toISOString().replace(/-/g,"").replace(/:/g,"").split(".")[0]+"Z"}}function oy(T,td=!1){let tf="0123456789ABCDEF",tb="";for(let t_=0;t_<T.length;t_++){let tg=T[t_];tg>="A"&&tg<="Z"||tg>="a"&&tg<="z"||tg>="0"&&tg<="9"||"_"==tg||"-"==tg||"~"==tg||"."==tg?tb+=tg:"/"==tg?td?tb+="%2F":tb+=tg:tb+="%"+tf[tg.charCodeAt(0)>>4]+tf[15&tg.charCodeAt(0)]}return tb}function ay(T,td=null){var tf;let tb=null!=(tf=null==td?void 0:td.contentHash)?tf:"e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855",t_=new Map;t_.set("x-amz-date",T.datetimeNow),t_.set("x-amz-content-sha256",tb),T.sessionToken&&t_.set("x-amz-security-token",T.sessionToken);let tg="";null!=td&&td.contentType&&(tg+="content-type;"),tg+="host;x-amz-content-sha256;x-amz-date",T.sessionToken&&(tg+=";x-amz-security-token");let tv=T.method+"\n"+oy(T.url)+"\n"+T.query;null!=td&&td.contentType&&(tv+="\ncontent-type:"+(null==td?void 0:td.contentType)),tv+="\nhost:"+T.host+"\nx-amz-content-sha256:"+tb+"\nx-amz-date:"+T.datetimeNow,T.sessionToken&&T.sessionToken.length>0&&(tv+="\nx-amz-security-token:"+T.sessionToken),tv+="\n\n"+tg+"\n"+tb;let tw=(0,Wr.sha256)(tv),tI="AWS4-HMAC-SHA256\n"+T.datetimeNow+"\n"+T.dateNow+"/"+T.region+"/"+T.service+"/aws4_request\n"+tw,tS="AWS4"+T.secretAccessKey,tA=Wr.sha256.hmac.arrayBuffer(tS,T.dateNow),tT=Wr.sha256.hmac.arrayBuffer(tA,T.region),tB=Wr.sha256.hmac.arrayBuffer(tT,T.service),tF=Wr.sha256.hmac.arrayBuffer(tB,"aws4_request"),tO=Wr.sha256.hmac(tF,tI);return t_.set("Authorization","AWS4-HMAC-SHA256 Credential="+T.accessKeyId+"/"+T.dateNow+"/"+T.region+"/"+T.service+"/aws4_request, SignedHeaders="+tg+", Signature="+tO),t_}var cy=function(T,td,tf,tb=null,t_=null){return ay(sy(T,td,tf),{contentType:tb,contentHash:t_?Wr.sha256.hex(t_):null})};function Qe(T,td,tf,tb,t_=null,tg=null){(null!=td&&td.accessKeyId||null!=td&&td.sessionToken)&&(cy(td,tf,tb,t_,tg).forEach((td,tf)=>{T.setRequestHeader(tf,td)}),t_&&T.setRequestHeader("content-type",t_))}function Eu(T){if(0!=T.indexOf("s3://"))throw Error("URL needs to start with s3://");let td=T.indexOf("/",5);if(-1==td)throw Error("URL needs to contain a '/' after the host");let tf=T.substring(5,td);if(!tf)throw Error("URL needs to contain a bucket name");let tb=T.substring(td);if(!tb)throw Error("URL needs to contain key");return{bucket:tf,path:tb}}function Ou(T){var td;return!!(null!=(td=null==T?void 0:T.endpoint)&&td.startsWith("http"))}function tr(T,td){let tf=Eu(td);return Ou(T)?"".concat(null==T?void 0:T.endpoint,"/").concat(tf.bucket)+tf.path:"https://"+Du(T,td,tf.bucket)+tf.path}var et={_files:new Map,_fileInfoCache:new Map,_udfFunctions:new Map,_globalFileInfo:null,getFileInfo(T,td){try{let tf=et._fileInfoCache.get(td),[tb,t_,tg]=it(T,"duckdb_web_fs_get_file_info_by_id",["number","number"],[td,(null==tf?void 0:tf.cacheEpoch)||0]);if(0!==tb)return null;if(0===tg)return tf;let tv=z(T,t_,tg);ft(T);let tw=JSON.parse(tv);if(null==tw)return null;let tI={...tw,blob:null};return et._fileInfoCache.set(td,tI),tI}catch(T){return console.log(T),null}},getGlobalFileInfo(T){var td;try{let[tf,tb,t_]=it(T,"duckdb_web_get_global_file_info",["number"],[(null==(td=et._globalFileInfo)?void 0:td.cacheEpoch)||0]);if(0!==tf)return null;if(0===t_)return et._globalFileInfo;let tg=z(T,tb,t_);ft(T);let tv=JSON.parse(tg);return null==tv?null:(et._globalFileInfo={...tv,blob:null},et._globalFileInfo)}catch(T){return console.log(T),null}},testPlatformFeature:(T,td)=>1===td?"u">typeof BigInt64Array:(console.warn("test for unknown feature: ".concat(td)),!1),getDefaultDataProtocol:T=>2,openFile:(T,td,tf)=>{var tb;try{et._fileInfoCache.delete(td);let t_=et.getFileInfo(T,td);switch(null==t_?void 0:t_.dataProtocol){case 4:case 5:{if(1&tf&&2&tf)throw Error("Opening file ".concat(t_.fileName," failed: cannot open file with both read and write flags set"));if(32&tf)throw Error("Opening file ".concat(t_.fileName," failed: appending to HTTP/S3 files is not supported"));if(2&tf){let td=new XMLHttpRequest;if(5==t_.dataProtocol?(td.open("HEAD",tr(t_.s3Config,t_.dataUrl),!1),Qe(td,t_.s3Config,t_.dataUrl,"HEAD")):td.open("HEAD",t_.dataUrl,!1),td.send(null),200!=td.status&&404!=td.status)throw Error("Opening file ".concat(t_.fileName," failed: Unexpected return status from server (").concat(td.status,")"));if(404==td.status&&!(8&tf||16&tf))throw Error("Opening file ".concat(t_.fileName," failed: Cannot write to non-existent file without FILE_FLAGS_FILE_CREATE or FILE_FLAGS_FILE_CREATE_NEW flag."));let tb=T._malloc(1),tg=new Uint8Array;T.HEAPU8.set(tg,tb);let tv=T._malloc(16);return T.HEAPF64[(tv>>3)+0]=1,T.HEAPF64[(tv>>3)+1]=tb,tv}if(1!=tf)throw Error("Opening file ".concat(t_.fileName," failed: unsupported file flags: ").concat(tf));let td=null,tb=null;try{let tf=new XMLHttpRequest;if(5==t_.dataProtocol?(tf.open("HEAD",tr(t_.s3Config,t_.dataUrl),!1),Qe(tf,t_.s3Config,t_.dataUrl,"HEAD")):tf.open("HEAD",t_.dataUrl,!1),tf.setRequestHeader("Range","bytes=0-"),tf.send(null),td=tf.getResponseHeader("Content-Length"),null!==td&&206==tf.status){let tf=T._malloc(16);return T.HEAPF64[(tf>>3)+0]=+td,T.HEAPF64[(tf>>3)+1]=0,tf}}catch(T){tb=T,console.warn("HEAD request with range header failed: ".concat(T))}if(t_.allowFullHttpReads){if(null!==td&&+td>1){let tf=new XMLHttpRequest;5==t_.dataProtocol?(tf.open("GET",tr(t_.s3Config,t_.dataUrl),!1),Qe(tf,t_.s3Config,t_.dataUrl,"GET")):tf.open("GET",t_.dataUrl,!1),tf.responseType="arraybuffer",tf.setRequestHeader("Range","bytes=0-0"),tf.send(null);let tb=tf.getResponseHeader("Content-Length");if(206==tf.status&&null!==tb&&1==+tb){let tf=T._malloc(16);return T.HEAPF64[(tf>>3)+0]=+td,T.HEAPF64[(tf>>3)+1]=0,tf}if(200==tf.status&&null!==tb&&+tb==+td){console.warn("fall back to full HTTP read for: ".concat(t_.dataUrl));let td=T._malloc(tf.response.byteLength),tb=new Uint8Array(tf.response,0,tf.response.byteLength);T.HEAPU8.set(tb,td);let tg=T._malloc(16);return T.HEAPF64[(tg>>3)+0]=tf.response.byteLength,T.HEAPF64[(tg>>3)+1]=td,tg}}console.warn("falling back to full HTTP read for: ".concat(t_.dataUrl));let tf=new XMLHttpRequest;if(5==t_.dataProtocol?(tf.open("GET",tr(t_.s3Config,t_.dataUrl),!1),Qe(tf,t_.s3Config,t_.dataUrl,"GET")):tf.open("GET",t_.dataUrl,!1),tf.responseType="arraybuffer",tf.send(null),200==tf.status){let td=T._malloc(tf.response.byteLength),tb=new Uint8Array(tf.response,0,tf.response.byteLength);T.HEAPU8.set(tb,td);let t_=T._malloc(16);return T.HEAPF64[(t_>>3)+0]=tf.response.byteLength,T.HEAPF64[(t_>>3)+1]=td,t_}}if(null!=tb)throw Error("Reading file ".concat(t_.fileName," failed with error: ").concat(tb));break}case 2:{let td=null==(tb=et._files)?void 0:tb.get(t_.fileName);if(td){let tf=T._malloc(16);return T.HEAPF64[(tf>>3)+0]=td.size,T.HEAPF64[(tf>>3)+1]=0,tf}console.warn("Buffering missing file: ".concat(t_.fileName));let tf=T._malloc(16),tg=T._malloc(1);return T.HEAPF64[(tf>>3)+0]=1,T.HEAPF64[(tf>>3)+1]=tg,tf}}}catch(td){console.error(td.toString()),ge(T,td.toString())}return 0},glob:(T,td,tf)=>{var tb;try{let t_=z(T,td,tf);if(t_.startsWith("http")||t_.startsWith("s3://")){let td=new XMLHttpRequest;if(t_.startsWith("s3://")){let tf=et.getGlobalFileInfo(T);td.open("HEAD",tr(null==tf?void 0:tf.s3Config,t_),!1),Qe(td,null==tf?void 0:tf.s3Config,t_,"HEAD")}else td.open("HEAD",t_,!1);if(td.send(null),200!=td.status&&206!==td.status){if(!(null!=(tb=et.getGlobalFileInfo(T))&&tb.allowFullHttpReads)){ge(T,"HEAD request failed: ".concat(t_,", with full http reads are disabled"));return}let td=new XMLHttpRequest;if(t_.startsWith("s3://")){let tf=et.getGlobalFileInfo(T);td.open("GET",tr(null==tf?void 0:tf.s3Config,t_),!1),Qe(td,null==tf?void 0:tf.s3Config,t_,"HEAD")}else td.open("GET",t_,!1);if(td.setRequestHeader("Range","bytes=0-0"),td.send(null),200!=td.status&&206!==td.status){ge(T,"HEAD and GET requests failed: ".concat(t_));return}let tf=td.getResponseHeader("Content-Length");tf&&+tf>1&&console.warn("Range request for ".concat(t_," did not return a partial response: ").concat(td.status,' "').concat(td.statusText,'"'))}T.ccall("duckdb_web_fs_glob_add_path",null,["string"],[t_])}}catch(td){return console.log(td),ge(T,td.toString()),0}},checkFile:(T,td,tf)=>{try{let tb=z(T,td,tf);if(tb.startsWith("http")||tb.startsWith("s3://")){let td=new XMLHttpRequest;if(tb.startsWith("s3://")){let tf=et.getGlobalFileInfo(T);td.open("HEAD",tr(null==tf?void 0:tf.s3Config,tb),!1),Qe(td,null==tf?void 0:tf.s3Config,tb,"HEAD")}else td.open("HEAD",tb,!1);return td.send(null),206==td.status||200==td.status}}catch(T){return console.log(T),!1}return!1},syncFile:(T,td)=>{},closeFile:(T,td)=>{var tf;let tb=et.getFileInfo(T,td);switch(et._fileInfoCache.delete(td),null==tb?void 0:tb.dataProtocol){case 0:case 4:case 5:break;case 1:case 2:return;case 3:{let T=null==(tf=et._files)?void 0:tf.get(tb.fileName);if(!T)throw Error("No OPFS access handle registered with name: ".concat(tb.fileName));return T.flush()}}},truncateFile:(T,td,tf)=>{var tb;let t_=et.getFileInfo(T,td);switch(null==t_?void 0:t_.dataProtocol){case 4:ge(T,"Cannot truncate a http file");return;case 5:ge(T,"Cannot truncate an s3 file");return;case 0:case 1:case 2:ge(T,"truncateFile not implemented");return;case 3:{let T=null==(tb=et._files)?void 0:tb.get(t_.fileName);if(!T)throw Error("No OPFS access handle registered with name: ".concat(t_.fileName));return T.truncate(tf)}}return 0},readFile(T,td,tf,tb,t_){var tg,tv;if(0==tb)return 0;try{let tw=et.getFileInfo(T,td);switch(null==tw?void 0:tw.dataProtocol){case 4:case 5:if(!tw.dataUrl)throw Error("Missing data URL for file ".concat(td));try{let td=new XMLHttpRequest;if(5==tw.dataProtocol?(td.open("GET",tr(null==tw?void 0:tw.s3Config,tw.dataUrl),!1),Qe(td,null==tw?void 0:tw.s3Config,tw.dataUrl,"GET")):td.open("GET",tw.dataUrl,!1),td.responseType="arraybuffer",td.setRequestHeader("Range","bytes=".concat(t_,"-").concat(t_+tb-1)),td.send(null),206==td.status||200==td.status&&tb==td.response.byteLength&&0==t_){let t_=new Uint8Array(td.response,0,Math.min(td.response.byteLength,tb));return T.HEAPU8.set(t_,tf),t_.byteLength}if(200==td.status){console.warn("Range request for ".concat(tw.dataUrl," did not return a partial response: ").concat(td.status,' "').concat(td.statusText,'"'));let tg=new Uint8Array(td.response,t_,Math.min(td.response.byteLength-t_,tb));return T.HEAPU8.set(tg,tf),tg.byteLength}throw Error("Range request for ".concat(tw.dataUrl," did returned non-success status: ").concat(td.status,' "').concat(td.statusText,'"'))}catch(T){throw console.log(T),Error("Range request for ".concat(tw.dataUrl," failed with error: ").concat(T,'"'))}case 2:{let td=null==(tg=et._files)?void 0:tg.get(tw.fileName);if(!td)throw Error("No HTML5 file registered with name: ".concat(tw.fileName));let tv=td.slice(t_,t_+tb),tI=new Uint8Array(new FileReaderSync().readAsArrayBuffer(tv));return T.HEAPU8.set(tI,tf),tI.byteLength}case 3:{let td=null==(tv=et._files)?void 0:tv.get(tw.fileName);if(!td)throw Error("No OPFS access handle registered with name: ".concat(tw.fileName));let tg=T.HEAPU8.subarray(tf,tf+tb);return td.read(tg,{at:t_})}}return 0}catch(td){return console.log(td),ge(T,td.toString()),0}},writeFile:(T,td,tf,tb,t_)=>{var tg;let tv=et.getFileInfo(T,td);switch(null==tv?void 0:tv.dataProtocol){case 4:return ge(T,"Cannot write to HTTP file"),0;case 5:{let td=T.HEAPU8.subarray(tf,tf+tb),t_=new XMLHttpRequest;return t_.open("PUT",tr(null==tv?void 0:tv.s3Config,tv.dataUrl),!1),Qe(t_,null==tv?void 0:tv.s3Config,tv.dataUrl,"PUT","",td),t_.send(td),200!==t_.status?(ge(T,"Failed writing file: HTTP "+t_.status),0):tb}case 2:return ge(T,"cannot write using the html5 file reader api"),0;case 3:{let td=null==(tg=et._files)?void 0:tg.get(tv.fileName);if(!td)throw Error("No OPFS access handle registered with name: ".concat(tv.fileName));let tw=T.HEAPU8.subarray(tf,tf+tb);return td.write(tw,{at:t_})}}return 0},getLastFileModificationTime:(T,td)=>{var tf;let tb=et.getFileInfo(T,td);switch(null==tb?void 0:tb.dataProtocol){case 2:if(!(null==(tf=et._files)?void 0:tf.get(tb.fileName)))throw Error("No handle available for file: ".concat(tb.fileName));break;case 4:case 5:return new Date().getTime()}return 0},checkDirectory:(T,td,tf)=>{let tb=z(T,td,tf);return console.log("checkDirectory: ".concat(tb)),!1},createDirectory:(T,td,tf)=>{let tb=z(T,td,tf);console.log("createDirectory: ".concat(tb))},removeDirectory:(T,td,tf)=>{let tb=z(T,td,tf);console.log("removeDirectory: ".concat(tb))},listDirectoryEntries:(T,td,tf)=>{let tb=z(T,td,tf);return console.log("listDirectoryEntries: ".concat(tb)),!1},moveFile:(T,td,tf,tb,t_)=>{var tg,tv;let tw=z(T,td,tf),tI=z(T,tb,t_),tS=null==(tg=et._files)?void 0:tg.get(tw);for(let[T,td]of(void 0!==tS&&(et._files.delete(tS),et._files.set(tI,tS)),(null==(tv=et._fileInfoCache)?void 0:tv.entries())||[]))if(td.dataUrl==tw){et._fileInfoCache.delete(T);break}return!0},removeFile:(T,td,tf)=>{},callScalarUDF:(T,td,tf,tb,t_,tg,tv)=>{Au(et,T,td,tf,tb,t_,tg,tv)}},Qa=class extends Eo{postMessage(T,td){globalThis.postMessage(T,td)}async instantiate(T,td,tf){return await new ko(this,et,T,td).instantiate(tf)}};function Ru(){let T=new Qa;globalThis.onmessage=async td=>{await T.onMessage(td.data)}}return Ru(),gh(ly)})();/*! Bundled license information:

js-sha256/src/sha256.js:
  (**
   * [js-sha256]{@link https://github.com/emn178/js-sha256}
   *
   * @version 0.9.0
   * @author Chen, Yi-Cyuan [emn178@gmail.com]
   * @copyright Chen, Yi-Cyuan 2014-2017
   * @license MIT
   *)
*/