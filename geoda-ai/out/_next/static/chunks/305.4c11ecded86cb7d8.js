"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[305],{82305:function(e,t,i){i.r(t),i.d(t,{default:function(){return f}});var r=i(57437),n=i(2336),s=i(2910),a=i(63923),o=i(89687),l=i(94761),_=i(12576),d=i(98149),c=i(98885),h=i(2265);setTimeout(async()=>{await (0,l.Gi)()},1e3);var u=i(3237),m=i(16347),f=()=>{let e=(0,m.v9)(e=>e.root.uiState.theme),t=(0,m.v9)(e=>{var t;return null===(t=e.root.file)||void 0===t?void 0:t.rawFileData}),{importArrowFile:i}=(0,o.bW)();return(0,h.useCallback)(async()=>await (0,_.v)([3,3,0,9,8,8.5],[[1],[0],[],[4,5],[3,5],[3,4]],99),[]),(0,h.useCallback)(async(e,t)=>await (0,d.H)(e,t),[]),(0,h.useCallback)(async(e,t)=>await (0,c.a)(e,t),[]),(0,h.useEffect)(()=>{(null==t?void 0:t.fileName)&&(i(t),(0,o.Zi)(t.fileName))},[i,t]),(0,r.jsx)("div",{style:{height:"100%",padding:"0px"},className:"geoda-kepler-map",children:(0,r.jsx)(n.ZP,{defaultHeight:400,defaultWidth:500,children:t=>{let{height:i,width:n}=t;return(0,r.jsx)(s.ZPm,{id:u.EG,mapboxApiAccessToken:u.c3,height:i,width:n,theme:"light"===e?a.themeLT:a.theme})}})})}},89687:function(e,t,i){i.d(t,{Zi:function(){return h},bW:function(){return u}});var r=i(2265),n=i(79121),s=i(37037),a=i(41762);let o={mvp:{mainModule:s,mainWorker:new i.U(i(82471)).toString()},eh:{mainModule:a,mainWorker:new i.U(i(37770)).toString()}},l=null,_=null,d=null;async function c(){if(null===l){await new Promise(e=>setTimeout(e,2e3));let e=await n.Dn(o),t=new Worker(e.mainWorker),i=new n.kw;return l=new n.ak(i,t),await l.instantiate(e.mainModule,e.pthreadWorker),l}return null}async function h(e){if(l){if(!d){!_&&e&&(_=e);try{let e=await l.connect(),t=(await e.query('SUMMARIZE "'.concat(_,'"'))).toArray().map(e=>e.toJSON());await e.close();let i=t.map(e=>Object.values(e).join(",")).join("\n"),r=Object.keys(t[0]).join(",");d="".concat(r,"\n").concat(i)}catch(e){return"error: can not get summary of the table because table name is not found"}}return d}return"Error: can not get summary of the table because the duckdb is not working properly."}function u(){return{query:(0,r.useCallback)(async e=>{var t;if("SELECT"!==(e=e.trim()).substring(0,6).toUpperCase())throw Error("Only SELECT queries are supported");if(!l)throw Error("DuckDB is not initialized");e="SELECT row_index AS selected_index, ".concat(e.substring(6));let i=await l.connect(),r=null===(t=(await i.query(e)).getChildAt(0))||void 0===t?void 0:t.toArray();return await i.close(),r||[]},[]),importArrowFile:(0,r.useCallback)(async e=>{let{fileName:t,arrowTable:i}=e;if(l){let e=await l.connect();if(!(await e.query("select * from information_schema.tables")).toArray().map(e=>e.toJSON()).some(e=>e.table_name===t))try{await e.insertArrowTable(i,{name:t}),await e.query('ALTER TABLE "'.concat(t,'" ADD COLUMN row_index INTEGER DEFAULT 0')),await e.query("CREATE SEQUENCE serial"),await e.query('UPDATE "'.concat(t,"\" SET row_index = nextval('serial') - 1")),await h()}catch(e){}await e.close()}},[])}}setTimeout(async()=>{l=await c()},200)},2336:function(e,t,i){let r;i.d(t,{ZP:function(){return c}});var n=i(2265);r="undefined"!=typeof window?window:"undefined"!=typeof self?self:i.g;let s=null,a=null,o=r.clearTimeout,l=r.setTimeout,_=r.cancelAnimationFrame||r.mozCancelAnimationFrame||r.webkitCancelAnimationFrame,d=r.requestAnimationFrame||r.mozRequestAnimationFrame||r.webkitRequestAnimationFrame;null==_||null==d?(s=o,a=function(e){return l(e,20)}):(s=function([e,t]){_(e),o(t)},a=function(e){let t=d(function(){o(i),e()}),i=l(function(){_(t),e()},20);return[t,i]});class c extends n.Component{constructor(...e){super(...e),this.state={height:this.props.defaultHeight||0,scaledHeight:this.props.defaultHeight||0,scaledWidth:this.props.defaultWidth||0,width:this.props.defaultWidth||0},this._autoSizer=null,this._detectElementResize=null,this._parentNode=null,this._resizeObserver=null,this._timeoutId=null,this._onResize=()=>{this._timeoutId=null;let{disableHeight:e,disableWidth:t,onResize:i}=this.props;if(this._parentNode){var r,n,s,a;let o=window.getComputedStyle(this._parentNode)||{},l=parseFloat(null!==(r=o.paddingLeft)&&void 0!==r?r:"0"),_=parseFloat(null!==(n=o.paddingRight)&&void 0!==n?n:"0"),d=parseFloat(null!==(s=o.paddingTop)&&void 0!==s?s:"0"),c=parseFloat(null!==(a=o.paddingBottom)&&void 0!==a?a:"0"),h=this._parentNode.getBoundingClientRect(),u=h.height-d-c,m=h.width-l-_,f=this._parentNode.offsetHeight-d-c,g=this._parentNode.offsetWidth-l-_;(e||this.state.height===f&&this.state.scaledHeight===u)&&(t||this.state.width===g&&this.state.scaledWidth===m)||(this.setState({height:f,width:g,scaledHeight:u,scaledWidth:m}),"function"==typeof i&&i({height:f,scaledHeight:u,scaledWidth:m,width:g}))}},this._setRef=e=>{this._autoSizer=e}}componentDidMount(){let{nonce:e}=this.props;this._autoSizer&&this._autoSizer.parentNode&&this._autoSizer.parentNode.ownerDocument&&this._autoSizer.parentNode.ownerDocument.defaultView&&this._autoSizer.parentNode instanceof this._autoSizer.parentNode.ownerDocument.defaultView.HTMLElement&&(this._parentNode=this._autoSizer.parentNode,null!=this._parentNode&&("undefined"!=typeof ResizeObserver?(this._resizeObserver=new ResizeObserver(()=>{this._timeoutId=setTimeout(this._onResize,0)}),this._resizeObserver.observe(this._parentNode)):(this._detectElementResize=function(e){let t,i,n,o,l,_;let d="undefined"!=typeof document&&document.attachEvent;if(!d){l=function(e){let t=e.__resizeTriggers__,i=t.firstElementChild,r=t.lastElementChild,n=i.firstElementChild;r.scrollLeft=r.scrollWidth,r.scrollTop=r.scrollHeight,n.style.width=i.offsetWidth+1+"px",n.style.height=i.offsetHeight+1+"px",i.scrollLeft=i.scrollWidth,i.scrollTop=i.scrollHeight},_=function(e){if(e.target.className&&"function"==typeof e.target.className.indexOf&&0>e.target.className.indexOf("contract-trigger")&&0>e.target.className.indexOf("expand-trigger"))return;let t=this;l(this),this.__resizeRAF__&&s(this.__resizeRAF__),this.__resizeRAF__=a(function(){(t.offsetWidth!==t.__resizeLast__.width||t.offsetHeight!==t.__resizeLast__.height)&&(t.__resizeLast__.width=t.offsetWidth,t.__resizeLast__.height=t.offsetHeight,t.__resizeListeners__.forEach(function(i){i.call(t,e)}))})};let e=!1,r="";n="animationstart";let d="Webkit Moz O ms".split(" "),c="webkitAnimationStart animationstart oAnimationStart MSAnimationStart".split(" ");{let t=document.createElement("fakeelement");if(void 0!==t.style.animationName&&(e=!0),!1===e){for(let i=0;i<d.length;i++)if(void 0!==t.style[d[i]+"AnimationName"]){r="-"+(0,d[i]).toLowerCase()+"-",n=c[i],e=!0;break}}}t="@"+r+"keyframes "+(i="resizeanim")+" { from { opacity: 0; } to { opacity: 0; } } ",o=r+"animation: 1ms "+i+"; "}let c=function(i){if(!i.getElementById("detectElementResize")){let r=(t||"")+".resize-triggers { "+(o||"")+'visibility: hidden; opacity: 0; } .resize-triggers, .resize-triggers > div, .contract-trigger:before { content: " "; display: block; position: absolute; top: 0; left: 0; height: 100%; width: 100%; overflow: hidden; z-index: -1; } .resize-triggers > div { background: #eee; overflow: auto; } .contract-trigger:before { width: 200%; height: 200%; }',n=i.head||i.getElementsByTagName("head")[0],s=i.createElement("style");s.id="detectElementResize",s.type="text/css",null!=e&&s.setAttribute("nonce",e),s.styleSheet?s.styleSheet.cssText=r:s.appendChild(i.createTextNode(r)),n.appendChild(s)}};return{addResizeListener:function(e,t){if(d)e.attachEvent("onresize",t);else{if(!e.__resizeTriggers__){let t=e.ownerDocument,s=r.getComputedStyle(e);s&&"static"===s.position&&(e.style.position="relative"),c(t),e.__resizeLast__={},e.__resizeListeners__=[],(e.__resizeTriggers__=t.createElement("div")).className="resize-triggers";let a=t.createElement("div");a.className="expand-trigger",a.appendChild(t.createElement("div"));let o=t.createElement("div");o.className="contract-trigger",e.__resizeTriggers__.appendChild(a),e.__resizeTriggers__.appendChild(o),e.appendChild(e.__resizeTriggers__),l(e),e.addEventListener("scroll",_,!0),n&&(e.__resizeTriggers__.__animationListener__=function(t){t.animationName===i&&l(e)},e.__resizeTriggers__.addEventListener(n,e.__resizeTriggers__.__animationListener__))}e.__resizeListeners__.push(t)}},removeResizeListener:function(e,t){if(d)e.detachEvent("onresize",t);else if(e.__resizeListeners__.splice(e.__resizeListeners__.indexOf(t),1),!e.__resizeListeners__.length){e.removeEventListener("scroll",_,!0),e.__resizeTriggers__.__animationListener__&&(e.__resizeTriggers__.removeEventListener(n,e.__resizeTriggers__.__animationListener__),e.__resizeTriggers__.__animationListener__=null);try{e.__resizeTriggers__=!e.removeChild(e.__resizeTriggers__)}catch(e){}}}}}(e),this._detectElementResize.addResizeListener(this._parentNode,this._onResize)),this._onResize()))}componentWillUnmount(){this._parentNode&&(this._detectElementResize&&this._detectElementResize.removeResizeListener(this._parentNode,this._onResize),null!==this._timeoutId&&clearTimeout(this._timeoutId),this._resizeObserver&&(this._resizeObserver.observe(this._parentNode),this._resizeObserver.disconnect()))}render(){let{children:e,defaultHeight:t,defaultWidth:i,disableHeight:r=!1,disableWidth:s=!1,nonce:a,onResize:o,style:l={},tagName:_="div",...d}=this.props,{height:c,scaledHeight:h,scaledWidth:u,width:m}=this.state,f={overflow:"visible"},g={},p=!1;return r||(0===c&&(p=!0),f.height=0,g.height=c,g.scaledHeight=h),s||(0===m&&(p=!0),f.width=0,g.width=m,g.scaledWidth=u),(0,n.createElement)(_,{ref:this._setRef,style:{...f,...l},...d},!p&&e(g))}}}}]);