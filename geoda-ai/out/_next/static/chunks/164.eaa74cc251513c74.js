!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},a=Error().stack;a&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[a]="f4ecada7-53e9-4f86-a75e-0a429a9f9a63",e._sentryDebugIdIdentifier="sentry-dbid-f4ecada7-53e9-4f86-a75e-0a429a9f9a63")}catch(e){}}();"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[164],{47164:function(e,a,t){t.r(a),t.d(a,{CONNECT_OPENAI_API:function(){return E},INVALID_OPENAI_KEY_MESSAGE:function(){return k},NO_MAP_LOADED_MESSAGE:function(){return P},NO_OPENAI_KEY_MESSAGE:function(){return S},default:function(){return _}});var s=t(57437),l=t(2265);t(91159);var n=t(26564),i=t(16347),o=t(82627),r=t(81898),d=t(37431),c=t(37062),u=t(66262),g=t(7528),f=t(93274),m=t(11957),h=t(4319),p=t(96986),I=t(51866),x=t(55807),y=t(14265),A=t(85598),j=t(90666),v=t(33679),b=t(71888),N=t(33872);function C(e){let{setShowConfig:a}=e,t=(0,i.I0)(),[n,d]=(0,l.useState)(!1),[c,g]=(0,l.useState)(""),C=(0,i.v9)(e=>e.root.uiState.openAIKey),[w,S]=l.useState(C||""),k=(0,l.useCallback)(e=>{S(e.target.value),d(!1),g("")},[]),E=(0,l.useCallback)(async()=>{await (0,N.s3)(w)?(t((0,u.d1)(w)),t((0,u.l6)(!0)),a(!1)):(d(!0),g("Incorrect API key provided. You can find your API key at https://platform.openai.com/account/api-keys."),t((0,u.d1)(void 0)),t((0,u.l6)(!1)))},[t,w,a]),P=(0,l.useCallback)(e=>{e.currentKey},[]);return(0,s.jsx)(s.Fragment,{children:(0,s.jsxs)("div",{className:"flex flex-col gap-4 overflow-y-auto pl-4 pr-4",children:[(0,s.jsx)(f.d,{itemClasses:b.nB,defaultExpandedKeys:["1","2"],children:(0,s.jsx)(m.G,{"aria-label":"AI Settings",title:"AI Settings",subtitle:"Change your AI settings",children:(0,s.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,s.jsxs)(h.g,{selectedKeys:["openai"],disabledKeys:["gemini","llama","qwen","custom"],label:"AI Provider",placeholder:"Select AI provider",className:"max-w-full",children:[(0,s.jsx)(p.R,{children:"OpenAI ChatGPT"},"openai"),(0,s.jsx)(p.R,{children:"Google Gemini"},"gemini"),(0,s.jsx)(p.R,{children:"Meta Llama"},"llama"),(0,s.jsx)(p.R,{children:"Alibaba QWen"},"qwen"),(0,s.jsx)(p.R,{children:"Custom Llama"},"custom")]}),(0,s.jsxs)(h.g,{selectedKeys:["gpt-4o-2024-05-13"],label:"LLM Model",placeholder:"Select LLM model",className:"max-w-full",onSelectionChange:P,children:[(0,s.jsx)(p.R,{children:"gpt-4o-2024-05-13"},"gpt-4o-2024-05-13"),(0,s.jsx)(p.R,{children:"gpt-4o-mini"},"gpt-4o-mini")]}),n&&c.length>0&&(0,s.jsx)(r.Xr,{message:c,type:r.Bc.WARNING,onClick:()=>{d(!0),g(""),a(!0)}}),(0,s.jsx)(I.Y,{type:"string",label:"API Key",defaultValue:"Enter your OpenAI key here",className:"max-w-full",onChange:k,value:w||"",required:!0,isInvalid:n||0===w.length}),(0,s.jsx)(x.L,{label:"Temperature",step:.1,maxValue:1,minValue:0,defaultValue:.8,className:"max-w-full"}),(0,s.jsx)(x.L,{label:"Top P",step:.1,maxValue:1,minValue:0,defaultValue:.8,className:"max-w-full"})]})},"1")}),(0,s.jsxs)(y.w,{className:"hidden",children:[(0,s.jsx)(A.u,{children:(0,s.jsx)("p",{className:"text-small",children:"Usage"})}),(0,s.jsx)(j.G,{})]}),(0,s.jsx)(v.A,{radius:"sm",color:"danger",className:"mt-4 bg-rose-900",onClick:E,isDisabled:n||c.length>0,startContent:(0,s.jsx)(o.JO,{icon:"hugeicons:ai-chat-02",className:"h-5 w-5"}),children:"Let's Chat"})]})})}var w=t(56519);let S="Please config your OpenAI API key in Settings.",k="The OpenAI API key is invalid. Please change your OpenAI API key in Settings.",E="Connecting and initializing ...",P="Please load a map first before chatting.";var _=()=>{let e=(0,n.Z)(),a=(0,i.I0)(),t={message:e.formatMessage({id:"GeoDa.AI.initialMessage",defaultMessage:"Hello, I'm GeoDa.AI agent! Let's do spatial analysis! How can I help you today?"}),sentTime:"just now",sender:"ChatGPT",direction:"incoming",position:"first"},f=(0,i.v9)(g.Sh),m=(0,i.v9)(e=>e.root.uiState.openAIKey),h=(0,i.v9)(e=>e.root.uiState.isOpenAIKeyChecked),p=(0,i.v9)(e=>e.root.ai.datasetMeta),I=(0,i.v9)(e=>e.root.ai.messages),[x,y]=l.useState(!1),A=f.every(e=>null==p?void 0:p.find(a=>a.datasetId===e.dataId));return(0,l.useEffect)(()=>{h&&m&&function(e){e.map(e=>e.dataId).filter(e=>!(null==p?void 0:p.find(a=>a.datasetId===e))).forEach(t=>{var s;let l=null===(s=e.find(e=>e.dataId===t))||void 0===s?void 0:s.fileName;l&&t&&a((0,u.my)(t,l))})}(f)},[f,h]),(0,s.jsxs)(d.c,{title:e.formatMessage({id:"chatGpt.title",defaultMessage:"GeoDa.AI Agent"}),description:e.formatMessage({id:"chatGpt.description",defaultMessage:"Powered by GeoDa and LLM"}),showAIHelp:!1,children:[(0,s.jsx)(w.e,{content:"AI Configuration",size:"sm",placement:"right",children:(0,s.jsx)(v.A,{className:"absolute -top-12 right-1 z-10",isIconOnly:!0,variant:"light",size:"sm",onClick:()=>{y(!0)},children:(0,s.jsx)(o.JO,{icon:"mynaui:config",width:18})})}),!1===h||x?(0,s.jsx)(C,{setShowConfig:y}):p||A?(null==f?void 0:f.length)===0?(0,s.jsx)(r.Xr,{message:P,type:r.Bc.WARNING}):(0,s.jsx)(c.A6,{messages:I.length>0?I:[t]}):(0,s.jsx)(r.Xr,{message:E,type:r.Bc.WAIT,onClick:()=>{y(!0)}})]})}}}]);